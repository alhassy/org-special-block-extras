<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2020-11-30 Mon 06:59 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>org-special-block-extras</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Musa Al-hassy" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link href="https://alhassy.github.io/next-700-module-systems/prototype/org-notes-style.css" rel="stylesheet" type="text/css" />
<style>
.spoiler {color: grey; background-color:grey;}
.spoiler:hover {color: black; background-color:white;}
<style>

        <style>
        /* From: https://endlessparentheses.com/public/css/endless.css */
        /* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
        kbd
        {
          -moz-border-radius: 6px;
          -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          -webkit-border-radius: 6px;
          -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          background-color: #f7f7f7;
          border: 1px solid #ccc;
          border-radius: 6px;
          box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
          color: #333;
          display: inline-block;
          font-family: 'Droid Sans Mono', monospace;
          font-size: 80%;
          font-weight: normal;
          line-height: inherit;
          margin: 0 .1em;
          padding: .08em .4em;
          text-shadow: 0 1px 0 #fff;
          word-spacing: -4px;

          box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
        }
        </style>
        <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css"/>

        <link rel="stylesheet" type="text/css" href="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css" />

        <script type="text/javascript">
            if (typeof jQuery == 'undefined') {
                document.write(unescape('%3Cscript src="https://code.jquery.com/jquery-1.10.0.min.js"%3E%3C/script%3E'));
            }
        </script>

         <script type="text/javascript"            src="https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js"></script>

          <script>
                 $(document).ready(function() {
                     $('.tooltip').tooltipster({
                         theme: 'tooltipster-punk',
                         contentAsHTML: true,
                         animation: 'grow',
                         delay: [100,500],
                         // trigger: 'click'
                         trigger: 'custom',
                         triggerOpen: {
                             mouseenter: true
                         },
                         triggerClose: {
                             originClick: true,
                             scroll: true
                         }
         });
                 });
             </script>

        <style>
           abbr {color: red;}

           .tooltip { border-bottom: 1px dotted #000;
                      color:red;
                      text-decoration: none;}
        </style>

<style>
/* From: https://endlessparentheses.com/public/css/endless.css */
/* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */
kbd
{
  -moz-border-radius: 6px;
  -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
  -webkit-border-radius: 6px;
  -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
  background-color: #f7f7f7;
  border: 1px solid #ccc;
  border-radius: 6px;
  box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;
  color: #333;
  display: inline-block;
  font-family: 'Droid Sans Mono', monospace;
  font-size: 80%;
  font-weight: normal;
  line-height: inherit;
  margin: 0 .1em;
  padding: .08em .4em;
  text-shadow: 0 1px 0 #fff;
  word-spacing: -4px;

  box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */
}
</style>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:e95b018ef3580986a04669f1b5879592219e2a7a&dn=public-domain.txt Public Domain
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<h1 class="title">org-special-block-extras
<br />
<span class="subtitle">A unified interface for special blocks and links: defblock</span>
</h1>

<style>
/* Using source blocks ‚ÄúC‚Äù as alias for Org */
pre.src-C:before { content: 'Org-mode Example!'; }
/* Execute this for alias: (add-to-list 'org-src-lang-modes '("org" . C)) */
</style>
<div class="org-center">
<p>

</p>

<p>
<a href="https://www.gnu.org/software/emacs"><img src="https://img.shields.io/badge/Emacs-23%2F26%2F27%2F28-green?logo=gnu-emacs"></a>
<a href="https://orgmode.org"><img src="https://img.shields.io/badge/Org-9.4-blue?logo=gnu"></a>
</p>

<span>
<p>
<a href="https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/badge/org--special--block--extras-1.9-informational?logo=Gnu-Emacs"></a>
</p>

<a href="https://melpa.org/#/org-special-block-extras"><img alt="MELPA" src="https://melpa.org/packages/org-special-block-extras-badge.svg"/></a>
</span>

<p>
<a href="https://www.gnu.org/licenses/gpl-3.0.en.html"><img src="https://img.shields.io/badge/license-GNU_3-informational?logo=read-the-docs"></a>
<a href="https://github.com/alhassy/emacs.d#what-does-literate-programming-look-like"><img src="https://img.shields.io/badge/docs-literate-success?logo=read-the-docs"></a>
<a href="https://twitter.com/intent/tweet?text=This%20looks%20super%20neat%20%28%E2%80%A2%CC%80%E1%B4%97%E2%80%A2%CC%81%29%D9%88%3A:&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a>
<a href="https://github.com/alhassy/org-special-block-extras/issues"><img src="https://img.shields.io/badge/contributions-welcome-green"></a>
</p>

<p>
<a href="https://alhassy.github.io/"><img src="https://img.shields.io/badge/author-musa_al--hassy-purple?logo=nintendo-3ds"></a>
<a href="https://www.buymeacoffee.com/alhassy"><img src="https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee"></a>
</p>
</div>

<div class="org-center">
<p>
<b>Abstract</b>
</p>
</div>
<blockquote>
<p>
The aim is to write something once using Org-mode markup
then generate the markup for multiple backends.
That is, <i><b>write once, generate many!</b></i>
</p>

<p>
In particular, we are concerned with <i>‚Äòcustom‚Äô, or ‚Äòspecial‚Äô, blocks</i> which
delimit how a particular region of text is supposed to be formatted according to
the possible export backends.  In some sense, special blocks are meta-blocks.
Rather than writing text in, say, LaTeX environments using LaTeX commands or in
HTML <code>div</code>'s using HTML tags, we promote using Org-mode markup in special blocks
&#x2014;Org markup cannot be used explicitly within HTML or LaTeX environments.
</p>


<p>
<i>Special blocks</i>, like <code>centre</code> and <code>quote</code>, allow us to use Org-mode as the primary
interface regardless of whether the final result is an HTML or PDF article;
sometime we need to make our own special blocks to avoid a duplication of
effort.  However, this can be difficult and may require familiarity with
relatively advanced ELisp concepts, such as macros and hooks; as such, users may
not be willing to put in the time and instead use ad-hoc solutions.
</p>

<p>
We present a new macro, <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode src-block<br>consumes as main argument the language for the src block,<br>our special blocks too consume a MAIN-ARG; it may be a symbol<br>or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‚Äò,‚Äô since<br>it is a special Lisp operator. In doubt, enclose the main arg<br>in quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key‚ÇÄ value‚ÇÄ ‚Ä¶ key‚Çô value‚Çô).<br><br>After that is a DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip<br>for the produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---<br>that may refer to the names BACKEND and CONTENTS<br>which refer to the current export backend and the contents<br>of the special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e.,<br>Org-markup is acknowledged.<br><br>In, hopefully, rare circumstances, one may refer<br>to RAW-CONTENTS to look at the fully unparsed contents.<br><br>----------------------------------------------------------------------<br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>‚âà<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br>----------------------------------------------------------------------<br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ‚Äô(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX) editorial remarks; in Emacs they‚Äôre angry red.''<br>&emsp;&emsp; (format (if (equal backend ‚Äôhtml)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>‚ü¶%s:&emsp;%s%s‚üß</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don‚Äôt want to change the definition, but I‚Äôd like to have<br>&emsp; ;; the following as personalised defaults for the ‚Äúremark‚Äù block.<br>&emsp; ;; OR, I‚Äôd like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ‚ü®0‚ü© As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n √ó (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ‚ü®1‚ü© As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about ‚Äú<em>mathsf{even}</em>‚Äù here?]]<br><br>&emsp;&emsp;;; ‚ü®2‚ü© So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ‚ü®‚òÖ‚ü© Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional (DOCSTRING '''') &rest BODY)">defblock</abbr>, which is similar in-spirit to Lisp's standard
<abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‚Äòinteractive‚Äô.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‚Äòdefun-declarations-alist‚Äô.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr> except that where the latter defines functions, ours defines new
special blocks for Emacs' Org-mode &#x2014;as well as, simultaneously, defining new
Org link types. Besides the macro, the primary contribution of this effort is an
interface for special blocks that <i>admits</i> arguments and is familar to Org users
&#x2014;namely, we ‚Äòtry to reuse‚Äô the familiar <code>src</code>-block interface, including
header-args, but for special blocks.
</p>

<p>
It is hoped that the ease of creating custom special blocks will be a gateway
for many Emacs users to start using Lisp.
</p>
<p>
<b>

<span style="color:green;">

A 5-page PDF covering ELisp fundamentals

</span>

</b> can be found <b><a href="https://alhassy.github.io/ElispCheatSheet/CheatSheet.pdf">here</a></b>.
</p>

<p>
This article is featured in EmacsConf2020, with slides <a href="https://alhassy.github.io/org-special-block-extras/emacs-conf-2020">here</a>:
No pictures, instead we use this system to make the  slides
have a variety of styling information; i.e., we write Org
and the result looks nice. ‚ÄúLook ma, no HTML required!‚Äù
</p>
</blockquote>

<!--
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
Installation instructions are <a href="#Summary">below</a>.
</p>
</blockquote>
-->

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#A-unified-interface-for-special-blocks-and-links-defblock">1. <a href="#A-unified-interface-for-special-blocks-and-links-defblock">A unified interface for special blocks and links: <code>defblock</code></a></a>
<ul>
<li><a href="#What-is-a-special-block">1.1. <a href="#What-is-a-special-block">¬† <i>What is a special block?</i></a></a></li>
<li><a href="#Links">1.2. <a href="#Links">¬† <i>How do I make a new link type?</i></a></a></li>
<li><a href="#The-Core-Utility-defblock-and-friends">1.3. <a href="#The-Core-Utility-defblock-and-friends">The Core Utility: <code>defblock</code> and friends</a></a></li>
<li><a href="#modularity_with_thread-blockcall">1.4. <a href="#modularity_with_thread-blockcall">Modularity with <code>thread-blockcall</code></a></a></li>
<li><a href="#practice_problems">1.5. <a href="#practice_problems">Practice Problems: <i>Now you try!</i></a></a></li>
<li><a href="#Whats_the_rest_of_this_article_about?">1.6. <a href="#Whats_the_rest_of_this_article_about?">What's the rest of this article about?</a></a></li>
<li><a href="#Core-Utility">1.7. <a href="#Core-Utility">The Older <code>org-special-block-extras--ùí≥</code> Utility</a></a></li>
</ul>
</li>
<li><a href="#editor-comments">2. <a href="#editor-comments">Editor Comments</a></a></li>
<li><a href="#Folded-Details">3. <a href="#Folded-Details">Folded Details &#x2014;As well as boxed text and subtle colours</a></a>
<ul>
<li><a href="#Example">3.1. <a href="#Example">Example: <i>Here's a nifty puzzle, can you figure it out?</i></a></a></li>
<li><a href="#Boxed-Text">3.2. <a href="#Boxed-Text">Boxed Text</a></a></li>
</ul>
</li>
<li><a href="#Parallel">4. <a href="#Parallel">Parallel</a></a></li>
<li><a href="#Colours">5. <a href="#Colours">Colours</a></a>
<ul>
<li><a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">5.1. <a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">¬† <code>latex-definitions</code> for hiding LaTeX declarations in HTML</a></a></li>
</ul>
</li>
<li><a href="#">6. <a href="#">Nice Keystroke Renditions: kbd:C-h_h</a></a></li>
<li><a href="#Link-Here-OctoIcons">7. <a href="#Link-Here-OctoIcons">¬† <i>‚ÄúLink Here!‚Äù</i> &amp; OctoIcons</a></a></li>
<li><a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">8. <a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">Tooltips for Glossaries, Dictionaries, and Documentation</a></a>
<ul>
<li><a href="#The-doc-link-type">8.1. <a href="#The-doc-link-type">Implementation Details: <code>doc</code> link, <code>documentation</code> block, and tooltipster</a></a></li>
<li><a href="#hola">8.2. <a href="#hola">Wait, what about the LaTeX?</a></a></li>
<li><a href="#Next-Steps-tooltips">8.3. <a href="#Next-Steps-tooltips">Next Steps</a></a></li>
</ul>
</li>
<li><a href="#Summary">9. <a href="#Summary">Summary</a></a>
<ul>
<li><a href="#Installation-Instructions">9.1. <a href="#Installation-Instructions">Installation Instructions</a></a></li>
<li><a href="#Minimal-working-example">9.2. <a href="#Minimal-working-example">Minimal working example</a></a></li>
<li><a href="#Bye">9.3. <a href="#Bye">Bye!</a></a></li>
</ul>
</li>
</ul>
</div>
</div>
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
Installation instructions are <a href="#Summary">below</a>.
</p>
</blockquote>

<div id="outline-container-A-unified-interface-for-special-blocks-and-links-defblock" class="outline-2">
<h2 id="A-unified-interface-for-special-blocks-and-links-defblock"><span class="section-number-2">1</span> <a href="#A-unified-interface-for-special-blocks-and-links-defblock">A unified interface for special blocks and links: <code>defblock</code></a></h2>
<div class="outline-text-2" id="text-A-unified-interface-for-special-blocks-and-links-defblock">
<p>
An Org-mode block of type ùí≥ is a bunch of text enclosed in <code>#+begin_ùí≥</code> and
<code>#+end_ùí≥</code>, upon export it modifies the text &#x2014;e.g., to center it, or to display
it as code. We show how to make <i>new</i> blocks using a simple interface
---<abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode src-block<br>consumes as main argument the language for the src block,<br>our special blocks too consume a MAIN-ARG; it may be a symbol<br>or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‚Äò,‚Äô since<br>it is a special Lisp operator. In doubt, enclose the main arg<br>in quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key‚ÇÄ value‚ÇÄ ‚Ä¶ key‚Çô value‚Çô).<br><br>After that is a DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip<br>for the produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---<br>that may refer to the names BACKEND and CONTENTS<br>which refer to the current export backend and the contents<br>of the special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e.,<br>Org-markup is acknowledged.<br><br>In, hopefully, rare circumstances, one may refer<br>to RAW-CONTENTS to look at the fully unparsed contents.<br><br>----------------------------------------------------------------------<br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>‚âà<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br>----------------------------------------------------------------------<br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ‚Äô(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX) editorial remarks; in Emacs they‚Äôre angry red.''<br>&emsp;&emsp; (format (if (equal backend ‚Äôhtml)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>‚ü¶%s:&emsp;%s%s‚üß</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don‚Äôt want to change the definition, but I‚Äôd like to have<br>&emsp; ;; the following as personalised defaults for the ‚Äúremark‚Äù block.<br>&emsp; ;; OR, I‚Äôd like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ‚ü®0‚ü© As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n √ó (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ‚ü®1‚ü© As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about ‚Äú<em>mathsf{even}</em>‚Äù here?]]<br><br>&emsp;&emsp;;; ‚ü®2‚ü© So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ‚ü®‚òÖ‚ü© Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional (DOCSTRING '''') &rest BODY)">defblock</abbr>&#x2014; that lets users treat ùí≥ as a string-valued function in the style
of <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‚Äòinteractive‚Äô.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‚Äòdefun-declarations-alist‚Äô.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr>.
</p>

<p>
The notable features of the system are as follows.
</p>

<ul class="org-ul">
<li>Familiar <code>defun</code> syntax for making block ---<code>defblock</code></li>
<li>Familiar <code>src</code> syntax for passing arguments &#x2014;e.g., <code>:key value</code></li>
<li>Modular: New blocks can be made out of existing blocks really quickly using
<code>blockcall</code> &#x2014;similar to Lisp's <code>funcall</code>.</li>
</ul>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         EmacsConf 2020 Abstract
                      </font>
                    </strong>
                  </summary>

<p>
Users will generally only make use of a few predefined <i>special blocks</i>, such as
<code>example, centre, quote</code>, and will not bother with the effort required to make new
ones. When new encapsulating notions are required, users will either fallback on
HTML or LaTeX specific solutions, usually littered with <code>#+ATTR</code> clauses to pass
around configurations or parameters.
</p>

<p>
Efforts have been exerted to mitigate the trouble of producing new special
blocks. However, the issue of passing parameters is still handled in a clumsy
fashion; e.g., by having parameters be expressed in a special block's content
using specific keywords.
</p>

<p>
We present a novel approach to making special blocks in a familiar fashion and
their use also in a familiar fashion. We achieve the former by presenting
<code>defblock</code>, an anaphoric macro exceedingly similar to <code>defun</code>, and for the latter we
mimic the usual <code>src</code>-block syntax for argument passing to support special blocks.
</p>

<p>
For instance, here is a sample declaration.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defblock stutter () (reps 2)
  <span style="color: #2d9574;">"Output the CONTENTS of the block REPS many times"</span>
  (org-parse (<span style="color: #6c3163; font-weight: bold;">s-repeat</span> reps contents)))
</pre>
</div>

<p>
Here is an invocation that passes an optional argument; which defaults to 2 when
not given.
</p>

<pre class="example" id="org99b817c">
#+begin_stutter 5
Emacs for the win :-)
#+end_stutter 5
</pre>

<p>
Upon export, to HTML or LaTeX for instance, the contents of this block are
repeated (<i>stuttered</i>) 5 times. The use of <code>src</code>-like invocation may lead to a
decrease in <code>#+ATTR</code> clauses.
</p>

<p>
In the presentation, we aim to show a few <b>practical</b> special blocks that users
may want: A block that ‚Ä¶
</p>

<ul class="org-ul">
<li>translates <i>some selected</i> text &#x2014;useful for multilingual blogs</li>
<li>hides <i>some selected</i> text &#x2014;useful for learning, quizzes</li>
<li>folds/boxes text &#x2014;useful in blogs for folding away details</li>
</ul>

<p>
In particular, all of these examples will be around ~5 lines long!
</p>

<p>
We also have a larger collection of more useful block types, already implemented.
</p>

<p>
The notable features of the system are as follows.
</p>

<ul class="org-ul">
<li>Familiar <code>defun</code> syntax for making block ---<code>defblock</code></li>
<li>Familiar <code>src</code> syntax for passing arguments ‚Äîe.g., <code>:key value</code></li>
<li>Fine-grained control over export translation phases &#x2014;c.f., <code>org-parse</code> above</li>
<li>Modular: New blocks can be made out of existing blocks really quickly using
<code>blockcall</code> &#x2014;similar to Lisp's <code>funcall</code>. We will show how to fuse two blocks to
make a new one, also within ~5 lines.</li>
</ul>

<p>
<b>

<span style="color:blue;">

It is hoped that the ease of creating custom special blocks will be a gateway for many Emacs users to start using Lisp.

</span>

</b>
</p>

</details>
</div>


<div id="outline-container-What-is-a-special-block" class="outline-3">
<h3 id="What-is-a-special-block"><span class="section-number-3">1.1</span> <a href="#What-is-a-special-block">¬† <i>What is a special block?</i></a></h3>
<div class="outline-text-3" id="text-What-is-a-special-block">
<p>
An Org mode block is a region of text surrounded by <code>#+BEGIN_ùí≥ ‚Ä¶ #+END_ùí≥</code>; they
serve various purposes as summarised in the table below.  However, we shall
<b>use such blocks to execute arbitrary code on their contents</b>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">ùí≥</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>example</code></td>
<td class="org-left">Format text verbatim, leaving markup as is</td>
</tr>

<tr>
<td class="org-left"><code>src</code></td>
<td class="org-left">Format source code</td>
</tr>

<tr>
<td class="org-left"><code>center</code></td>
<td class="org-left">Centre text</td>
</tr>

<tr>
<td class="org-left"><code>quote</code></td>
<td class="org-left">Format text as a quotation &#x2014;ignore line breaks</td>
</tr>

<tr>
<td class="org-left"><code>verse</code></td>
<td class="org-left">Every line is appended with a line break</td>
</tr>

<tr>
<td class="org-left"><code>tiny</code></td>
<td class="org-left">Render text in a small font; likewise <code>footnotesize</code></td>
</tr>

<tr>
<td class="org-left"><code>comment</code></td>
<td class="org-left">Completely omit the text from export</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>They can be folded and unfolded in Emacs by pressing TAB in the <code>#+BEGIN</code> line.</li>
<li>The contents of blocks can be highlighted as if they were of language ‚Ñí such
as <code>org, html, latex, haskell, lisp, python, ‚Ä¶</code> by writing <code>#+BEGIN_ùí≥ ‚Ñí</code> on the
starting line, where <code>ùí≥</code> is the name of the block type.</li>
<li>Verbatim environments <code>src</code> and <code>example</code> may be followed by switch <code>-n</code> to
display line numbers for their contents.</li>
</ul>

<p>
I use <a href="https://github.com/alhassy/emacs.d#org-mode-templates-a-reason-i-generate-templates-">snippets in my init</a> to quickly insert special blocks (‚Ä¢ÃÄ·¥ó‚Ä¢ÃÅ)Ÿà
</p>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
You can ‚Äòzoom in temporarily‚Äô, <i>narrowing</i> your focus to only on a particular
block, with <abbr class="tooltip" title="Narrow buffer to current element.">org-narrow-to-element</abbr>, <code>C-x n e</code>, to make your window only show
the block.  Then use <code>C-x n w</code> to <i>widen</i> your vision of the buffer's contents.
</p>

</div>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Warning! Special blocks of the same kind do not nest!
                      </font>
                    </strong>
                  </summary>
<p>
By their very nature, special blocks of <i>the same name</i> cannot be nested &#x2014;e.g.,
try to put one <code>quote</code> block within another and see what (does not) happen.
</p>

<p>
Moreover, special blocks cannot contain unicode in their names and no
underscore, ‚Äò_‚Äô, in their names; e.g., a special block named <code>quote‚ÇÄ</code> will
actually refer to <code>quote</code>.
</p>


</details>


<p>
Our goal is to turn Org blocks into LaTeX environments and HTML divs.
</p>

<p>
Why not use LaTeX or HTML environments directly?
</p>
<ul class="org-ul">
<li>Can no longer use Org markup in such settings.</li>
<li>Committed to one specific export type.</li>
</ul>


<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Aside:</strong></span>
<p>
The export syntax <code>@@backend: ùí≥@@</code> inserts text ùí≥ literally as-is precisely when
the current backend being exported to is <code>backend</code>. This is useful for inserting
<code>html</code> snippets or <code>latex</code> commands. We can use <code>@@comment: ùí≥@@</code> to mimic inline
comments ;-)  &#x2014;Since there is [hopefully] no backend named <code>comment</code>.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>

<div style="column-rule-style: none;column-count: 3;">
<p>
In general, a ‚Äúspecial block‚Äù such as
</p>
<pre class="example" id="org31d9418">
   #+begin_ùí≥
   I /love/ Emacs!
   #+end_ùí≥
</pre>



<p>
Exports to LaTeX as:
</p>
<div class="org-src-container">
<pre class="src src-latex">   <span style="color: #3a81c3; font-weight: bold;">\begin</span>{<span style="color: #6c3163; font-weight: bold;">&#119987;</span>}
   I <span style="color: #3a81c3; font-weight: bold;">\emph</span>{<span style="font-style: italic;">love</span>} Emacs!
   <span style="color: #3a81c3; font-weight: bold;">\end</span>{<span style="color: #6c3163; font-weight: bold;">&#119987;</span>}
</pre>
</div>



<p>
Exports to HTML as:
</p>
<div class="org-src-container">
<pre class="src src-html">   &lt;<span style="color: #6c3163; font-weight: bold;">div</span> <span style="color: #715ab1;">class</span>=<span style="color: #2d9574;">"&#119987;"</span>&gt;
   I &lt;<span style="color: #6c3163; font-weight: bold;">em</span>&gt;<span style="font-style: italic;">love</span>&lt;/<span style="color: #6c3163; font-weight: bold;">em</span>&gt; Emacs!
   &lt;/<span style="color: #6c3163; font-weight: bold;">div</span>&gt;
</pre>
</div>

</div>


</div>


<div class="org-center">
<p>
<i>Notice that the standard org markup is also translated according to the export
type.</i>
</p>
</div>

<p>
If the <code>ùí≥</code> environment exists in a backend &#x2014;e.g., by some <code>\usepackage{‚ãØ}</code> or
manually with
<code>\newenvironment{ùí≥}{‚ãØ}{‚ãØ}</code> in LaTeX&#x2014; then the file will compile
without error.  Otherwise, you need to ensure it exists &#x2014;e.g., by defining the
backend formatting manually yourself.
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Aside:</strong></span>
<p>
LaTeX packages that a user needs consistently are declared in the
 list <code>org-latex-packages-alist</code>. See its documentation, with <code>C-h o</code>,
to learn more.  To export to your own LaTeX classes, <code>C-h o org-latex-classes</code>.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<div style="padding: 1em; background-color: #FFCCFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>What is an HTML ‚Äòdiv‚Äô?</h3>
<p>
A <code>div</code> tag defines a division or a section in an HTML document that is styled in
a particular fashion or has JavaScript code applied to it.  For example
&#x2014;placing the following in an <code>#+begin_export html ‚ãØ #+end_export</code>&#x2014; results in
a section of text that is editable by the user &#x2014;i.e., one can just alter text
in-place&#x2014; and its foreground colour is red, while its background colour is
light blue, and it has an uninformative tooltip.
</p>

<div style="column-rule-style: none;column-count: 2;">
<p>
<span class="underline">Source</span>
</p>
<div class="org-src-container">
<pre class="src src-html">&lt;<span style="color: #6c3163; font-weight: bold;">div</span> <span style="color: #715ab1;">contenteditable</span>=<span style="color: #2d9574;">"true"</span>
     <span style="color: #715ab1;">title</span>=<span style="color: #2d9574;">"woah, a tool tip!"</span>
     <span style="color: #715ab1;">style</span>=<span style="color: #2d9574;">"color:red; background-color:lightblue"</span>&gt;
This is <span style="text-decoration: underline;">some</span> editable text! Click me &amp; type!
&lt;/<span style="color: #6c3163; font-weight: bold;">div</span>&gt;
</pre>
</div>

<br>
<p>
<span class="underline">Result</span>
</p>
<br><br>

<div contenteditable="true"
     title="woah, a tool tip!"
     style="color:red; background-color:lightblue">
This is some editable text! Click me & type!
</div>

</div>


</div>



<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>What is a CSS ‚Äòclass‚Äô?</h3>
<p>
To use a collection of style settings repeatedly, we may declare them in a <code>class</code>
&#x2014;which is just an alias for the ;-separated list of <code>attribute:value</code>
pairs. Then our <code>div</code>'s refer to that particular <code>class</code> name.
</p>

<div style="column-rule-style: solid;column-count: 2;">
<p>
For example, in an HTML export block, we may declare the following style class
named <code>red</code>.
</p>
<pre class="example" id="orgb1933d3">
#+begin_export html
&lt;style&gt;
.red { color:red; }
&lt;/style&gt;
#+end_export
</pre>



<p>
Now, the above syntax with <code>ùí≥</code> replaced by <code>red</code> works as desired in HTML export:
HTML now knows of a class named <code>red</code>.
</p>

<br><hr>
<p>
For instance, now this
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_red
I /love/ Emacs<span style="color: #4e3163;">!</span>
#+end_red
</pre>
</div>
<p>
Results in:
</p>

<span style="color:red;">
<p>
I <i>love</i> Emacs!
</p>

</span>

<hr>

<p>
This approach, however, will not work if we want to produce LaTeX and so
requires a duplication of efforts. We would need to declare such formatting once
for each backend.
</p>


</div>


</div>
</div>
</div>

<div id="outline-container-Links" class="outline-3">
<h3 id="Links"><span class="section-number-3">1.2</span> <a href="#Links">¬† <i>How do I make a new link type?</i></a></h3>
<div class="outline-text-3" id="text-Links">
<div class="org-center">
<p>
<i>Sometimes using a block is too verbose and it'd be better to ‚Äòinline‚Äô it; for
this, we use Org's link mechanism.</i>
</p>
</div>

<p>
 Use <code class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span> params)</code> to add a
new link type &#x2014;an older obsolete method is <code>org-add-link-type</code>.  The list of all
supported link types is <code>org-link-parameters</code>; its documentation identifies the
possibilities for <code>params</code>.
</p>

<p>
Let's produce an example link type, then discuss its code.
</p>

<p>
Intended usage:
Raw use <a href="https://lmgtfy.com/?q=salam">salam</a> and descriptive, <a href="https://lmgtfy.com/?q=hola">using ‚Äòexample‚Äô link type</a> ^_^
<img src="images/example_link.png" alt="example_link.png" />
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org5ec4ae2"><span class="linenr"> 1: </span>(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
<span class="linenr"> 2: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The name of the new link type, usage: &#8220;example:label&#8221;</span>
<span id="coderef-extype" class="coderef-off"><span class="linenr"> 3: </span>  <span style="color: #2d9574;">"example"</span></span>
<span class="linenr"> 4: </span>
<span class="linenr"> 5: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">When you click on such links, &#8220;let me google that for you&#8221; happens</span>
<span id="coderef-exfollow" class="coderef-off"><span class="linenr"> 6: </span>  <span style="color: #3a81c3;">:follow</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label) (<span style="color: #6c3163; font-weight: bold;">browse-url</span> (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"https://lmgtfy.com/?q="</span> label)))</span>
<span class="linenr"> 7: </span>
<span class="linenr"> 8: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Upon export, make it a &#8220;let me google that for you&#8221; link</span>
<span id="coderef-exexport" class="coderef-off"><span class="linenr"> 9: </span>  <span style="color: #3a81c3;">:export</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label description backend)</span>
<span class="linenr">10: </span>            (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
<span class="linenr">11: </span>                      ('html <span style="color: #2d9574;">"&lt;a href=\"%s\"&gt;%s&lt;/a&gt;"</span>)
<span class="linenr">12: </span>                      ('latex <span style="color: #2d9574;">"\\href{%s}{%s}"</span>)
<span class="linenr">13: </span>                      (_ <span style="color: #2d9574;">"I don&#8217;t know how to export that!"</span>))
<span class="linenr">14: </span>                    (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"https://lmgtfy.com/?q="</span> label)
<span class="linenr">15: </span>                    (<span style="color: #3a81c3; font-weight: bold;">or</span> description label)))
<span class="linenr">16: </span>
<span class="linenr">17: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">These links should *never* be folded in descriptive display;</span>
<span class="linenr">18: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">i.e., &#8220;[[example:lable][description]]&#8221; will always appear verbatim</span>
<span class="linenr">19: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">and not hide the first pair [&#8230;].</span>
<span id="coderef-exdisplay" class="coderef-off"><span class="linenr">20: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">:display 'full</span></span>
<span class="linenr">21: </span>
<span class="linenr">22: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The tooltip alongside a link</span>
<span id="coderef-exhelpecho" class="coderef-off"><span class="linenr">23: </span>  <span style="color: #3a81c3;">:help-echo</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (window object <span style="color: #6c3163; font-weight: bold;">position</span>)</span>
<span class="linenr">24: </span>               (<span style="color: #3a81c3; font-weight: bold;">save-excursion</span>
<span class="linenr">25: </span>                 (<span style="color: #6c3163; font-weight: bold;">goto-char</span> <span style="color: #6c3163; font-weight: bold;">position</span>)
<span class="linenr">26: </span>                 (<span style="color: #3a81c3; font-weight: bold;">-let*</span> (((<span style="color: #ba2f59; font-weight: bold;">&amp;plist</span> <span style="color: #3a81c3;">:path</span> <span style="color: #3a81c3;">:format</span> <span style="color: #3a81c3;">:raw-link</span> <span style="color: #3a81c3;">:contents-begin</span> <span style="color: #3a81c3;">:contents-end</span>)
<span class="linenr">27: </span>                          (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">org-element-context</span>)))
<span class="linenr">28: </span>                         <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(org-element-property :path (org-element-context))</span>
<span class="linenr">29: </span>                         (description
<span class="linenr">30: </span>                          (<span style="color: #3a81c3; font-weight: bold;">when</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> <span style="color: #6c3163; font-weight: bold;">format</span> 'bracket)
<span class="linenr">31: </span>                            (<span style="color: #6c3163; font-weight: bold;">copy-region-as-kill</span> contents-begin contents-end)
<span class="linenr">32: </span>                            (<span style="color: #6c3163; font-weight: bold;">substring-no-properties</span> (<span style="color: #6c3163; font-weight: bold;">car</span> <span style="color: #715ab1;">kill-ring</span>)))))
<span class="linenr">33: </span>                   (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"&#8220;%s&#8221; :: Let me google &#8220;%s&#8221; for you -__-"</span>
<span class="linenr">34: </span>                          raw-link (<span style="color: #3a81c3; font-weight: bold;">or</span> description raw-link)))))
<span class="linenr">35: </span>
<span class="linenr">36: </span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">How should these links be displayed</span>
<span id="coderef-exface" class="coderef-off"><span class="linenr">37: </span>  <span style="color: #3a81c3;">:face</span> '(<span style="color: #3a81c3;">:foreground</span> <span style="color: #2d9574;">"red"</span> <span style="color: #3a81c3;">:weight</span> <span style="color: #6c3163; font-weight: bold;">bold</span></span>
<span class="linenr">38: </span>          <span style="color: #3a81c3;">:underline</span> <span style="color: #2d9574;">"orange"</span> <span style="color: #3a81c3;">:overline</span> <span style="color: #2d9574;">"orange"</span>))
</pre>
</div>


<dl class="org-dl">
<dt>Line <a href="#coderef-extype" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-extype');" onmouseout="CodeHighlightOff(this, 'coderef-extype');">3</a> <code>"example"</code></dt><dd><p>
Add a new <code>example</code> link type.
</p>
<ul class="org-ul">
<li>If the type already exists, update it with the given arguments.</li>
</ul>

<p>
The syntax for a raw link is <code>example:path</code>
and for the bracketed descriptive form <code>[[example:path][description]]</code>.
</p>

<ul class="org-ul">
<li>Some of my intended uses for links including colouring text and doing
nothing else, as such the terminology ‚Äòpath‚Äô is not sufficiently generic and
so I use the designation ‚Äòlabel‚Äô instead.</li>
</ul></dd>

<dt>Line <a href="#coderef-exfollow" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exfollow');" onmouseout="CodeHighlightOff(this, 'coderef-exfollow');">6</a> <code>:follow</code></dt><dd><p>
What should happen when a user clicks on such links?
</p>

<p>
This is a function taking the link path as the single argument and does
whatever is necessary to ‚Äúfollow the link‚Äù, for example find a file or display
a message. In our case, we open the user's browser and go to a particular URL.
</p></dd>

<dt>Line <a href="#coderef-exexport" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exexport');" onmouseout="CodeHighlightOff(this, 'coderef-exexport');">9</a> <code>:export</code></dt><dd><p>
How should this link type be exported to HTML, LaTeX, etc?
</p>

<p>
This is a three-argument function that formats the link according to the given
backend, the resulting string value os placed literally into the exported
file. Its arguments are:
</p>

<ol class="org-ol">
<li><code>label</code> ‚áí the path of the link, the text after the link type prefix</li>
<li><code>description</code> ‚áí the description of the link, if any</li>
<li><code>backend</code> ‚áí the export format, a symbol like <code>html</code> or <code>latex</code> or <code>ascii</code>.</li>
</ol>

<p>
In our example above, we return different values depending on the <code>backend</code>
value.
</p>

<ul class="org-ul">
<li>If <code>:export</code> is not provided, default Org-link exportation happens.</li>
</ul></dd>

<dt>Line <a href="#coderef-exdisplay" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exdisplay');" onmouseout="CodeHighlightOff(this, 'coderef-exdisplay');">20</a> <code>:display</code></dt><dd>Should links be prettily folded away when a description
is provided?</dd>

<dt>Line <a href="#coderef-exhelpecho" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exhelpecho');" onmouseout="CodeHighlightOff(this, 'coderef-exhelpecho');">23</a> <code>:help-echo</code></dt><dd><p>
What should happen when the user's mouse is over
the link?
</p>

<p>
This is <b>either a string or a string-valued function</b> that takes the current
window, the current buffer object, and its position in the current window.
</p>

<p>
In our example link, we go to the position of the object, destructure the Org
link's properties using <code>-let</code>, find the description of the link, if any, then
provide a string based on the link's path and description.
</p></dd>
</dl>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         The general textual property ‚Äòhelp-echo‚Äô
                      </font>
                    </strong>
                  </summary>
<p>
We may use <code>help-echo</code> to attach tooltips to arbitrary text in a file, as
follows. I have found this to be useful in <a href="https://alhassy.github.io/next-700-module-systems/prototype/package-former.html"><b>metaprogramming</b></a> to have
elaborated, generated, code shown as a tooltip attached to its named
specification.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Nearly instantaneous display of tooltips.</span>
(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #6c3163; font-weight: bold;">tooltip-delay</span> 0)

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Give user 30 seconds before tooltip automatically disappears.</span>
(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">tooltip-hide-delay</span> 300)

(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">tooltipify</span> (phrase notification <span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> <span style="color: #655370; background-color: #fbf8ef;">underline</span>)
  <span style="color: #da8b55;">"Add a tooltip to every instance of PHRASE to show NOTIFICATION.</span>

<span style="color: #da8b55;">We only add tooltips to PHRASE as a standalone word, not as a subword.</span>

<span style="color: #da8b55;">If UNDERLINE is provided, we underline the given PHRASE so as to</span>
<span style="color: #da8b55;">provide a visual clue that it has a tooltip attched to it.</span>

<span style="color: #da8b55;">The PHRASE is taken literally; no regexp operators are recognised."</span>
  (<span style="color: #3a81c3; font-weight: bold;">assert</span> (<span style="color: #6c3163; font-weight: bold;">stringp</span> phrase))
  (<span style="color: #3a81c3; font-weight: bold;">assert</span> (<span style="color: #6c3163; font-weight: bold;">stringp</span> notification))
  (<span style="color: #3a81c3; font-weight: bold;">save-excursion</span>  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Return cursour to current-point afterwards.</span>
    (<span style="color: #6c3163; font-weight: bold;">goto-char</span> 1)
    <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The \b are for empty-string at the start or end of a word.</span>
    (<span style="color: #3a81c3; font-weight: bold;">while</span> (<span style="color: #6c3163; font-weight: bold;">search-forward-regexp</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"\\b%s\\b"</span> (<span style="color: #6c3163; font-weight: bold;">regexp-quote</span> phrase))
                                  (<span style="color: #6c3163; font-weight: bold;">point-max</span>) <span style="color: #715ab1;">t</span>)
      <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(add-text-properties x y ps)</span>
      <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8658; Override properties ps for all text between x and y.</span>
      (<span style="color: #6c3163; font-weight: bold;">add-text-properties</span> (<span style="color: #6c3163; font-weight: bold;">match-beginning</span> 0)
                           (<span style="color: #6c3163; font-weight: bold;">match-end</span> 0)
                           (<span style="color: #6c3163; font-weight: bold;">list</span> 'help-echo (<span style="color: #6c3163; font-weight: bold;">s-trim</span> notification)))))
 <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Example use</span>
(tooltipify
  <span style="color: #2d9574;">"Line"</span>
  <span style="color: #2d9574;">"A sequential formatation of entities or the trace of a particle in linear motion"</span>)
</pre>
</div>

<p>
We will use the tooltip <abbr class="tooltip" title="Return the documentation string of FUNCTION.<br>Unless a non-nil second argument RAW is given, the<br>string is passed through ‚Äòsubstitute-command-keys‚Äô.<br><br>(fn FUNCTION &optional RAW)">documentation</abbr> later on ^_^
</p>

<p>
Useful info on tooltips:
</p>
<ul class="org-ul">
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Changing-Properties.html">Changing text properties &#x2014;GNU</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2013/04/12/Tool-tips-on-text-in-Emacs/">Tooltips on text in Emacs &#x2014;Kitchin</a></li>
<li><a href="http://kitchingroup.cheme.cmu.edu/blog/2016/03/16/Getting-graphical-feedback-as-tooltips-in-Emacs/">Getting graphical feedback as tooltips in Emacs &#x2014;Kitchin</a></li>
<li><a href="https://stackoverflow.com/questions/293853/defining-new-tooltips-in-emacs">Defining new tooltips in Emacs &#x2014;Stackoverflow</a></li>
</ul>



</details>


<dl class="org-dl">
<dt>Line <a href="#coderef-exface" class="coderef" onmouseover="CodeHighlightOn(this, 'coderef-exface');" onmouseout="CodeHighlightOff(this, 'coderef-exface');">37</a> <code>:face</code></dt><dd><p>
What textual properties do these links possess?
</p>

<p>
This is <b>either a face or a face-valued function</b> that takes the current link's
path label as the only argument. That is, we could change the face according
to the link's label &#x2014;which is what we will do for the <code>color</code> link type as in
<code>[[color:brown][hello]]</code> will be rendered in brown text.
</p>

<ul class="org-ul">
<li>If <code>:face</code> is not provided, the default underlined blue face for Org links is used.</li>
<li><a href="https://www.gnu.org/software/emacs/manual/html_node/elisp/Faces.html">Learn more about faces!</a></li>
</ul></dd>

<dt>More</dt><dd>See <code>org-link-parameters</code> for documentation on more parameters.</dd>
</dl>
</div>
</div>

<div id="outline-container-The-Core-Utility-defblock-and-friends" class="outline-3">
<h3 id="The-Core-Utility-defblock-and-friends"><span class="section-number-3">1.3</span> <a href="#The-Core-Utility-defblock-and-friends">The Core Utility: <code>defblock</code> and friends</a></h3>
<div class="outline-text-3" id="text-The-Core-Utility-defblock-and-friends">
<p>
To have a unified, and pleasant, interface for declaring new blocks and links,
we take the following approach:
</p>
<ol class="org-ol">
<li value="0">( <i>Fuse</i> the process of link generation and special block support into
one macro,  <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode src-block<br>consumes as main argument the language for the src block,<br>our special blocks too consume a MAIN-ARG; it may be a symbol<br>or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‚Äò,‚Äô since<br>it is a special Lisp operator. In doubt, enclose the main arg<br>in quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key‚ÇÄ value‚ÇÄ ‚Ä¶ key‚Çô value‚Çô).<br><br>After that is a DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip<br>for the produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---<br>that may refer to the names BACKEND and CONTENTS<br>which refer to the current export backend and the contents<br>of the special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e.,<br>Org-markup is acknowledged.<br><br>In, hopefully, rare circumstances, one may refer<br>to RAW-CONTENTS to look at the fully unparsed contents.<br><br>----------------------------------------------------------------------<br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>‚âà<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br>----------------------------------------------------------------------<br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ‚Äô(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX) editorial remarks; in Emacs they‚Äôre angry red.''<br>&emsp;&emsp; (format (if (equal backend ‚Äôhtml)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>‚ü¶%s:&emsp;%s%s‚üß</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don‚Äôt want to change the definition, but I‚Äôd like to have<br>&emsp; ;; the following as personalised defaults for the ‚Äúremark‚Äù block.<br>&emsp; ;; OR, I‚Äôd like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ‚ü®0‚ü© As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n √ó (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ‚ü®1‚ü© As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about ‚Äú<em>mathsf{even}</em>‚Äù here?]]<br><br>&emsp;&emsp;;; ‚ü®2‚ü© So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ‚ü®‚òÖ‚ü© Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional (DOCSTRING '''') &rest BODY)">defblock</abbr> which is like <abbr class="tooltip" title="Define NAME as a function.<br>The definition is (lambda ARGLIST [DOCSTRING] BODY...).<br>See also the function ‚Äòinteractive‚Äô.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‚Äòdefun-declarations-alist‚Äô.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defun</abbr>. )</li>
<li>The user writes as string-valued function named ùí≥, possibly with arguments,
that has access to a <code>contents</code> and <code>backend</code> variables.</li>
</ol>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‚Äòdefblock‚Äô Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span> (x)
  <span style="color: #da8b55;">"Wrap the given X in an export block for the current backend."</span>
  (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"\n#+begin_export %s \n%s\n#+end_export\n"</span>
          (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> <span style="color: #715ab1;">org-special-block-extras--current-backend</span> 'reveal)
              'html
            <span style="color: #715ab1;">org-special-block-extras--current-backend</span>)
          x))

(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-parse</span> (x)
  <span style="color: #da8b55;">"This should ONLY be called within an ORG-EXPORT call."</span>
   (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"\n#+end_export\n%s\n#+begin_export %s\n"</span> x
           (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> 'reveal <span style="color: #715ab1;">org-special-block-extras--current-backend</span>)
               'html
             <span style="color: #715ab1;">org-special-block-extras--current-backend</span>)))

(<span style="color: #3a81c3; font-weight: bold;">cl-defmacro</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--defblock</span>
  (name main-arg kwds <span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> (docstring <span style="color: #2d9574;">""</span>) <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> body)
  <span style="color: #da8b55;">"Declare a new special block, and link, in the style of DEFUN.</span>

<span style="color: #da8b55;">A full featured example is at the end of this documentation string.</span>

<span style="color: #da8b55;">This is an anaphoric macro that provides export support for</span>
<span style="color: #da8b55;">special blocks *and* links named NAME. Just as an Org-mode src-block</span>
<span style="color: #da8b55;">consumes as main argument the language for the src block,</span>
<span style="color: #da8b55;">our special blocks too consume a MAIN-ARG; it may be a symbol</span>
<span style="color: #da8b55;">or a cons-list consisting of a symbolic name (with which</span>
<span style="color: #da8b55;">to refer to the main argument in the definition of the block)</span>
<span style="color: #da8b55;">followed by a default value, then, optionally, any information</span>
<span style="color: #da8b55;">for a one-time setup of the associated link type.</span>

<span style="color: #da8b55;">The main arg may be a sequence of symbols separated by spaces,</span>
<span style="color: #da8b55;">and a few punctuation with the exception of comma &#8216;,&#8217; since</span>
<span style="color: #da8b55;">it is a special Lisp operator. In doubt, enclose the main arg</span>
<span style="color: #da8b55;">in quotes.</span>

<span style="color: #da8b55;">Then, just as Org-mode src blocks consume key-value pairs, our</span>
<span style="color: #da8b55;">special blocks consume a number of KWDS, which is a list of the</span>
<span style="color: #da8b55;">form (key&#8320; value&#8320; &#8230; key&#8345; value&#8345;).</span>

<span style="color: #da8b55;">After that is a DOCSTRING, a familar feature of DEFUN.</span>
<span style="color: #da8b55;">The docstring is displayed as part of the tooltip</span>
<span style="color: #da8b55;">for the produced link type.</span>

<span style="color: #da8b55;">Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---</span>
<span style="color: #da8b55;">that may refer to the names BACKEND and CONTENTS</span>
<span style="color: #da8b55;">which refer to the current export backend and the contents</span>
<span style="color: #da8b55;">of the special block ---or the description clause of a link.</span>

<span style="color: #da8b55;">CONTENTS refers to an Org-mode parsed string; i.e.,</span>
<span style="color: #da8b55;">Org-markup is acknowledged.</span>

<span style="color: #da8b55;">In, hopefully, rare circumstances, one may refer</span>
<span style="color: #da8b55;">to RAW-CONTENTS to look at the fully unparsed contents.</span>

<span style="color: #da8b55;">----------------------------------------------------------------------</span>

<span style="color: #da8b55;">The relationship between links and special blocks:</span>

<span style="color: #da8b55;">  [ [type:label][description]]</span>
<span style="color: #da8b55;">&#8776;</span>
<span style="color: #da8b55;">   #+begin_type label</span>
<span style="color: #da8b55;">    description</span>
<span style="color: #da8b55;">   #+end_type</span>

<span style="color: #da8b55;">----------------------------------------------------------------------</span>

<span style="color: #da8b55;">Example declaration, with all possible features shown:</span>

<span style="color: #da8b55;">   ;; We can use variable values when defining new blocks</span>
<span style="color: #da8b55;">   (setq angry-red '(:foreground \"red\" :weight bold))</span>

<span style="color: #da8b55;">   (defblock remark</span>
<span style="color: #da8b55;">     (editor \"Editor Remark\" :face angry-red) (color \"red\" signoff \"\")</span>
<span style="color: #da8b55;">     \"Top level (HTML &amp; LaTeX) editorial remarks; in Emacs they're angry red.\"</span>
<span style="color: #da8b55;">     (format (if (equal backend 'html)</span>
<span style="color: #da8b55;">               \"&lt;strong style=\\\"color: %s;\\\"&gt;&#10214;%s:  %s%s&#10215;&lt;/strong&gt;\"</span>
<span style="color: #da8b55;">               \"{\\color{%s}\\bfseries %s:  %s%s}\")</span>
<span style="color: #da8b55;">             color editor contents signoff))</span>

<span style="color: #da8b55;">   ;; I don't want to change the definition, but I'd like to have</span>
<span style="color: #da8b55;">   ;; the following as personalised defaults for the &#8220;remark&#8221; block.</span>
<span style="color: #da8b55;">   ;; OR, I'd like to set this for links, which do not have argument options.</span>
<span style="color: #da8b55;">   (defblock-header-args remark :main-arg \"Jasim Jameson\" :signoff \"( Aim for success! )\")</span>

<span style="color: #da8b55;">Three example uses:</span>

<span style="color: #da8b55;">    ;; &#10216;0&#10217; As a special blocks with arguments given.</span>
<span style="color: #da8b55;">    #+begin_remark Bobbert Barakallah :signoff \"Thank-you for pointing this out!\" :color green</span>
<span style="color: #da8b55;">    I was trying to explain that ${</span><span style="color: #dc752f; background-color: #fbf8ef;">\</span><span style="color: #da8b55;">large (n &#215; (n + 1) </span><span style="color: #dc752f; background-color: #fbf8ef;">\</span><span style="color: #da8b55;">over 2}$ is always an integer.</span>
<span style="color: #da8b55;">    #+end_remark</span>

<span style="color: #da8b55;">    ;; &#10216;1&#10217; As a terse link, using default values for the args.</span>
<span style="color: #da8b55;">    ;;     Notice that Org-mode formatting is recoqgnised even in links.</span>
<span style="color: #da8b55;">    [ [remark:Jasim Jameson][Why are you taking about &#8220;$</span><span style="color: #dc752f; background-color: #fbf8ef;">\</span><span style="color: #da8b55;">mathsf{even}$&#8221; here?]]</span>

<span style="color: #da8b55;">    ;; &#10216;2&#10217; So terse that no editor name is provided.</span>
<span style="color: #da8b55;">    [ [remark:][Please improve your transition sentences.]]</span>

<span style="color: #da8b55;">    ;; &#10216;&#9733;&#10217; Unlike 0, examples 1 and 2 will have the default SIGNOFF</span>
<span style="color: #da8b55;">    ;; catenated as well as the default red color.</span>
<span style="color: #da8b55;">"</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8680; The special block support</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;;</span>
  (<span style="color: #6c3163; font-weight: bold;">add-to-list</span> '<span style="color: #715ab1;">org-special-block-extras--supported-blocks</span> name) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">global var</span>
  `(<span style="color: #3a81c3; font-weight: bold;">progn</span> (<span style="color: #3a81c3; font-weight: bold;">cl-defun</span> ,(<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"org-special-block-extras--%s"</span> name))
        (backend raw-contents
                 <span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">,(car main-arg)</span>
                 ,(<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">consp</span> `,main-arg) (<span style="color: #6c3163; font-weight: bold;">car</span> main-arg) 'main-arg)
                 <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> _
                 <span style="color: #ba2f59; font-weight: bold;">&amp;key</span> ,@(<span style="color: #6c3163; font-weight: bold;">-partition</span> 2 kwds))
       ,docstring
       <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Use default for main argument</span>
       (<span style="color: #3a81c3; font-weight: bold;">when</span> (<span style="color: #3a81c3; font-weight: bold;">and</span> ',(<span style="color: #6c3163; font-weight: bold;">car</span> main-arg) (<span style="color: #6c3163; font-weight: bold;">s-blank-p</span> ,(<span style="color: #6c3163; font-weight: bold;">car</span> main-arg)))
         (<span style="color: #3a81c3; font-weight: bold;">--if-let</span> (<span style="color: #6c3163; font-weight: bold;">plist-get</span> (<span style="color: #6c3163; font-weight: bold;">cdr</span> (<span style="color: #6c3163; font-weight: bold;">assoc</span> ',name <span style="color: #715ab1;">org-special-block-extras--header-args</span>)) <span style="color: #3a81c3;">:main-arg</span>)
             (<span style="color: #3a81c3; font-weight: bold;">setq</span> ,(<span style="color: #6c3163; font-weight: bold;">car</span> main-arg) it)
           (<span style="color: #3a81c3; font-weight: bold;">setq</span> ,(<span style="color: #6c3163; font-weight: bold;">car</span> main-arg) ,(<span style="color: #6c3163; font-weight: bold;">cadr</span> main-arg))))

       <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Use any headers for this block type, if no local value is passed</span>
       ,@(<span style="color: #3a81c3; font-weight: bold;">loop</span> for k in (<span style="color: #6c3163; font-weight: bold;">mapcar</span> #'<span style="color: #6c3163; font-weight: bold;">car</span> (<span style="color: #6c3163; font-weight: bold;">-partition</span> 2 kwds))
               collect `(<span style="color: #3a81c3; font-weight: bold;">--when-let</span> (<span style="color: #6c3163; font-weight: bold;">plist-get</span> (<span style="color: #6c3163; font-weight: bold;">cdr</span> (<span style="color: #6c3163; font-weight: bold;">assoc</span> ',name <span style="color: #715ab1;">org-special-block-extras--header-args</span>)) ,(<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">":%s"</span> k))) (<span style="color: #3a81c3; font-weight: bold;">when</span> (<span style="color: #6c3163; font-weight: bold;">s-blank-p</span> ,k) (<span style="color: #3a81c3; font-weight: bold;">setq</span> ,k it))))
       (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span>
                              (<span style="color: #3a81c3; font-weight: bold;">let</span> ((contents (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-parse</span> raw-contents))) ,@body)))

  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8680; The link type support</span>
  (<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
   ,(<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s"</span> name)
   <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">main-arg</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217; may contain a special key &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">:link-type</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217; whose contents</span>
   <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">are dumped here verbatim.</span>
   <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8216;(main-arg-name main-arg-val :face &#8230; :follow &#8230;)&#8217;</span>
   ,@(<span style="color: #6c3163; font-weight: bold;">cddr</span> main-arg)
   <span style="color: #3a81c3;">:export</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label description backend)
             (<span style="color: #6c3163; font-weight: bold;">s-replace-all</span> `((<span style="color: #2d9574;">"#+end_export"</span> . <span style="color: #2d9574;">""</span>) (,(<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"#+begin_export %s"</span> backend) . <span style="color: #2d9574;">""</span>))
                            (,(<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"org-special-block-extras--%s"</span> name))
                             backend (<span style="color: #3a81c3; font-weight: bold;">or</span> description label) label)))
   <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The tooltip alongside a link</span>
    <span style="color: #3a81c3;">:help-echo</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (window object <span style="color: #6c3163; font-weight: bold;">position</span>)
                 (<span style="color: #3a81c3; font-weight: bold;">save-excursion</span>
                   (<span style="color: #6c3163; font-weight: bold;">goto-char</span> <span style="color: #6c3163; font-weight: bold;">position</span>)
                   (<span style="color: #3a81c3; font-weight: bold;">-let*</span> (((<span style="color: #ba2f59; font-weight: bold;">&amp;plist</span> <span style="color: #3a81c3;">:path</span> <span style="color: #3a81c3;">:format</span> <span style="color: #3a81c3;">:raw-link</span> <span style="color: #3a81c3;">:contents-begin</span> <span style="color: #3a81c3;">:contents-end</span>)
                            (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">org-element-context</span>)))
                           (description
                            (<span style="color: #3a81c3; font-weight: bold;">when</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> <span style="color: #6c3163; font-weight: bold;">format</span> 'bracket)
                              (<span style="color: #6c3163; font-weight: bold;">copy-region-as-kill</span> contents-begin contents-end)
                              (<span style="color: #6c3163; font-weight: bold;">substring-no-properties</span> (<span style="color: #6c3163; font-weight: bold;">car</span> <span style="color: #715ab1;">kill-ring</span>)))))
                     (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s\n\n%s"</span>
                            raw-link ,docstring)))))))
</pre>
</div>

<p>
Going forward, it would be nice to have a set of switches that apply to all
special blocks. For instance, <code>:ignore</code> to simply bypass the user-defined
behaviour of a block type, and <code>:noexport</code> to zero-out a block upon export.  These
are super easy to do &#x2014;just need a few minutes to breath.  It may also be
desirable to provide support for <a href="https://github.com/alhassy/emacs.d#html-folded-drawers">drawers</a> &#x2014;just as we did to ‚Äòfuse‚Äô the
block-type and link-type approaches used here into one macro.
</p>



</details>


<ol class="org-ol">
<li value="2"><p>
We tell Org to please look at all special blocks
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_&#119987; main-arg :key&#8320; value&#8320; &#8230; :key&#8345; value&#8345;
contents
#+end_&#119987;
</pre>
</div>
<p>
Then, before export happens, to replace all such blocks
with the <i>result</i> of calling the user's ùí≥ function; i.e.,
replace them by, essentially,
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(&#119987; main-arg <span style="color: #3a81c3;">:key&#8320;</span> value&#8320; &#8230; <span style="color: #3a81c3;">:key&#8345;</span> value&#8345;)
</pre>
</div></li>
</ol>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementing the hooking mechanism
                      </font>
                    </strong>
                  </summary>

<p>
The mechanism that rewrites your source&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--pp-list</span> (xs)
  <span style="color: #da8b55;">"Given XS as (x&#8321; x&#8322; &#8230; x&#8345;), yield the string &#8220;x&#8321; x&#8322; &#8230; x&#8345;&#8221;, no parens.</span>
<span style="color: #da8b55;">  When n = 0, yield the empty string &#8220;&#8221;."</span>
  (<span style="color: #6c3163; font-weight: bold;">s-chop-suffix</span> <span style="color: #2d9574;">")"</span> (<span style="color: #6c3163; font-weight: bold;">s-chop-prefix</span> <span style="color: #2d9574;">"("</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s"</span> (<span style="color: #3a81c3; font-weight: bold;">or</span> xs <span style="color: #2d9574;">""</span>)))))

(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--supported-blocks</span> nil
  <span style="color: #da8b55;">"Which special blocks, defined with DEFBLOCK, are supported."</span>)

(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--current-backend</span> nil
  <span style="color: #da8b55;">"A message-passing channel updated by</span>
<span style="color: #da8b55;">org-special-block-extras--support-special-blocks-with-args</span>
<span style="color: #da8b55;">and used by DEFBLOCK."</span>)

(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--support-special-blocks-with-args</span> (backend)
  <span style="color: #da8b55;">"Remove all headlines in the current buffer.</span>
<span style="color: #da8b55;">BACKEND is the export back-end being used, as a symbol."</span>
  (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--current-backend</span> backend)
  (<span style="color: #3a81c3; font-weight: bold;">loop</span> for blk in <span style="color: #715ab1;">org-special-block-extras--supported-blocks</span>
        for kwdargs <span style="color: #6c3163; font-weight: bold;">=</span> nil
        for blk-start <span style="color: #6c3163; font-weight: bold;">=</span> nil
        <span style="color: #6c3163; font-weight: bold;">do</span> (<span style="color: #6c3163; font-weight: bold;">goto-char</span> (<span style="color: #6c3163; font-weight: bold;">point-min</span>))
        (<span style="color: #3a81c3; font-weight: bold;">while</span> (<span style="color: #3a81c3; font-weight: bold;">ignore-errors</span> (<span style="color: #6c3163; font-weight: bold;">re-search-forward</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"^\s*\\#\\+begin_%s"</span> blk)))
          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">MA: HACK: Instead of a space, it should be any non-whitespace, optionally;</span>
          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">otherwise it may accidentlly rewrite blocks with one being a prefix of the other!</span>
          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(kill-line)</span>
          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(error (format "(%s)" (substring-no-properties (car kill-ring))))</span>
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> blk-start (<span style="color: #6c3163; font-weight: bold;">line-beginning-position</span>))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> header-start (<span style="color: #6c3163; font-weight: bold;">point</span>))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> body-start (<span style="color: #6c3163; font-weight: bold;">1+</span> (<span style="color: #6c3163; font-weight: bold;">line-end-position</span>)))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> kwdargs (<span style="color: #6c3163; font-weight: bold;">read</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"(%s)"</span> (<span style="color: #6c3163; font-weight: bold;">buffer-substring-no-properties</span> header-start (<span style="color: #6c3163; font-weight: bold;">line-end-position</span>)))))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> kwdargs (<span style="color: #3a81c3; font-weight: bold;">--split-with</span> (<span style="color: #6c3163; font-weight: bold;">not</span> (<span style="color: #6c3163; font-weight: bold;">keywordp</span> it)) kwdargs))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> main-arg (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--pp-list</span> (<span style="color: #6c3163; font-weight: bold;">car</span> kwdargs)))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> kwdargs (<span style="color: #6c3163; font-weight: bold;">cadr</span> kwdargs))
          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(beginning-of-line) (kill-line)</span>
          (<span style="color: #6c3163; font-weight: bold;">forward-line</span> -1)
          (<span style="color: #6c3163; font-weight: bold;">re-search-forward</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"^\s*\\#\\+end_%s"</span> blk))
          (<span style="color: #3a81c3; font-weight: bold;">setq</span> contents (<span style="color: #6c3163; font-weight: bold;">buffer-substring-no-properties</span> body-start (<span style="color: #6c3163; font-weight: bold;">line-beginning-position</span>)))
          <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(beginning-of-line)(kill-line) ;; Hack!</span>
          (<span style="color: #6c3163; font-weight: bold;">kill-region</span> blk-start (<span style="color: #6c3163; font-weight: bold;">point</span>))
          (<span style="color: #6c3163; font-weight: bold;">insert</span>
             (<span style="color: #6c3163; font-weight: bold;">eval</span> `(,(<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"org-special-block-extras--%s"</span> blk))
                     backend
                     contents
                     main-arg
                     ,@(<span style="color: #3a81c3; font-weight: bold;">--map</span> (<span style="color: #6c3163; font-weight: bold;">list</span> '<span style="color: #6c3163; font-weight: bold;">quote</span> it) kwdargs)))
             )
          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">the --map is so that arguments may be passed</span>
          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">as "this" or just &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">this</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217; (raw symbols)</span>
      )))
</pre>
</div>

<p>
When you enable the <code>org-special-block-extras</code> mode, it is activated&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">https://orgmode.org/manual/Advanced-Export-Configuration.html</span>
(<span style="color: #6c3163; font-weight: bold;">add-hook</span> '<span style="color: #715ab1;">org-export-before-parsing-hook</span> '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--support-special-blocks-with-args</span>)
</pre>
</div>

<p>
When you disable the <code>org-special-block-extras</code> mode, it is deactivated&#x2026;
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">remove-hook</span> '<span style="color: #715ab1;">org-export-before-parsing-hook</span> '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--support-special-blocks-with-args</span>)
</pre>
</div>



</details>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‚Äòheader-args‚Äô Implementation
                      </font>
                    </strong>
                  </summary>
<p>
Then:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--header-args</span> nil
  <span style="color: #da8b55;">"Alist (name plist) where &#8220;:main-arg&#8221; is a special plist key.</span>

<span style="color: #da8b55;">  It serves a similar role to that of Org's src &#8216;</span><span style="color: #4e3163;">header-args</span><span style="color: #da8b55;">&#8217;.</span>

<span style="color: #da8b55;">  See doc of SET-BLOCK-HEADER-ARGS for more information."</span>)

(<span style="color: #3a81c3; font-weight: bold;">defmacro</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--set-block-header-args</span> (blk <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> kvs)
  <span style="color: #da8b55;">"Set default valuts for special block arguments.</span>

<span style="color: #da8b55;">This is similar to, and inspired by, Org-src block header-args.</span>

<span style="color: #da8b55;">Example src use:</span>
<span style="color: #da8b55;">    #+PROPERTY: header-args:Language :key value</span>

<span style="color: #da8b55;">Example block use:</span>
<span style="color: #da8b55;">    (defblock-header-args Block :main-arg mainvalue :key value)</span>

<span style="color: #da8b55;">A full, working, example can be seen by &#8220;C-h o RET defblock&#8221;.</span>
<span style="color: #da8b55;">"</span>
  `(<span style="color: #6c3163; font-weight: bold;">add-to-list</span> '<span style="color: #715ab1;">org-special-block-extras--header-args</span> (<span style="color: #6c3163; font-weight: bold;">list</span> (<span style="color: #3a81c3; font-weight: bold;">quote</span> ,blk) ,@kvs)))

(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras-short-names</span> ()
  <span style="color: #da8b55;">"Expose shorter names to the user.</span>

<span style="color: #da8b55;">Namely,</span>

<span style="color: #da8b55;">  org-special-block-extras--set-block-header-args   &#8614;  set-block-header-args</span>
<span style="color: #da8b55;">  org-special-block-extras--set-block-header-args   &#8614;  defblock</span>
<span style="color: #da8b55;">  org-special-block-extras--subtle-colors           &#8614;  subtle-colors</span>
<span style="color: #da8b55;">"</span>
  (<span style="color: #3a81c3; font-weight: bold;">defalias</span> '<span style="color: #6c3163; font-weight: bold;">defblock</span>              '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--defblock</span>)
  (<span style="color: #3a81c3; font-weight: bold;">defalias</span> '<span style="color: #6c3163; font-weight: bold;">set-block-header-args</span> '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--set-block-header-args</span>)
  (<span style="color: #3a81c3; font-weight: bold;">defalias</span> '<span style="color: #6c3163; font-weight: bold;">thread-block-call</span>     '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--thread-blockcall</span>)
  (<span style="color: #3a81c3; font-weight: bold;">defalias</span> '<span style="color: #6c3163; font-weight: bold;">subtle-colors</span>         '<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--subtle-colors</span>))
</pre>
</div>


</details>


<p>
This interface is essentially that of Org's <code>src</code> blocks, with the <code>main-arg</code>
being the first argument to ùí≥ and the only argument not needing to be
preceded by a key name &#x2014;it is done this way to remain somewhat consistent
with the Org <code>src</code> interface. The user definition of ùí≥ decides on <i>how optional</i>
the arguments actually are.
</p>

<p>
Perhaps an example will clarify things &#x2026;
</p>
</div>

<div id="outline-container-Example-Jasim-providing-in-place-feedback-to-Bobbert" class="outline-4">
<h4 id="Example-Jasim-providing-in-place-feedback-to-Bobbert"><span class="section-number-4">1.3.1</span> <a href="#Example-Jasim-providing-in-place-feedback-to-Bobbert">Example: Jasim providing in-place feedback to Bobbert</a></h4>
<div class="outline-text-4" id="text-Example-Jasim-providing-in-place-feedback-to-Bobbert">
<p>
Suppose we want to devise a simple special block for editors to provide
constructive feedback to authors so that the feedback appears as top-level
elements of the resulting exported file &#x2014;instead of comments that may
accidentally not be handled by the author.
</p>

<p>
In order to showcase the multiple bells and whistles of the system, the snippet
below is twice as long than it needs to be, but it is still reasonably small and
accessible.  ( The documentation string to <code>defblock</code> is mandatory. )
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">We can use variable values when defining new blocks</span>
(<span style="color: #3a81c3; font-weight: bold;">setq</span> angry-red '(<span style="color: #3a81c3;">:foreground</span> <span style="color: #2d9574;">"red"</span> <span style="color: #3a81c3;">:weight</span> <span style="color: #6c3163; font-weight: bold;">bold</span>))

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">This is our &#119987;, &#8220;remark&#8221;.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">As a link, it should be shown angry-red;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">it takes two arguments: &#8220;color&#8221; and &#8220;signoff&#8221;</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">with default values being "red" and "".</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(Assuming we already called org-special-block-extras-short-names. )</span>
(defblock rremark
  (editor <span style="color: #2d9574;">"Editor Remark"</span> <span style="color: #3a81c3;">:face</span> angry-red) (color <span style="color: #2d9574;">"red"</span> signoff <span style="color: #2d9574;">""</span>)
  <span style="color: #2d9574;">"Top level (HTML &amp; LaTeX) editorial remarks; in Emacs they're angry red."</span>
  (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> backend 'html)
            <span style="color: #2d9574;">"&lt;strong style=\"color: %s;\"&gt;&#10214;%s:  %s%s&#10215;&lt;/strong&gt;"</span>
            <span style="color: #2d9574;">"{\\color{%s}\\bfseries %s:  %s%s}"</span>)
          color editor contents signoff))

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">I don't want to change the definition, but I'd like to have</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">the following as personalised defaults for the &#8220;remark&#8221; block.</span>
<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">OR, I'd like to set this for links, which do not have argument options.</span>
(set-block-header-args rremark <span style="color: #3a81c3;">:main-arg</span> <span style="color: #2d9574;">"Jasim Jameson"</span> <span style="color: #3a81c3;">:signoff</span> <span style="color: #2d9574;">"( Aim for success! )"</span>)
</pre>
</div>

<p>
<span class="underline">Example use</span>
</p>
<pre class="example" id="orge2a7e5b">
The sum of the first $n$ natural numbers is $\sum_{i = 0}^n i = {n √ó (n + 1)
\over 2}$. Note that $n √ó (n + 1)$ is even.
[[rremark:Jasim Jameson][Why are you taking about ‚Äú$\mathsf{even}$‚Äù here?]]
#+begin_rremark Bobbert Barakallah :signoff "Thank-you for pointing this out!" :color green
I was trying, uh ...

Yeah, to explain that ${\large n √ó (n + 1) \over 2}$ is always an integer.
#+end_rremark

Hence, we only need to speak about whole numbers.
[[rremark:][Then please improve your transition sentences.]]
</pre>

<p>
<span class="underline">Resulting rendition</span>
</p>
<blockquote>
<p>
The sum of the first \(n\) natural numbers is \(\sum_{i = 0}^n i = {n √ó (n + 1)
 \over 2}\). Note that \(n √ó (n + 1)\) is even.


<strong style="color: red;">‚ü¶Jasim Jameson:

Why are you taking about ‚Äú\(\mathsf{even}\)‚Äù here?

( Aim for success! )‚üß</strong>


</p>

<strong style="color: green;">‚ü¶Bobbert Barakallah:
<p>
I was trying, uh &#x2026;
</p>

<p>
Yeah, to explain that \({\large n √ó (n + 1) \over 2}\) is always an integer.
</p>

Thank-you for pointing this out!‚üß</strong>

<p>
Hence, we only need to speak about whole numbers.


<strong style="color: red;">‚ü¶Jasim Jameson:

 Then please improve your transition sentences.

( Aim for success! )‚üß</strong>


</p>
</blockquote>

<p>
Notice that the result contains text &#x2014;the signoff message&#x2014; that the user
Jasim did not write explicitly.
</p>

<p>
‚Ä¶ Why the <i>stuttered</i> <code>rremark</code>? Because this package comes with a <code>remark</code> block that
has more bells and whistles ‚Ä¶ keep reading ;-)
</p>
</div>
</div>
</div>
<div id="outline-container-modularity_with_thread-blockcall" class="outline-3">
<h3 id="modularity_with_thread-blockcall"><span class="section-number-3">1.4</span> <a href="#modularity_with_thread-blockcall">Modularity with <code>thread-blockcall</code></a></h3>
<div class="outline-text-3" id="text-modularity_with_thread-blockcall">
<p>
Since <abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode src-block<br>consumes as main argument the language for the src block,<br>our special blocks too consume a MAIN-ARG; it may be a symbol<br>or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‚Äò,‚Äô since<br>it is a special Lisp operator. In doubt, enclose the main arg<br>in quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key‚ÇÄ value‚ÇÄ ‚Ä¶ key‚Çô value‚Çô).<br><br>After that is a DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip<br>for the produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---<br>that may refer to the names BACKEND and CONTENTS<br>which refer to the current export backend and the contents<br>of the special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e.,<br>Org-markup is acknowledged.<br><br>In, hopefully, rare circumstances, one may refer<br>to RAW-CONTENTS to look at the fully unparsed contents.<br><br>----------------------------------------------------------------------<br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>‚âà<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br>----------------------------------------------------------------------<br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ‚Äô(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX) editorial remarks; in Emacs they‚Äôre angry red.''<br>&emsp;&emsp; (format (if (equal backend ‚Äôhtml)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>‚ü¶%s:&emsp;%s%s‚üß</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don‚Äôt want to change the definition, but I‚Äôd like to have<br>&emsp; ;; the following as personalised defaults for the ‚Äúremark‚Äù block.<br>&emsp; ;; OR, I‚Äôd like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ‚ü®0‚ü© As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n √ó (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ‚ü®1‚ü© As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about ‚Äú<em>mathsf{even}</em>‚Äù here?]]<br><br>&emsp;&emsp;;; ‚ü®2‚ü© So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ‚ü®‚òÖ‚ü© Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional (DOCSTRING '''') &rest BODY)">defblock</abbr> let's us pretend block &#x2014;and link&#x2014; types are string-valued
functions, then one would expect that we can compose blocks <i>modularly</i> as
functions compose. Somewhat analogously to <abbr class="tooltip" title="Call first argument as a function, passing remaining arguments to it.<br>Return the value that function returns.<br>Thus, (funcall 'cons 'x 'y) returns (x . y).<br><br>(fn FUNCTION &rest ARGUMENTS)">funcall</abbr> and <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‚Äò-‚Äô got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr>, we
provide a macro <abbr class="tooltip" title="Thread text through a number of blocks.<br><br>BODY is likely to be ‚Äòraw-contents‚Äô, possibly with user manipulations.<br><br>Each FORMS is of the shape ‚Äú(block-name main-argument<br>:key-value-pairs)‚Äù<br><br>(thread-blockcall x)&emsp;&emsp;&emsp; = x<br>(thread-blockcall x (f a)) = (blockcall f a x)<br>(thread-blockcall x f‚ÇÅ f‚ÇÇ) ‚âà (f‚ÇÇ (f‚ÇÅ x))<br><br>The third is a ‚Äò‚âà‚Äô, and not ‚Äò=‚Äô, because the RHS contains<br>‚Äòblockcall‚Äôs as well as massages the export matter<br>between conseqeuctive blockcalls.<br><br>A full example:<br><br>&emsp;&emsp;(org-special-block-extras--defblock nesting (name) nil<br>&emsp;&emsp;&emsp;''Show text in a box, within details, which contains a box.''<br><br>&emsp;&emsp;&emsp;(org-special-block-extras--thread-blockcall raw-contents<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box name)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(details (upcase name) :title-color ''green'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;(box (format ''‚á® %s ‚á¶'' name) :background-color ''blue'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;))<br>">thread-blockcall</abbr>.
</p>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(thread-blockcall raw-contents
                  (box name)
                  (details (<span style="color: #6c3163; font-weight: bold;">upcase</span> name) <span style="color: #3a81c3;">:title-color</span> <span style="color: #2d9574;">"green"</span>)
</pre>
</div>
<p>
=
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_details NAME :title-color <span style="color: #2d9574;">"green"</span>
#+begin_box name
contents
#+end_box
#+end_details
</pre>
</div>

</div>


<br>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<p>
First, we need to handle the case of one block‚Ä¶
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">cl-defmacro</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--blockcall</span> (blk <span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> main-arg <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> keyword-args-then-contents)
  <span style="color: #da8b55;">"An anaologue to `funcall` but for blocks.</span>

<span style="color: #da8b55;">Usage: (blockcall blk-name main-arg even-many:key-values raw-contents)</span>

<span style="color: #da8b55;">One should rarely use this directly; instead use</span>
<span style="color: #da8b55;">org-special-block-extras--thread-blockcall.</span>
<span style="color: #da8b55;">"</span>
  `(<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"#+end_export\n"</span> (,(<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"org-special-block-extras--%s"</span> blk))
    backend <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">defblock internal</span>
    <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(format "\n#+begin_export html\n\n%s\n#+end_export\n" ,(car (last keyword-args-then-contents))) ;; contents</span>
    ,@(<span style="color: #6c3163; font-weight: bold;">last</span> keyword-args-then-contents) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">contents</span>
    ,main-arg
    ,@(<span style="color: #6c3163; font-weight: bold;">-drop-last</span> 1 keyword-args-then-contents)) <span style="color: #2d9574;">"\n#+begin_export"</span>))
</pre>
</div>

<p>
Using the above sequentially does not work due to the plumbing of
<code>defblock</code>, so we handle that plumbing below ‚Ä¶
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defmacro</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--thread-blockcall</span> (body <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> forms)
  <span style="color: #da8b55;">"Thread text through a number of blocks.</span>

<span style="color: #da8b55;">BODY is likely to be &#8216;</span><span style="color: #4e3163;">raw-contents</span><span style="color: #da8b55;">&#8217;, possibly with user manipulations.</span>

<span style="color: #da8b55;">Each FORMS is of the shape &#8220;(block-name main-argument</span>
<span style="color: #da8b55;">:key-value-pairs)&#8221;</span>

<span style="color: #da8b55;">(thread-blockcall x)       = x</span>
<span style="color: #da8b55;">(thread-blockcall x (f a)) = (blockcall f a x)</span>
<span style="color: #da8b55;">(thread-blockcall x f&#8321; f&#8322;) &#8776; (f&#8322; (f&#8321; x))</span>

<span style="color: #da8b55;">The third is a &#8216;&#8776;&#8217;, and not &#8216;=&#8217;, because the RHS contains</span>
<span style="color: #da8b55;">&#8216;</span><span style="color: #4e3163;">blockcall</span><span style="color: #da8b55;">&#8217;s as well as massages the export matter</span>
<span style="color: #da8b55;">between conseqeuctive blockcalls.</span>

<span style="color: #da8b55;">A full example:</span>

<span style="color: #da8b55;">    (org-special-block-extras--defblock nesting (name) nil</span>
<span style="color: #da8b55;">      \"Show text in a box, within details, which contains a box.\"</span>

<span style="color: #da8b55;">      (org-special-block-extras--thread-blockcall raw-contents</span>
<span style="color: #da8b55;">                        (box name)</span>
<span style="color: #da8b55;">                        (details (upcase name) :title-color \"green\")</span>
<span style="color: #da8b55;">                        (box (format \"&#8680; %s &#8678;\" name) :background-color \"blue\")</span>
<span style="color: #da8b55;">                        ))</span>
<span style="color: #da8b55;">"</span>
  (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">not</span> forms) body
     `(<span style="color: #3a81c3; font-weight: bold;">-let</span> [result (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--blockcall</span> ,@(<span style="color: #6c3163; font-weight: bold;">car</span> forms) ,body)]
    ,@(<span style="color: #3a81c3; font-weight: bold;">loop</span> for b in (<span style="color: #6c3163; font-weight: bold;">cdr</span> forms)
          collect `(<span style="color: #3a81c3; font-weight: bold;">setq</span> result (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--blockcall</span> ,@b
                                     (<span style="color: #6c3163; font-weight: bold;">concat</span>
                                   <span style="color: #2d9574;">"#+begin_export\n"</span>
                                   result
                                   <span style="color: #2d9574;">"\n#+end_export"</span>
                                   )))) <span style="color: #dc752f; background-color: #fbf8ef;">result)))</span>
</pre>
</div>


</details>
</div>


<div id="outline-container-Short_Example_An_opportunity_to_learn" class="outline-4">
<h4 id="Short_Example_An_opportunity_to_learn"><span class="section-number-4">1.4.1</span> <a href="#Short_Example_An_opportunity_to_learn">Short Example: <i>An opportunity to learn!</i></a></h4>
<div class="outline-text-4" id="text-Short_Example_An_opportunity_to_learn">
<p>
The following tiny block is composed from two <abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is ‚ÄúDetails‚Äù<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‚Äòbackground-color‚Äô.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (TITLE-COLOR ''green''))">details</abbr> blocks and a <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box‚Äôs COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (BACKGROUND-COLOR nil))">box</abbr> block
&#x2014;defined elsewhere in this article. It is intended to give the reader another
opportunity to make sure they have tried to solve the puzzle posed in the main
text before seeing the answer -&#x2014;this works well in HTML, not so in LaTeX.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> solution
  (title <span style="color: #2d9574;">"Solution"</span>)
  (reprimand <span style="color: #2d9574;">"Did you actually try? Maybe see the &#8216;</span><span style="color: #4e3163;">hints</span><span style="color: #2d9574;">&#8217; above!"</span>
   really <span style="color: #2d9574;">"Solution, for real"</span>)
  <span style="color: #2d9574;">"Show the answers to a problem, but with a reprimand in case no attempt was made."</span>
  (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--thread-blockcall</span> raw-contents
                    (details really <span style="color: #3a81c3;">:title-color</span> <span style="color: #2d9574;">"red"</span>)
                    (box reprimand <span style="color: #3a81c3;">:background-color</span> <span style="color: #2d9574;">"blue"</span>)
                    (details title)))
</pre>
</div>

<p>
E.g., what is 1 + 1?
</p>



<p>
<span class="spoiler"> Useless </span> Hint: <span class="spoiler"> What is a number? </span>
</p>






<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‚Äòhints‚Äô above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<p>
The answer is 2.
</p>

<p>
If you're interested in such ‚Äòfundamental‚Äô questions, consider reading
  Russel and Whitehead's <i>Principa Mathematica</i> ;-)
</p>


</details>

</div>


</details>

<p>
The above box was created from:
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_solution
The answer is 2.

If you<span style="color: #dc752f; background-color: #fbf8ef;">'</span>re interested in such &#8216;fundamental&#8217; questions, consider reading
  Russel <span style="color: #ba2f59; font-weight: bold;">and</span> <span style="color: #715ab1;">Whitehead</span><span style="color: #dc752f; background-color: #fbf8ef;">'</span>s /Principa Mathematica/ ;-)
#+end_solution
</pre>
</div>
<p>
We will make use of this block below when we get to guided problems ;-)
</p>
</div>
</div>

<div id="outline-container-Longer_Example_Demonstrating_Org-markup_with_org-demo" class="outline-4">
<h4 id="Longer_Example_Demonstrating_Org-markup_with_org-demo"><span class="section-number-4">1.4.2</span> <a href="#Longer_Example_Demonstrating_Org-markup_with_org-demo">Longer Example: Demonstrating Org-markup with <code>org-demo</code></a></h4>
<div class="outline-text-4" id="text-Longer_Example_Demonstrating_Org-markup_with_org-demo">
<p>
Sometimes, we want to show verbatim source and its resulting rendition &#x2014;which
is a major part of this article! So, let's make a block to mitigate such an
error-prone tedium.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> org-demo nil (source <span style="color: #2d9574;">"Source"</span> result <span style="color: #2d9574;">"Result"</span>
                        source-color <span style="color: #2d9574;">"cyan"</span> result-color <span style="color: #2d9574;">"cyan"</span>
                        style <span style="color: #2d9574;">"parallel"</span>
                        )
  <span style="color: #2d9574;">"Output the CONTENTS of the block as both parsed Org and unparsed.</span>

<span style="color: #2d9574;">Label the source text by SOURCE and the result text by RESULT</span>

<span style="color: #2d9574;">finally, the source-result fragments can be shown in a STYLE</span>
<span style="color: #2d9574;">that is either &#8220;parallel&#8221; (default) or &#8220;sequential&#8221;.</span>
<span style="color: #2d9574;">"</span>
  (<span style="color: #3a81c3; font-weight: bold;">-let</span> [text (<span style="color: #6c3163; font-weight: bold;">concat</span> (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span> (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--blockcall</span> box source <span style="color: #3a81c3;">:background-color</span> source-color (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span> (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"\n"</span> (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> backend 'html) <span style="color: #2d9574;">"&lt;br&gt;"</span> <span style="color: #2d9574;">"\\newline"</span>) raw-contents))))
                      <span style="color: #2d9574;">"\n\n\n\n "</span>
                       (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span> (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--blockcall</span> box result <span style="color: #3a81c3;">:background-color</span> result-color raw-contents))
                      )]

   (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> style <span style="color: #2d9574;">"parallel"</span>)
       (<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--blockcall</span> parallel <span style="color: #2d9574;">"2"</span> <span style="color: #3a81c3;">:bar</span> nil text)
       (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"#+end_export\n"</span> text <span style="color: #2d9574;">"\n#+begin_export"</span>))))
</pre>
</div>





</details>

<br>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>

<div style="column-rule-style: solid;column-count: 2;">
<p>
<span class="underline">This</span>
</p>
<pre class="example" id="org260a3ef">
#+begin_org-demo
/italics/ and _underline_

$e^{i \times \pi} + 1 = 0$
#+end_org-demo
</pre>
<p>
<span class="underline">Yields</span>
</p>


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

/italics/ and _underline_<br><br> $e^{i \times \pi} + 1 = 0$<br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<i>italics</i> and <span class="underline">underline</span>
</p>

<p>
\(e^{i \times \pi} + 1 = 0\)
</p>

</div>

</div>

</div>


</div>


<br>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>(Sequential) Example</h3>

<div style="column-rule-style: solid;column-count: 2;">
<p>
<span class="underline">This</span>
</p>
<pre class="example" id="orgbe35a42">
#+begin_org-demo :style seq
/italics/ and _underline_

$e^{i \times \pi} + 1 = 0$
#+end_org-demo
</pre>
<br><hr><br>

<p>
<span class="underline">Yields</span>
</p>



<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

/italics/ and _underline_<br><br> $e^{i \times \pi} + 1 = 0$<br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<i>italics</i> and <span class="underline">underline</span>
</p>

<p>
\(e^{i \times \pi} + 1 = 0\)
</p>

</div>

</div>


</div>


<p>
However, since our implementation scheme relies on a preprocessing step before
export, we cannot use <code>org-demo</code> to show the results of special blocks: They
disappear in the preprocessing step!
</p>

<div style="column-rule-style: solid;column-count: 2;">
<p>
E.g., this
</p>
<pre class="example" id="orgca35f3a">
#+begin_org-demo
#+begin_box
There is no special block ‚Äòbox‚Äô to touch!
#+end_box
#+end_org-demo
</pre>

<hr><br>
<p>
yields
</p>


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

<br>#+begin_export html <br><div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3><br>#+end_export<br> There is no special block ‚Äòbox‚Äô to touch!<br><br>#+begin_export html<br></div><br>#+end_export<br><br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
There is no special block ‚Äòbox‚Äô to touch!
</p>

</div>


</div>

</div>

</div>


<p>
However, it does work with links!
</p>


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

[[box:][Box-as-link! Boxception!]]<br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>

Box-as-link! Boxception!

</div>


</p>

</div>

</div>
</div>
</div>
</div>
<div id="outline-container-practice_problems" class="outline-3">
<h3 id="practice_problems"><span class="section-number-3">1.5</span> <a href="#practice_problems">Practice Problems: <i>Now you try!</i></a></h3>
<div class="outline-text-3" id="text-practice_problems">
<p>
<b>

<span style="color:green;">

A 5-page PDF covering ELisp fundamentals

</span>

</b> can be found <b><a href="https://alhassy.github.io/ElispCheatSheet/CheatSheet.pdf">here</a></b>.
</p>

<p>
The first problem is to <i>get you going with Lisp</i>, the next two are actually
useful blocks.  The <abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‚Äòto‚Äô separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key)">rename</abbr> is useful for when you want to change some names or
translate some words; <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr> is useful when we want to test a student's
understanding, or to subtly hide the answer to a puzzle so the reader has the
opportunity to attempt solving it.
</p>
</div>

<div id="outline-container-Sttutttterrr" class="outline-4">
<h4 id="Sttutttterrr"><span class="section-number-4">1.5.1</span> <a href="#Sttutttterrr">Sttutttterrr</a></h4>
<div class="outline-text-4" id="text-Sttutttterrr">
<p>
Define a block <abbr class="tooltip" title="Output the CONTENTS of the block REPS many times<br><br>(fn BACKEND RAW-CONTENTS &optional REPS &rest ## &key)">stutter</abbr> so that the following examples behave as shown.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>You need at-most 5 lines of Lisp.</li>
<li>These functions <i>may</i> be useful: <abbr class="tooltip" title="Make a string of S repeated NUM times.">s-repeat</abbr>, <abbr class="tooltip" title="Return t if OBJECT is a number (floating point or integer).<br><br>(fn OBJECT)">numberp</abbr>,
<abbr class="tooltip" title="Parse STRING as a decimal number and return the number.<br>Ignore leading spaces and tabs, and all trailing chars.&emsp;Return 0 if<br>STRING cannot be parsed as an integer or floating point number.<br><br>If BASE, interpret STRING as a number in that base.&emsp;If BASE isn‚Äôt<br>present, base 10 is used.&emsp;BASE must be between 2 and 16 (inclusive).<br>If the base used is not 10, STRING is always parsed as an integer.<br><br>(fn STRING &optional BASE)">string-to-number</abbr></li>
</ol>


</details>


<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>


<div style="column-rule-style: solid;column-count: 2;">
<p>
The following outputs, well, nothing, since we asked for zero repetitions.
</p>
<div class="org-src-container">
<pre class="src src-org"><span style="color: #9380b2; background-color: #ddd8eb;">#+begin_stutter 0</span>

words

more words
<span style="color: #9380b2; background-color: #ddd8eb;">#+end_stutter</span>
</pre>
</div>







<p>
In contrast ‚Ä¶
</p>


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

[[stutter:5][woah, I'm repeated 5 times!]]<br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>




woah, I'm repeated 5 times!



woah, I'm repeated 5 times!



woah, I'm repeated 5 times!



woah, I'm repeated 5 times!



woah, I'm repeated 5 times!




</p>

</div>

</div>

</div>


</div>


<br>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‚Äòhints‚Äô above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> stutter (reps 2) nil
  <span style="color: #2d9574;">"Output the CONTENTS of the block REPS many times"</span>
  (<span style="color: #3a81c3; font-weight: bold;">-let</span> [num (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">numberp</span> reps) reps (<span style="color: #6c3163; font-weight: bold;">string-to-number</span> reps))]
    (<span style="color: #6c3163; font-weight: bold;">s-repeat</span> num contents)))
</pre>
</div>


</details>

</div>


</details>
</div>
</div>

<div id="outline-container-Textual_Substitution" class="outline-4">
<h4 id="Textual_Substitution"><span class="section-number-4">1.5.2</span> <a href="#Textual_Substitution">Textual Substitution &#x2014;A translation tool</a></h4>
<div class="outline-text-4" id="text-Textual_Substitution">
<p>
Define a block
<abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‚Äòto‚Äô separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key)">rename</abbr> so that the following examples behave as shown.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>It can be done in less than 10 lines of Lisp.</li>
<li>First, try to <abbr class="tooltip" title="REPLACEMENTS is a list of cons-cells. Each ‚Äòcar‚Äò is replaced with ‚Äòcdr‚Äò in S.">s-replace-all</abbr> the substitution
<code>'(("Allah" . "God") ("Yacoub". "Jacob") ("Yusuf" . "Joseph"))</code>
only.</li>
<li>Then take out such hard-coded substitutions ‚Ä¶ these functions <i>may</i> be helpful:
<abbr class="tooltip" title="Anaphoric form of ‚Äò-map‚Äô.<br><br>(fn FORM LIST)">--map</abbr> / <abbr class="tooltip" title="Return a new list consisting of the result of applying FN to the items in LIST.<br><br>(fn FN LIST)">-map</abbr>, <abbr class="tooltip" title="Split S into substrings bounded by matches for regexp SEPARATOR.<br>If OMIT-NULLS is non-nil, zero-length substrings are omitted.<br><br>This is a simple wrapper around the built-in ‚Äòsplit-string‚Äô.">s-split</abbr>, <abbr class="tooltip" title="Remove whitespace at the beginning and end of S.">s-trim</abbr></li>
</ol>


</details>


<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>


<div style="column-rule-style: solid;column-count: 2;">

<pre class="example" id="org94e4f82">
#+begin_rename "Allah to God, Yacoub to Jacob, Yusuf to Joseph"
Quran 12-4: *_Yusuf_* said to his father ( _*Yacoub*_ ), /‚ÄúO my father, indeed I have seen (in a dream) eleven
stars and the sun and the moon; I saw them prostrating to me.‚Äù/
#+end_rename
</pre>
<p>
Yields‚Ä¶
</p>


<p>
Quran 12-4: <b><span class="underline">Joseph</span></b> said to his father ( <span class="underline"><b>Jacob</b></span> ), <i>‚ÄúO my father, indeed I have seen (in a dream) eleven
stars and the sun and the moon; I saw them prostrating to me.‚Äù</i>
</p>




<hr />


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

<br>[[rename:Pharaoh to Firaun, Joseph to Yusuf][Genesis 41-17: Pharaoh said unto Joseph, /In my dream, behold, I stood upon the<br>bank of the river/ ‚Ä¶]]<br><br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>

<p>




Genesis 41-17: Firaun said unto Yusuf, <i>In my dream, behold, I stood upon the
bank of the river</i> ‚Ä¶




</p>


</div>

</div>

</div>


</div>


<br>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‚Äòhints‚Äô above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> rename (<span style="color: #6c3163; font-weight: bold;">list</span> <span style="color: #2d9574;">""</span>) nil
  <span style="color: #2d9574;">"Perform the given LIST of substitutions on the text.</span>
<span style="color: #2d9574;">The LIST is a comma separated list of &#8216;</span><span style="color: #4e3163;">to</span><span style="color: #2d9574;">&#8217; separated symbols.</span>
<span style="color: #2d9574;">In a link, no quotes are needed."</span>
  (<span style="color: #6c3163; font-weight: bold;">s-replace-all</span>
   (<span style="color: #3a81c3; font-weight: bold;">--map</span> (<span style="color: #6c3163; font-weight: bold;">cons</span> (<span style="color: #6c3163; font-weight: bold;">car</span> it) (<span style="color: #6c3163; font-weight: bold;">cadr</span> it))
          (<span style="color: #3a81c3; font-weight: bold;">--map</span> (<span style="color: #6c3163; font-weight: bold;">s-split</span> <span style="color: #2d9574;">" to "</span> (<span style="color: #6c3163; font-weight: bold;">s-trim</span> it))
                 (<span style="color: #6c3163; font-weight: bold;">s-split</span> <span style="color: #2d9574;">","</span> <span style="color: #6c3163; font-weight: bold;">list</span>)))
   contents))
</pre>
</div>



</details>

</div>


</details>
</div>
</div>

<div id="outline-container-spoilers" class="outline-4">
<h4 id="spoilers"><span class="section-number-4">1.5.3</span> <a href="#spoilers">Spoilers! &#x2014;‚Äúfill in the blanks‚Äù</a></h4>
<div class="outline-text-4" id="text-spoilers">
<p>
Define a block <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr> so that the following examples behave as shown.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Hints
                      </font>
                    </strong>
                  </summary>
<ol class="org-ol">
<li>It can be done in less than 10 lines of Lisp.</li>
<li><p>
You will need the following style setup ‚Ä¶
</p>
<pre class="example" id="org3a50782">
#+html_head: &lt;style&gt;
#+html_head: .spoiler {color: grey; background-color:grey;}
#+html_head: .spoiler:hover {color: black; background-color:white;}
#+html_head: &lt;style&gt;
# Example use: &lt;span class="spoiler"&gt; test &lt;/span&gt;
</pre></li>
<li><i>Escape</i> HTML snippets by enclosing them in <code>@@html: ‚Ä¶ @@</code> &#x2014;as discussed above
in the introduction to special blocks.</li>
<li>The functions  <abbr class="tooltip" title="Replace all matches for REGEXP with REP in STRING.<br><br>Return a new string containing the replacements.<br><br>Optional arguments FIXEDCASE, LITERAL and SUBEXP are like the<br>arguments with the same names of function ‚Äòreplace-match‚Äô.&emsp;If START<br>is non-nil, start replacements at that index in STRING, and omit<br>the first START characters of STRING from the return value.<br><br>REP is either a string used as the NEWTEXT arg of ‚Äòreplace-match‚Äô or a<br>function.&emsp;If it is a function, it is called with the actual text of each<br>match, and its value is used as the replacement text.&emsp;When REP is called,<br>the match data are the result of matching REGEXP against a substring<br>of STRING, the same substring that is the actual text of the match which<br>is passed to REP as its argument.<br><br>To replace only the first match (if any), make REGEXP match up to \'<br>and replace a sub-expression, e.g.<br>&emsp;(replace-regexp-in-string ''\\(foo\\).*\\''' ''bar'' '' foo foo'' nil nil 1)<br>&emsp;&emsp;=> '' bar foo''<br><br>(fn REGEXP REP STRING &optional FIXEDCASE LITERAL SUBEXP START)">s-replace-regexp</abbr> and <abbr class="tooltip" title="Return a regexp string which matches exactly STRING and nothing else.<br><br>(fn STRING)">regexp-quote</abbr> <i>may</i> be useful.</li>
</ol>


</details>


<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Examples</h3>

<div style="column-rule-style: solid;column-count: 2;">
<pre class="example" id="org0dd3641">
#+begin_spoiler
((Yusuf)) said to his father ((Yacoub)), /‚ÄúO my father, indeed I have seen
((eleven stars)) and ((the sun and the moon)); I saw them prostrating to me.‚Äù/
#+end_spoiler
</pre>



<p>
<span class="spoiler"> Yusuf </span> said to his father <span class="spoiler"> Yacoub </span>, <i>‚ÄúO my father, indeed I have seen
<span class="spoiler"> eleven stars </span> and <span class="spoiler"> the sun and the moon </span>; I saw them prostrating to me.‚Äù</i>
</p>





<hr><br>

<p>
<code>#+begin_spoiler :left "[" :right "]"</code>
</p>

<p>
<code>[Yusuf] said to his father [Yacoub], /‚ÄúO my father, indeed I have seen</code>
</p>

<p>
<code>[eleven stars] and [the sun and the moon]; I saw them prostrating to me.‚Äù/</code>
</p>

<p>
<code>#+end_spoiler</code>
</p>



<p>
<span class="spoiler"> Yusuf </span> said to his father <span class="spoiler"> Yacoub </span>, <i>‚ÄúO my father, indeed I have seen
<span class="spoiler"> eleven stars </span> and <span class="spoiler"> the sun and the moon </span>; I saw them prostrating to me.‚Äù</i>
</p>





</div>


</div>


<br>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Solution
                      </font>
                    </strong>
                  </summary>
<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Did you actually try? Maybe see the ‚Äòhints‚Äô above!</h3>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="red">
                         Solution, for real
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> spoiler () (left <span style="color: #2d9574;">"(("</span> right <span style="color: #2d9574;">"))"</span>)
  <span style="color: #2d9574;">"Hide text enclosed in double parens ((like this)) as if it were spoilers.</span>
<span style="color: #2d9574;">   LEFT and RIGHT may be other kinds of delimiters."</span>
  (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span>
   (<span style="color: #6c3163; font-weight: bold;">concat</span> (<span style="color: #6c3163; font-weight: bold;">regexp-quote</span> left) <span style="color: #2d9574;">"</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.*?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">"</span> (<span style="color: #6c3163; font-weight: bold;">regexp-quote</span> right))
   <span style="color: #2d9574;">"@@html:&lt;span class=\"spoiler\"&gt; \\1 &lt;/span&gt;@@"</span>
   contents))
</pre>
</div>

<p>
There's actually a problem with this ‚Äòsolution‚Äô; can you find it?
</p>


<p>
Hint: <span class="spoiler"> Try the link form and see how it breaks! </span>
</p>




<p>
<b>

<span style="color:green;">

Advanced

</span>

:</b> Rather than having auxiliary <code>#+html_head:</code> styling settings,
move the styling information to the <code>defblock</code> declaration <i>and</i>
add a new argument, say, <code>:color</code> that colors the spoiler another colour,
and defaults to grey ;-)
</p>


</details>

</div>


</details>
</div>
</div>
</div>


<div id="outline-container-Whats_the_rest_of_this_article_about?" class="outline-3">
<h3 id="Whats_the_rest_of_this_article_about?"><span class="section-number-3">1.6</span> <a href="#Whats_the_rest_of_this_article_about?">What's the rest of this article about?</a></h3>
<div class="outline-text-3" id="text-Whats_the_rest_of_this_article_about?">
<p>
The rest of the article showcases the special blocks declared with <code>defblock</code> to
allow the above presentation &#x2014;with folded regions, coloured boxes, tooltips,
parallel columns of text, etc.
</p>

<p>
Enjoy ;-)
</p>
</div>
</div>

<div id="outline-container-Core-Utility" class="outline-3">
<h3 id="Core-Utility"><span class="section-number-3">1.7</span> <a href="#Core-Utility">The Older <code>org-special-block-extras--ùí≥</code> Utility</a></h3>
<div class="outline-text-3" id="text-Core-Utility">
<p>
For posterity, below is the original route taken to solve the same problem.
In particular, the route outlined below <i>may</i> be faster.
</p>

<p>
Why is <code>defblock</code> better?
</p>
<ul class="org-ul">
<li>The approach below requires an awkward way to handle arguments, key-values.</li>
<li>It requires the user to learn a new interface.</li>
<li>Even if it's slower, <code>defblock</code> uses a very familiar interface and requires less
Lisp mastery on the user's part.</li>
</ul>

<hr />

<p>
The simplest route is to ‚Äòadvise‚Äô &#x2014;i.e., function patch or overload&#x2014; the Org
export utility for special blocks to consider calling a method
<code>org-special-block-extras--ùí≥</code> whenever it encounters a special block named <code>ùí≥</code>.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">advice-add</span> #'<span style="color: #6c3163; font-weight: bold;">org-html-special-block</span>
   <span style="color: #3a81c3;">:before-until</span> (<span style="color: #6c3163; font-weight: bold;">apply-partially</span> #'<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--advice</span> 'html))

(<span style="color: #6c3163; font-weight: bold;">advice-add</span> #'<span style="color: #6c3163; font-weight: bold;">org-latex-special-block</span>
   <span style="color: #3a81c3;">:before-until</span> (<span style="color: #6c3163; font-weight: bold;">apply-partially</span> #'<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--advice</span> 'latex))
</pre>
</div>

<p>
Here is the actual advice:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--advice</span> (backend blk contents _)
  <span style="color: #da8b55;">"Invoke the appropriate custom block handler, if any.</span>

<span style="color: #da8b55;">A given custom block BLK has a TYPE extracted from it, then we</span>
<span style="color: #da8b55;">send the block CONTENTS along with the current export BACKEND to</span>
<span style="color: #da8b55;">the formatting function ORG-SPECIAL-BLOCK-EXTRAS--TYPE if it is</span>
<span style="color: #da8b55;">defined, otherwise, we leave the CONTENTS of the block as is.</span>

<span style="color: #da8b55;">We also support the seemingly useless blocks that have no</span>
<span style="color: #da8b55;">contents at all, not even an empty new line."</span>
  (<span style="color: #3a81c3; font-weight: bold;">let*</span> ((type    (<span style="color: #6c3163; font-weight: bold;">nth</span> 1 (<span style="color: #6c3163; font-weight: bold;">nth</span> 1 blk)))
         (handler (<span style="color: #6c3163; font-weight: bold;">intern</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"org-special-block-extras--%s"</span> type))))
    (<span style="color: #3a81c3; font-weight: bold;">ignore-errors</span> (<span style="color: #6c3163; font-weight: bold;">apply</span> handler backend (<span style="color: #3a81c3; font-weight: bold;">or</span> contents <span style="color: #2d9574;">""</span>) nil))))
</pre>
</div>

<p>
<b>To support a new block named ùí≥:</b>
</p>
<ol class="org-ol">
<li>Define a function <code>org-special-block-extras--ùí≥</code>.</li>
<li>It must take two arguments:
<ul class="org-ul">
<li><code>backend</code> ‚áí A symbol such as <code>'html</code> or <code>'latex</code>,</li>
<li><code>content</code> ‚áí The string contents of the special block.</li>
</ul></li>
<li>The function must return a string, possibly depending on the backend being
exported to. The resulting string is inserted literally in the exported file.</li>
<li>Test out your function as in <code>(org-special-block-extras--ùí≥ 'html "some input")</code>
&#x2014;this is a quick way to find errors.</li>
<li>Enjoy ^_^</li>
</ol>

<div class="org-center">
<p>
If no such function is defined, we export <code>ùí≥</code> blocks using the default
mechanism, as discussed earlier, as a LaTeX environment or an HTML <code>div</code>.
</p>
</div>

<p>
An example is provided at the end of this section.
</p>

<p>
Of-course, when the user disables our mode, then we remove such advice.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">advice-remove</span> #'<span style="color: #6c3163; font-weight: bold;">org-html-special-block</span>
               (<span style="color: #6c3163; font-weight: bold;">apply-partially</span> #'<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--advice</span> 'html))

(<span style="color: #6c3163; font-weight: bold;">advice-remove</span> #'<span style="color: #6c3163; font-weight: bold;">org-latex-special-block</span>
               (<span style="color: #6c3163; font-weight: bold;">apply-partially</span> #'<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--advice</span> 'latex))
</pre>
</div>
</div>

<div id="outline-container-argument-Extraction" class="outline-4">
<h4 id="argument-Extraction"><span class="section-number-4">1.7.1</span> <a href="#argument-Extraction">¬† <code>:argument:</code> Extraction</a></h4>
<div class="outline-text-4" id="text-argument-Extraction">
<p>
As far as I can tell, there is no way to provide arguments to special blocks.
As such, the following utility looks for lines of the form <code>:argument: value</code>
within the contents of a block and returns an updated contents string that no
longer has such lines followed by an association list of such argument-value
pairs.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--extract-arguments</span> (contents <span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> args)
<span style="color: #da8b55;">"Get list of CONTENTS string with ARGS lines stripped out and values of ARGS.</span>

<span style="color: #da8b55;">Example usage:</span>

<span style="color: #da8b55;">    (-let [(contents&#8242; . (&amp;alist 'k&#8320; &#8230; 'k&#8345;))</span>
<span style="color: #da8b55;">           (&#8230;extract-arguments contents 'k&#8320; &#8230; 'k&#8345;)]</span>
<span style="color: #da8b55;">          body)</span>

<span style="color: #da8b55;">Within &#8216;</span><span style="color: #4e3163;">body</span><span style="color: #da8b55;">&#8217;, each &#8216;</span><span style="color: #4e3163;">k&#7522;</span><span style="color: #da8b55;">&#8217; refers to the &#8216;</span><span style="color: #4e3163;">value</span><span style="color: #da8b55;">&#8217; of argument</span>
<span style="color: #da8b55;">&#8216;</span><span style="color: #4e3163;">:k&#7522;:</span><span style="color: #da8b55;">&#8217; in the CONTENTS text and &#8216;contents&#8242;&#8217; is CONTENTS</span>
<span style="color: #da8b55;">with all &#8216;</span><span style="color: #4e3163;">:k&#7522;:</span><span style="color: #da8b55;">&#8217; lines stripped out.</span>

<span style="color: #da8b55;">+ If &#8216;</span><span style="color: #4e3163;">:k:</span><span style="color: #da8b55;">&#8217; is not an argument in CONTENTS, then it is assigned value NIL.</span>
<span style="color: #da8b55;">+ If &#8216;</span><span style="color: #4e3163;">:k:</span><span style="color: #da8b55;">&#8217; is an argument in CONTENTS but is not given a value in CONTENTS,</span>
<span style="color: #da8b55;">  then it has value the empty string."</span>
  (<span style="color: #3a81c3; font-weight: bold;">let</span> ((ctnts contents)
        (<span style="color: #6c3163; font-weight: bold;">values</span> (<span style="color: #3a81c3; font-weight: bold;">cl-loop</span> for a in args
                         for regex <span style="color: #6c3163; font-weight: bold;">=</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">":%s:</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.*</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">"</span> a)
                         for v <span style="color: #6c3163; font-weight: bold;">=</span> (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">s-match</span> regex contents))
                         collect (<span style="color: #6c3163; font-weight: bold;">cons</span> a v))))
    (<span style="color: #3a81c3; font-weight: bold;">cl-loop</span> for a in args
             for regex <span style="color: #6c3163; font-weight: bold;">=</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">":%s:</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.*</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">"</span> a)
             <span style="color: #6c3163; font-weight: bold;">do</span> (<span style="color: #3a81c3; font-weight: bold;">setq</span> ctnts (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> regex <span style="color: #2d9574;">""</span> ctnts)))
    (<span style="color: #6c3163; font-weight: bold;">cons</span> ctnts <span style="color: #6c3163; font-weight: bold;">values</span>)))
</pre>
</div>

<p>
For example, we use this feature to indicate when a column break should happen
in a <code>parallel</code> block and which person is making editorial remarks in an
<code>remark</code> block.
</p>

<p>
Why the <code>:ùí≥:</code> notation? At the start of a line, a string of this form is coloured
&#x2014;I don't recall why that is&#x2014; and that's a good enough reason to make use of
such an existing support.
</p>


<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Aside:</strong></span>
<p>
In org-mode, ‚Äòdrawers‚Äô are pieces of text that begin with
<code>:my_drawer_name:</code> on a line by itself and end with <code>:end:</code> on a line by itself, and
these delimiters allow us to fold away such regions and possibly exclude them
from export. That is, drawers act as a light-weight form of blocks. Anyhow, Org
colours drawer delimiters,
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>
</div>
</div>


<div id="outline-container-COMMENT-An-Example-Special-Block-foo" class="outline-4">
<h4 id="COMMENT-An-Example-Special-Block-foo"><span class="section-number-4">1.7.2</span> <a href="#COMMENT-An-Example-Special-Block-foo">An Example Special Block ---<code>foo</code></a></h4>
<div class="outline-text-4" id="text-COMMENT-An-Example-Special-Block-foo">
<p>
Herein we show an example function <code>org-special-block-extras--ùí≥</code> that makes use of
arguments.  In a so-called <code>foo</code> block, all occurrences of the word <code>foo</code> are
replaced by <code>bar</code> unless the argument <code>:replacement:</code> is given a value.
</p>


<div id="org6c368bf" class="figure">
<p><img src="images/foo_block.png" alt="foo_block.png" />
</p>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orge7a7748">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--foo</span> (backend contents)
  <span style="color: #da8b55;">"The FOO block type replaces all occurances of &#8216;</span><span style="color: #4e3163;">foo</span><span style="color: #da8b55;">&#8217; with &#8216;</span><span style="color: #4e3163;">bar</span><span style="color: #da8b55;">&#8217;,</span>
<span style="color: #da8b55;">unless a &#8216;</span><span style="color: #4e3163;">:replacement:</span><span style="color: #da8b55;">&#8217; is provided."</span>
  (<span style="color: #3a81c3; font-weight: bold;">-let</span> [(contents&#8242; . (<span style="color: #ba2f59; font-weight: bold;">&amp;alist</span> 'replacement))
           (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--extract-arguments</span> contents 'replacement)]
    (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"foo"</span> (<span style="color: #3a81c3; font-weight: bold;">or</span> replacement <span style="color: #2d9574;">"bar"</span>) contents&#8242;)))
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-editor-comments" class="outline-2">
<h2 id="editor-comments"><span class="section-number-2">2</span> <a href="#editor-comments">Editor Comments</a></h2>
<div class="outline-text-2" id="text-editor-comments">
<p>
‚ÄúEditor Comments‚Äù are intended to be top-level first-class comments in an
article that are inline with the surrounding text and are delimited in such a
way that they are visible but drawing attention.  I first learned about this
idea from Wolfram Kahl &#x2014;who introduced me to Emacs many years ago.  We
implement editor comments as special blocks named <abbr class="tooltip" title="Format CONTENTS as an first-class editor comment according to BACKEND.<br><br>The CONTENTS string has an optional switch: If it contains a line<br>with having only ‚Äò#+replacewith:‚Äô, then the text preceding this<br>clause should be replaced by the text after it; i.e., this is<br>what the EDITOR (the person editing) intends and so we fromat the<br>replacement instruction (to the authour) as such.<br><br>In Emacs, as links, editor remarks are shown with a bold red; but<br>the exported COLOR of a remark is black by default and it is not<br>STRONG ---i.e., bold---. There is an optional SIGNOFF message<br>that is appended to the remark.<br><br>(fn BACKEND RAW-CONTENTS &optional EDITOR &rest ## &key (COLOR ''black'') (SIGNOFF '''') (STRONG nil))">remark</abbr>.
</p>


<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>


<div style="column-rule-style: none;column-count: 2;">
<p>
<span class="underline">This</span>
</p>

<div class="org-src-container">
<pre class="src src-C"> <span style="color: #ba2f59; font-weight: bold;">In</span> <span style="color: #715ab1;">LaTeX</span>, <span style="color: #715ab1;">an</span> =remark= appears <span style="color: #3a81c3; font-weight: bold;">inline</span> with the text surrounding it.
 #+begin_remark Bobert
 org-mode is dope, <span style="color: #715ab1;">yo</span><span style="color: #4e3163;">!</span>
 #+replacewith:
 Org-mode is essentially a path toward enlightenment.
 #+end_remark
 Unfortunately, <span style="color: #715ab1;">in</span> the HTML rendition, <span style="color: #715ab1;">the</span> =remark= is its own paragraph and thus
 separated by new lines from its surrounding text.
</pre>
</div>

<hr><br>

<p>
<span class="underline">Yields</span>
</p>

<p>
In LaTeX, an <code>remark</code> appears inline with the text surrounding it.
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:&nbsp;<u>Replace:</u></strong></span>
<p>
org-mode is dope, yo!
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

<p>
Org-mode is essentially a path toward enlightenment.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>

<p>
Unfortunately, in the HTML rendition, the <code>remark</code> is its own paragraph and thus
separated by new lines from its surrounding text.
</p>

</div>


</div>


<hr />

<p>
All editor comments, remarks, are disabled by declaring, in your Org file:
</p>
<pre class="example" id="orgcde4811">
#+bind: org-special-block-extras-hide-editor-comments t
</pre>
<p>
The <code>#+bind:</code> keyword makes Emacs variables buffer-local during export
&#x2014;it is evaluated <i>after</i> any <code>src</code> blocks. To use it, one must declare in
their Emacs init file the following line, which our mode
ensures is true.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-export-allow-bind-keywords</span> <span style="color: #715ab1;">t</span>)
</pre>
</div>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">( Remember to <code>C-c C-c</code> the <code>#+bind</code> to activate it, the first time it is written. )</td>
</tr>
</tbody>
</table>

<hr />


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: No optional arguments
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>
<p>
<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Only providing a main argument ---i.e., the remark author, the editor
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:</strong></span>
<p>
<i>Please</i> <b>change</b> <span class="underline">this</span> section to be more, ya know, professional.
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly with no contents:
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Bobert:</strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Empty contents, no authour, nothing
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly with an empty new line
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:</strong></span>


<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: With a #+replacewith: clause
                      </font>
                    </strong>
                  </summary>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<p>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

<p>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Example: Possibly ‚Äúmalformed‚Äù replacement clauses
                      </font>
                    </strong>
                  </summary>

<p>
Forgot the thing to be replaced‚Ä¶
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

<p>
A linear one-dimensional notation; e.g.,
\((\Sigma i : 0..n \;\bullet\; i^2)\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>


<hr />

<p>
Forgot the new replacement thing‚Ä¶
</p>

<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>
<p>
The two-dimensional notation; e.g., \(\sum_{i = 0}^n i^2\)
</p>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>


<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>


<hr />

<p>
Completely lost one's train of thought‚Ä¶
</p>


<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Editor Remark:&nbsp;<u>Replace:</u></strong></span>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>


<span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>



</details>


<hr />


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementing ‚Äòremark‚Äô with more bells and whistles
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras-hide-editor-comments</span> nil
  <span style="color: #da8b55;">"Should editor comments be shown in the output or not."</span>)

(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> remark
      (editor <span style="color: #2d9574;">"Editor Remark"</span> <span style="color: #3a81c3;">:face</span> '(<span style="color: #3a81c3;">:foreground</span> <span style="color: #2d9574;">"red"</span> <span style="color: #3a81c3;">:weight</span> <span style="color: #6c3163; font-weight: bold;">bold</span>)) (color <span style="color: #2d9574;">"black"</span> signoff <span style="color: #2d9574;">""</span> strong nil)
<span style="color: #2d9574;">"Format CONTENTS as an first-class editor comment according to BACKEND.</span>

<span style="color: #2d9574;">The CONTENTS string has an optional switch: If it contains a line</span>
<span style="color: #2d9574;">with having only &#8216;#+replacewith:&#8217;, then the text preceding this</span>
<span style="color: #2d9574;">clause should be replaced by the text after it; i.e., this is</span>
<span style="color: #2d9574;">what the EDITOR (the person editing) intends and so we fromat the</span>
<span style="color: #2d9574;">replacement instruction (to the authour) as such.</span>

<span style="color: #2d9574;">In Emacs, as links, editor remarks are shown with a bold red; but</span>
<span style="color: #2d9574;">the exported COLOR of a remark is black by default and it is not</span>
<span style="color: #2d9574;">STRONG ---i.e., bold---. There is an optional SIGNOFF message</span>
<span style="color: #2d9574;">that is appended to the remark.</span>
<span style="color: #2d9574;">"</span>
  (<span style="color: #3a81c3; font-weight: bold;">-let*</span> (<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Are we in the html backend?</span>
          (tex? (<span style="color: #6c3163; font-weight: bold;">equal</span> backend 'latex))

          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">fancy display style</span>
          (boxed (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (x)
                   (<span style="color: #3a81c3; font-weight: bold;">if</span> tex?
                       (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"\\fbox{\\bf "</span> x <span style="color: #2d9574;">"}"</span>)
                     (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"&lt;span style=\"border-width:1px"</span>
                             <span style="color: #2d9574;">";border-style:solid;padding:5px\"&gt;"</span>
                             <span style="color: #2d9574;">"&lt;strong&gt;"</span> x <span style="color: #2d9574;">"&lt;/strong&gt;&lt;/span&gt;"</span>))))

          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Is this a replacement clause?</span>
          ((this that) (<span style="color: #6c3163; font-weight: bold;">s-split</span> <span style="color: #2d9574;">"\\#\\+replacewith:"</span> contents))
          (replacement-clause? that) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">There is a &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">that</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217;</span>
          (replace-keyword (<span style="color: #3a81c3; font-weight: bold;">if</span> tex?
                             <span style="color: #2d9574;">"\\underline{Replace:}"</span> <span style="color: #2d9574;">"&amp;nbsp;&lt;u&gt;Replace:&lt;/u&gt;"</span>))
          (with-keyword    (<span style="color: #3a81c3; font-weight: bold;">if</span> tex? <span style="color: #2d9574;">"\\underline{With:}"</span> <span style="color: #2d9574;">"&lt;u&gt;With:&lt;/u&gt;"</span>
                             ))
          (editor (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"[%s:%s"</span> editor
                          (<span style="color: #3a81c3; font-weight: bold;">if</span> replacement-clause?
                              replace-keyword
                            <span style="color: #2d9574;">""</span>)))
          (contents&#8242; (<span style="color: #3a81c3; font-weight: bold;">if</span> replacement-clause?
                         (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s %s %s"</span> this
                                 (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--org-export</span> (<span style="color: #6c3163; font-weight: bold;">funcall</span> boxed with-keyword))
                                 that)
                       contents))

          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8220;[Editor Comment:&#8221;</span>
          (edcomm-begin (<span style="color: #6c3163; font-weight: bold;">funcall</span> boxed editor))
          <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8220;]&#8221;</span>
          (edcomm-end (<span style="color: #6c3163; font-weight: bold;">funcall</span> boxed <span style="color: #2d9574;">"]"</span>)))

    (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-export-allow-bind-keywords</span> <span style="color: #715ab1;">t</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">So users can use &#8220;#+bind&#8221; immediately</span>
    (<span style="color: #3a81c3; font-weight: bold;">if</span> <span style="color: #715ab1;">org-special-block-extras-hide-editor-comments</span>
        <span style="color: #2d9574;">""</span>
      (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
                ('latex (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"{\\color{%%s}%s %%s %%s %%s %%s}"</span> (<span style="color: #3a81c3; font-weight: bold;">if</span> strong <span style="color: #2d9574;">"\\bfseries"</span> <span style="color: #2d9574;">""</span>)))
                (_ (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"&lt;%s style=\"color: %%s;\"&gt;%%s %%s %%s %%s&lt;/%s&gt;"</span> (<span style="color: #3a81c3; font-weight: bold;">if</span> strong <span style="color: #2d9574;">"strong"</span> <span style="color: #2d9574;">"p"</span>) (<span style="color: #3a81c3; font-weight: bold;">if</span> strong <span style="color: #2d9574;">"strong"</span> <span style="color: #2d9574;">"p"</span>))))
              color edcomm-begin contents&#8242; signoff edcomm-end))))
</pre>
</div>

<p>
In the HTML export, the <code>edcomm</code> special block is <i>not</i> in-line with the text
surrounding it &#x2014;ideally, it would be inline so that existing paragraphs are
not split into multiple paragraphs but instead have an editor's comment
indicating suggested alterations.
</p>


</details>


<hr />

<p>
A block to make an editorial comment could be overkill in some cases; luckily
<abbr class="tooltip" title="Declare a new special block, and link, in the style of DEFUN.<br><br>A full featured example is at the end of this documentation string.<br><br>This is an anaphoric macro that provides export support for<br>special blocks <strong>and</strong> links named NAME. Just as an Org-mode src-block<br>consumes as main argument the language for the src block,<br>our special blocks too consume a MAIN-ARG; it may be a symbol<br>or a cons-list consisting of a symbolic name (with which<br>to refer to the main argument in the definition of the block)<br>followed by a default value, then, optionally, any information<br>for a one-time setup of the associated link type.<br><br>The main arg may be a sequence of symbols separated by spaces,<br>and a few punctuation with the exception of comma ‚Äò,‚Äô since<br>it is a special Lisp operator. In doubt, enclose the main arg<br>in quotes.<br><br>Then, just as Org-mode src blocks consume key-value pairs, our<br>special blocks consume a number of KWDS, which is a list of the<br>form (key‚ÇÄ value‚ÇÄ ‚Ä¶ key‚Çô value‚Çô).<br><br>After that is a DOCSTRING, a familar feature of DEFUN.<br>The docstring is displayed as part of the tooltip<br>for the produced link type.<br><br>Finally, the BODY is a (sequence of) Lisp forms ---no progn needed---<br>that may refer to the names BACKEND and CONTENTS<br>which refer to the current export backend and the contents<br>of the special block ---or the description clause of a link.<br><br>CONTENTS refers to an Org-mode parsed string; i.e.,<br>Org-markup is acknowledged.<br><br>In, hopefully, rare circumstances, one may refer<br>to RAW-CONTENTS to look at the fully unparsed contents.<br><br>----------------------------------------------------------------------<br><br>The relationship between links and special blocks:<br><br>&emsp;[ [type:label][description]]<br>‚âà<br>&emsp; #+begin_type label<br>&emsp;&emsp;description<br>&emsp; #+end_type<br><br>----------------------------------------------------------------------<br><br>Example declaration, with all possible features shown:<br><br>&emsp; ;; We can use variable values when defining new blocks<br>&emsp; (setq angry-red ‚Äô(:foreground ''red'' :weight bold))<br><br>&emsp; (defblock remark<br>&emsp;&emsp; (editor ''Editor Remark'' :face angry-red) (color ''red'' signoff '''')<br>&emsp;&emsp; ''Top level (HTML & LaTeX) editorial remarks; in Emacs they‚Äôre angry red.''<br>&emsp;&emsp; (format (if (equal backend ‚Äôhtml)<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''<strong style=\''color: %s;\''>‚ü¶%s:&emsp;%s%s‚üß</strong>''<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; ''{\color{%s}\bfseries %s:&emsp;%s%s}'')<br>&emsp;&emsp;&emsp;&emsp;&emsp;&emsp; color editor contents signoff))<br><br>&emsp; ;; I don‚Äôt want to change the definition, but I‚Äôd like to have<br>&emsp; ;; the following as personalised defaults for the ‚Äúremark‚Äù block.<br>&emsp; ;; OR, I‚Äôd like to set this for links, which do not have argument options.<br>&emsp; (defblock-header-args remark :main-arg ''Jasim Jameson'' :signoff ''( Aim for success! )'')<br><br>Three example uses:<br><br>&emsp;&emsp;;; ‚ü®0‚ü© As a special blocks with arguments given.<br>&emsp;&emsp;#+begin_remark Bobbert Barakallah :signoff ''Thank-you for pointing this out!'' :color green<br>&emsp;&emsp;I was trying to explain that <em>{large (n √ó (n + 1) over 2}</em> is always an integer.<br>&emsp;&emsp;#+end_remark<br><br>&emsp;&emsp;;; ‚ü®1‚ü© As a terse link, using default values for the args.<br>&emsp;&emsp;;;&emsp;&emsp; Notice that Org-mode formatting is recoqgnised even in links.<br>&emsp;&emsp;[ [remark:Jasim Jameson][Why are you taking about ‚Äú<em>mathsf{even}</em>‚Äù here?]]<br><br>&emsp;&emsp;;; ‚ü®2‚ü© So terse that no editor name is provided.<br>&emsp;&emsp;[ [remark:][Please improve your transition sentences.]]<br><br>&emsp;&emsp;;; ‚ü®‚òÖ‚ü© Unlike 0, examples 1 and 2 will have the default SIGNOFF<br>&emsp;&emsp;;; catenated as well as the default red color.<br><br>(fn NAME MAIN-ARG KWDS &optional (DOCSTRING '''') &rest BODY)">defblock</abbr> automatically provides an associated link type for the declared
special blocks.
</p>

<ul class="org-ul">
<li>Syntax: <code>[[remark:person_name][editorial remark]]</code>.</li>
<li>This link type exports the same as the <code>remark</code> block type;
however, in Emacs it is shown with an ‚Äòangry‚Äô &#x2014;bold&#x2014; red face.</li>
</ul>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example: Terse remarks via links</h3>


<div style="column-rule-style: solid;column-count: 2;">
<p>
<code>[[edcomm:Jasim][Hello, where are you?]]</code>
</p>

<p>


<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Jasim:</strong></span>

Hello, where are you?

  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>


</p>

</div>

<hr />

<div style="column-rule-style: solid;column-count: 2;">
<p>
The <code>#+replacewith:</code> switch &#x2014;and usual Org markup&#x2014; also works with these
links:  <br> <code>[[remark:Qasim][/‚Äòj‚Äô/ #+replacewith: /‚Äòq‚Äô/]]</code>
</p>

<br>
<p>


<p style="color: black;"><span style="border-width:1px;border-style:solid;padding:5px"><strong>[Qasim:&nbsp;<u>Replace:</u></strong></span>

<i>‚Äòj‚Äô</i>

<span style="border-width:1px;border-style:solid;padding:5px"><strong><u>With:</u></strong></span>

  <i>‚Äòq‚Äô</i>

  <span style="border-width:1px;border-style:solid;padding:5px"><strong>]</strong></span></p>


</p>

</div>



</div>
</div>
</div>


<div id="outline-container-Folded-Details" class="outline-2">
<h2 id="Folded-Details"><span class="section-number-2">3</span> <a href="#Folded-Details">Folded Details &#x2014;As well as boxed text and subtle colours</a></h2>
<div class="outline-text-2" id="text-Folded-Details">
<div class="org-center">
<p>
<i>How did we fold away those implementations?</i>
</p>
</div>

<p>
Sometimes there is a remark or a code snippet that is useful to have, but not
relevant to the discussion at hand and so we want to <i>fold away such <abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is ‚ÄúDetails‚Äù<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‚Äòbackground-color‚Äô.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (TITLE-COLOR ''green''))">details</abbr></i>.
</p>

<ul class="org-ul">
<li>‚ÄòConversation-style‚Äô articles, where the author asks the reader questions
whose answers are ‚Äúfolded away‚Äù so the reader can think about the exercise
before seeing the answer.</li>

<li>Hiding boring but important code snippets, such as a list of import
declarations or a tedious implementation.</li>
</ul>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,,#+latex_header:  <span style="color: #3a81c3; font-weight: bold;">\usepackage</span>{<span style="color: #3a81c3;">tcolorbox</span>}</code>
</p>
</div>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> details (title <span style="color: #2d9574;">"Details"</span>) (title-color <span style="color: #2d9574;">"green"</span>)
<span class="linenr"> 2: </span>  <span style="color: #2d9574;">"Enclose contents in a folded up box, for HTML.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #2d9574;">For LaTeX, this is just a boring, but centered, box.</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #2d9574;">By default, the TITLE of such blocks is &#8220;Details&#8221;</span>
<span class="linenr"> 7: </span><span style="color: #2d9574;">and its TITLE-COLOR is green.</span>
<span class="linenr"> 8: </span>
<span class="linenr"> 9: </span><span style="color: #2d9574;">In HTML, we show folded, details, regions with a nice greenish colour.</span>
<span class="linenr">10: </span>
<span class="linenr">11: </span><span style="color: #2d9574;">In the future ---i.e., when I have time---</span>
<span class="linenr">12: </span><span style="color: #2d9574;">it may be prudent to expose more aspects as arguments,</span>
<span class="linenr">13: </span><span style="color: #2d9574;">such as &#8216;</span><span style="color: #4e3163;">background-color</span><span style="color: #2d9574;">&#8217;.</span>
<span class="linenr">14: </span><span style="color: #2d9574;">"</span>
<span class="linenr">15: </span>  (<span style="color: #6c3163; font-weight: bold;">format</span>
<span class="linenr">16: </span>   (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
<span class="linenr">17: </span>     (`latex <span style="color: #2d9574;">"\\begin{quote}</span>
<span class="linenr">18: </span><span style="color: #2d9574;">                  \\begin{tcolorbox}[colback=%s,title={%s},sharp corners,boxrule=0.4pt]</span>
<span class="linenr">19: </span><span style="color: #2d9574;">                    %s</span>
<span class="linenr">20: </span><span style="color: #2d9574;">                  \\end{tcolorbox}</span>
<span class="linenr">21: </span><span style="color: #2d9574;">                \\end{quote}"</span>)
<span class="linenr">22: </span>     (_ <span style="color: #2d9574;">"&lt;details class=\"code-details\"</span>
<span class="linenr">23: </span><span style="color: #2d9574;">                 style =\"padding: 1em;</span>
<span class="linenr">24: </span><span style="color: #2d9574;">                          background-color: #e5f5e5;</span>
<span class="linenr">25: </span><span style="color: #2d9574;">                          /* background-color: pink; */</span>
<span class="linenr">26: </span><span style="color: #2d9574;">                          border-radius: 15px;</span>
<span class="linenr">27: </span><span style="color: #2d9574;">                          color: hsl(157 75% 20%);</span>
<span class="linenr">28: </span><span style="color: #2d9574;">                          font-size: 0.9em;</span>
<span class="linenr">29: </span><span style="color: #2d9574;">                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;\"&gt;</span>
<span class="linenr">30: </span><span style="color: #2d9574;">                  &lt;summary&gt;</span>
<span class="linenr">31: </span><span style="color: #2d9574;">                    &lt;strong&gt;</span>
<span class="linenr">32: </span><span style="color: #2d9574;">                      &lt;font face=\"Courier\" size=\"3\" color=\"%s\"&gt;</span>
<span class="linenr">33: </span><span style="color: #2d9574;">                         %s</span>
<span class="linenr">34: </span><span style="color: #2d9574;">                      &lt;/font&gt;</span>
<span class="linenr">35: </span><span style="color: #2d9574;">                    &lt;/strong&gt;</span>
<span class="linenr">36: </span><span style="color: #2d9574;">                  &lt;/summary&gt;</span>
<span class="linenr">37: </span><span style="color: #2d9574;">                  %s</span>
<span class="linenr">38: </span><span style="color: #2d9574;">               &lt;/details&gt;"</span>))
<span class="linenr">39: </span>   title-color title contents))
</pre>
</div>



<p>
We could use
<code class="src src-latex"><span style="color: #3a81c3; font-weight: bold;">\begin</span>{<span style="color: #6c3163; font-weight: bold;">quote</span>}<span style="color: #3a81c3; font-weight: bold;">\fbox</span>{<span style="color: #3a81c3; font-weight: bold;">\parbox</span>{<span style="color: #3a81c3; font-weight: bold;">\linewidth</span>}{<span style="color: #3a81c3; font-weight: bold;">\textbf</span>{<span style="font-weight: bold;">Details:</span>} ...}}<span style="color: #3a81c3; font-weight: bold;">\end</span>{<span style="color: #6c3163; font-weight: bold;">quote</span>}</code>; however, this does not work well with <a href="https://github.com/alhassy/emacs.d#bibliography--coloured-latex-using-minted">minted</a> for coloured
source blocks. Instead, we use <code>tcolorbox</code>.
</p>



</details>
</div>


<div id="outline-container-Example" class="outline-3">
<h3 id="Example"><span class="section-number-3">3.1</span> <a href="#Example">Example: <i>Here's a nifty puzzle, can you figure it out?</i></a></h3>
<div class="outline-text-3" id="text-Example">
<p>
Reductions &#x2014;incidentally also called ‚Äòfolds‚Äô<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup>&#x2014; embody primitive
recursion and thus computability. For example, what does the following compute
when given a whole number ùìÉ?
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">-reduce</span> #'<span style="color: #6c3163; font-weight: bold;">/</span> (<span style="color: #6c3163; font-weight: bold;">number-sequence</span> 1.0 &#120003;))
</pre>
</div>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="pink">
                         Solution
                      </font>
                    </strong>
                  </summary>
<p>
Rather than guess-then-check, let's <i>calculate</i>!
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (<span style="color: #6c3163; font-weight: bold;">-reduce</span> #'<span style="color: #6c3163; font-weight: bold;">/</span> (<span style="color: #6c3163; font-weight: bold;">number-sequence</span> 1.0 &#120003;))
<span style="color: #6c3163; font-weight: bold;">=</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Lisp is strict: Evaluate inner-most expression</span>
  (<span style="color: #6c3163; font-weight: bold;">-reduce</span> #'<span style="color: #6c3163; font-weight: bold;">/</span> '(1.0 2.0 3.0 &#8230; &#120003;))
<span style="color: #6c3163; font-weight: bold;">=</span> <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Evaluate left-associating reduction</span>
  (<span style="color: #6c3163; font-weight: bold;">/</span> (<span style="color: #6c3163; font-weight: bold;">/</span> (<span style="color: #6c3163; font-weight: bold;">/</span> 1.0 2.0) &#8943;) &#120003;)
<span style="color: #6c3163; font-weight: bold;">=</span><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Arithmetic: (/ (/ a b) c) = (* (/ a b) (/ 1 c)) = (/ a (* b c))</span>
  (<span style="color: #6c3163; font-weight: bold;">/</span> 1.0 (<span style="color: #6c3163; font-weight: bold;">*</span> 2.0 3.0 &#8230; &#120003;))
</pre>
</div>

<p>
We have thus found the above Lisp program to compute the inverse factorial of ùìÉ;
i.e., \(\large \frac{1}{ùìÉ!}\).
</p>


</details>


<p>
Neato, let's do more super cool stuff ^_^
</p>

<div class="footnotesize" id="orgfd86f15">
<p>
( In the Emacs Web Wowser, folded regions are displayed unfolded similar to
LaTeX. )
</p>

</div>
</div>
</div>
<div id="outline-container-Boxed-Text" class="outline-3">
<h3 id="Boxed-Text"><span class="section-number-3">3.2</span> <a href="#Boxed-Text">Boxed Text</a></h3>
<div class="outline-text-3" id="text-Boxed-Text">
<p>
Folded regions, as implemented above, are displayed in a super neat text box
which may be useful to enclose text to make it standout &#x2014;without having it
folded away. As such, we provide the special block <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box‚Äôs COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (BACKGROUND-COLOR nil))">box</abbr> to enclosing text in
boxes.
</p>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,#+latex_header:  <span style="color: #3a81c3; font-weight: bold;">\usepackage</span>{<span style="color: #3a81c3;">tcolorbox</span>}</code>
</p>
</div>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> box (title <span style="color: #2d9574;">""</span>) (background-color nil)
<span class="linenr"> 2: </span>  <span style="color: #2d9574;">"Enclose text in a box, possibly with a title.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #2d9574;">By default, the box's COLOR is green for HTML and red for LaTeX,</span>
<span class="linenr"> 5: </span><span style="color: #2d9574;">and it has no TITLE.</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #2d9574;">The HTML export uses a padded div, whereas the LaTeX export</span>
<span class="linenr"> 8: </span><span style="color: #2d9574;">requires the tcolorbox pacakge.</span>
<span class="linenr"> 9: </span>
<span class="linenr">10: </span><span style="color: #2d9574;">In the future, I will likely expose more arguments.</span>
<span class="linenr">11: </span><span style="color: #2d9574;">"</span>
<span class="linenr">12: </span>  (<span style="color: #6c3163; font-weight: bold;">apply</span> #'<span style="color: #6c3163; font-weight: bold;">concat</span>
<span class="linenr">13: </span>  (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
<span class="linenr">14: </span>   (`latex `(<span style="color: #2d9574;">"\\begin{tcolorbox}[title={"</span> ,title <span style="color: #2d9574;">"}"</span>
<span class="linenr">15: </span>             <span style="color: #2d9574;">",colback="</span> ,(<span style="color: #6c3163; font-weight: bold;">pp-to-string</span> (<span style="color: #3a81c3; font-weight: bold;">or</span> background-color 'red!5!white))
<span class="linenr">16: </span>             <span style="color: #2d9574;">",colframe=red!75!black, colbacktitle=yellow!50!red"</span>
<span class="linenr">17: </span>             <span style="color: #2d9574;">",coltitle=red!25!black, fonttitle=\\bfseries,"</span>
<span class="linenr">18: </span>             <span style="color: #2d9574;">"subtitle style={boxrule=0.4pt, colback=yellow!50!red!25!white}]"</span>
<span class="linenr">19: </span>             ,contents
<span class="linenr">20: </span>             <span style="color: #2d9574;">"\\end{tcolorbox}"</span>))
<span class="linenr">21: </span>    (_ `(<span style="color: #2d9574;">"&lt;div style=\"padding: 1em; background-color: "</span>
<span class="linenr">22: </span>             ,(<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--subtle-colors</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s"</span> (<span style="color: #3a81c3; font-weight: bold;">or</span> background-color <span style="color: #2d9574;">"green"</span>)))
<span class="linenr">23: </span>             <span style="color: #2d9574;">";border-radius: 15px; font-size: 0.9em"</span>
<span class="linenr">24: </span>             <span style="color: #2d9574;">"; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;\"&gt;"</span>
<span class="linenr">25: </span>             <span style="color: #2d9574;">"&lt;h3&gt;"</span> ,title <span style="color: #2d9574;">"&lt;/h3&gt;"</span>
<span class="linenr">26: </span>            ,contents <span style="color: #2d9574;">"&lt;/div&gt;"</span>)))))
</pre>
</div>




</details>


<br>

<div style="padding: 1em; background-color: #CCFFFF;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example: A super boring observation presented obscurely</h3>

<p>
If you start walking &#x2014;say, counterclockwise&#x2014; along the unit circle from its
right-most point and walk 180·µí, then you will be at its left-most point. That
is, \[ e^{i ¬∑ \pi} \;=\; - 1 \]
</p>



</div>


<p>
<i>How did we get that nice light blue? What is its HTML code?</i>
That's not something I care to remember, so let's make a handy
dandy utility ‚Ä¶ Now when users request a colour to <code>box</code> their text,
it will be a ‚Äòsubtle colour‚Äô ;-)
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation for Subtle Colours
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--subtle-colors</span> (c)
<span class="linenr"> 2: </span>  <span style="color: #da8b55;">"HTML codes for common colours.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #da8b55;">Names are very rough approximates.</span>
<span class="linenr"> 5: </span>
<span class="linenr"> 6: </span><span style="color: #da8b55;">   Translations from: https://www.december.com/html/spec/softhues.html"</span>
<span class="linenr"> 7: </span>  (<span style="color: #3a81c3; font-weight: bold;">pcase</span> c
<span class="linenr"> 8: </span>    (<span style="color: #2d9574;">"teal"</span>    <span style="color: #2d9574;">"#99FFCC"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">close to aqua</span>
<span class="linenr"> 9: </span>    (<span style="color: #2d9574;">"brown"</span>   <span style="color: #2d9574;">"#CCCC99"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">close to moss</span>
<span class="linenr">10: </span>    (<span style="color: #2d9574;">"gray"</span>    <span style="color: #2d9574;">"#CCCCCC"</span>)
<span class="linenr">11: </span>    (<span style="color: #2d9574;">"purple"</span>  <span style="color: #2d9574;">"#CCCCFF"</span>)
<span class="linenr">12: </span>    (<span style="color: #2d9574;">"lime"</span>    <span style="color: #2d9574;">"#CCFF99"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">brighter than &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">green</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217;</span>
<span class="linenr">13: </span>    (<span style="color: #2d9574;">"green"</span>   <span style="color: #2d9574;">"#CCFFCC"</span>)
<span class="linenr">14: </span>    (<span style="color: #2d9574;">"blue"</span>    <span style="color: #2d9574;">"#CCFFFF"</span>)
<span class="linenr">15: </span>    (<span style="color: #2d9574;">"orange"</span>  <span style="color: #2d9574;">"#FFCC99"</span>)
<span class="linenr">16: </span>    (<span style="color: #2d9574;">"peach"</span>   <span style="color: #2d9574;">"#FFCCCC"</span>)
<span class="linenr">17: </span>    (<span style="color: #2d9574;">"pink"</span>    <span style="color: #2d9574;">"#FFCCFF"</span>)
<span class="linenr">18: </span>    (<span style="color: #2d9574;">"yellow"</span>  <span style="color: #2d9574;">"#FFFF99"</span>)
<span class="linenr">19: </span>    (<span style="color: #2d9574;">"custard"</span> <span style="color: #2d9574;">"#FFFFCC"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">paler than &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">yellow</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217;</span>
<span class="linenr">20: </span>    (c c)
<span class="linenr">21: </span>  ))
</pre>
</div>

<p>
To use these colour names, you will need the following incantations in your
Org file.
</p>



<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

#+latex_header: \usepackage{xcolor}<br><br>#+latex_header: \definecolor{teal}    {HTML}{99FFCC}<br>#+latex_header: \definecolor{brown}   {HTML}{CCCC99}<br>#+latex_header: \definecolor{gray}    {HTML}{CCCCCC}<br>#+latex_header: \definecolor{purple}  {HTML}{CCCCFF}<br>#+latex_header: \definecolor{lime}    {HTML}{CCFF99}<br>#+latex_header: \definecolor{green}   {HTML}{CCFFCC}<br>#+latex_header: \definecolor{blue}    {HTML}{CCFFFF}<br>#+latex_header: \definecolor{orange}  {HTML}{FFCC99}<br>#+latex_header: \definecolor{peach}   {HTML}{FFCCCC}<br>#+latex_header: \definecolor{pink}{HTML}{FFCCFF}<br>#+latex_header: \definecolor{yellow}  {HTML}{FFFF99}<br>#+latex_header: \definecolor{custard}{HTML}{FFFFCC}<br><br>#+latex_header: \definecolor{cyan}{HTML}{00FFFF}<br>

</div>


<div style="padding: 1em; background-color: cyan;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
</div>

</div>

<p>
In the future, it'd be nice to account for colours for LaTeX as well.  ( E.g.,
<code class="src src-latex"><span style="color: #3a81c3; font-weight: bold;">\color</span>{blue}</code> is a nightmare. )
</p>


</details>


<p>
It may be useful to <i>fuse</i> the <code>box</code> and <code>details</code> concepts into one.  Something for
future me &#x2014;or another contributor&#x2014; to think about ;-)
</p>
</div>
</div>
</div>

<div id="outline-container-Parallel" class="outline-2">
<h2 id="Parallel"><span class="section-number-2">4</span> <a href="#Parallel">Parallel</a></h2>
<div class="outline-text-2" id="text-Parallel">
<p>
Articles can get lengthy when vertical whitespace is wasted on thin lines;
instead, one could save space by using <i><abbr class="tooltip" title="Place ideas side-by-side, possibly with a seperator.<br><br>There are COLS many columns, and they may be seperated by black<br>solid vertical rules if BAR is a non-nil value.<br><br>Writing ‚Äú#+begin_parallel ùìÉ :bar (any text except ‚Äònil‚Äô)‚Äù<br>will produce a parallel of ùìÉ many columns, possibly<br>seperated by solid rules, or a ‚Äúbar‚Äù.<br><br>The contents of the block may contain ‚Äò#+columnbreak:‚Äô to request<br>a columnbreak. This has no effect on HTML export since HTML<br>describes how text should be formatted on a browser, which can<br>dynamically shrink and grow and thus it makes no sense to have<br>hard columnbreaks.<br><br>(fn BACKEND RAW-CONTENTS &optional COLS &rest ## &key (BAR nil))">parallel</abbr> columns of text</i>.
</p>

<div class="org-center">
<p>
Requires: <code class="src src-latex">,#+latex_header:  <span style="color: #3a81c3; font-weight: bold;">\usepackage</span>{<span style="color: #3a81c3;">multicol</span>}</code>
</p>
</div>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span class="linenr"> 1: </span>(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> parallel (cols 2) (bar nil)
<span class="linenr"> 2: </span>  <span style="color: #2d9574;">"Place ideas side-by-side, possibly with a seperator.</span>
<span class="linenr"> 3: </span>
<span class="linenr"> 4: </span><span style="color: #2d9574;">There are COLS many columns, and they may be seperated by black</span>
<span class="linenr"> 5: </span><span style="color: #2d9574;">solid vertical rules if BAR is a non-nil value.</span>
<span class="linenr"> 6: </span>
<span class="linenr"> 7: </span><span style="color: #2d9574;">Writing &#8220;#+begin_parallel &#120003; :bar (any text except &#8216;</span><span style="color: #4e3163;">nil</span><span style="color: #2d9574;">&#8217;)&#8221;</span>
<span class="linenr"> 8: </span><span style="color: #2d9574;">will produce a parallel of &#120003; many columns, possibly</span>
<span class="linenr"> 9: </span><span style="color: #2d9574;">seperated by solid rules, or a &#8220;bar&#8221;.</span>
<span class="linenr">10: </span>
<span class="linenr">11: </span><span style="color: #2d9574;">The contents of the block may contain &#8216;#+columnbreak:&#8217; to request</span>
<span class="linenr">12: </span><span style="color: #2d9574;">a columnbreak. This has no effect on HTML export since HTML</span>
<span class="linenr">13: </span><span style="color: #2d9574;">describes how text should be formatted on a browser, which can</span>
<span class="linenr">14: </span><span style="color: #2d9574;">dynamically shrink and grow and thus it makes no sense to have</span>
<span class="linenr">15: </span><span style="color: #2d9574;">hard columnbreaks.</span>
<span class="linenr">16: </span><span style="color: #2d9574;">"</span>
<span class="linenr">17: </span>  (<span style="color: #3a81c3; font-weight: bold;">let</span> ((rule (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
<span class="linenr">18: </span>               (`latex (<span style="color: #3a81c3; font-weight: bold;">if</span> bar 2 0))
<span class="linenr">19: </span>               (_  (<span style="color: #3a81c3; font-weight: bold;">if</span> bar <span style="color: #2d9574;">"solid"</span> <span style="color: #2d9574;">"none"</span>))))
<span class="linenr">20: </span>        (contents&#8242;  (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"#+columnbreak:"</span>
<span class="linenr">21: </span>                               (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> 'latex backend) <span style="color: #2d9574;">"\\columnbreak"</span> <span style="color: #2d9574;">""</span>)
<span class="linenr">22: </span>                               contents)))
<span class="linenr">23: </span>  (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
<span class="linenr">24: </span>   (`latex <span style="color: #2d9574;">"\\par \\setlength{\\columnseprule}{%s pt}</span>
<span class="linenr">25: </span><span style="color: #2d9574;">          \\begin{minipage}[t]{\\linewidth}</span>
<span class="linenr">26: </span><span style="color: #2d9574;">          \\begin{multicols}{%s}</span>
<span class="linenr">27: </span><span style="color: #2d9574;">          %s</span>
<span class="linenr">28: </span><span style="color: #2d9574;">          \\end{multicols}\\end{minipage}"</span>)
<span class="linenr">29: </span>   (_ <span style="color: #2d9574;">"&lt;div style=\"column-rule-style: %s;column-count: %s;\"&gt;%s&lt;/div&gt;"</span>))
<span class="linenr">30: </span>   rule cols contents&#8242;)))
</pre>
</div>

<p>
Going forward, it would be desirable to have the columns take a specified percentage of
the available width &#x2014;whereas currently it splits it uniformly.  Such a feature
would be useful in cases where one column is wide and the others are not.
</p>



</details>


<br>

<div style="padding: 1em; background-color: #CCFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Example</h3>
<p>
<span class="underline">This</span>
</p>
<div class="org-src-container">
<pre class="src src-C">#+begin_parallel 2 :bar yes-or-any-other-text
X

Y

#+columnbreak:

Z
#+end_parallel
</pre>
</div>

<p>
<span class="underline">Yields</span>
</p>


<div style="column-rule-style: solid;column-count: 2;">
<p>
X
</p>

<p>
Y
</p>



<p>
Z
</p>

</div>


</div>


<div class="org-center">
<p>
( The <a href="https://www.gnu.org/software/emacs/manual/html_mono/eww.html">Emacs Web Wowser</a>, <code>M-x eww</code>, does not display <code>parallel</code> environments as
desired. )
</p>
</div>
</div>
</div>

<div id="outline-container-Colours" class="outline-2">
<h2 id="Colours"><span class="section-number-2">5</span> <a href="#Colours">Colours</a></h2>
<div class="outline-text-2" id="text-Colours">
<p>
Let's develop blocks for colouring text and link types for inline colouring;
e.g., <abbr class="tooltip" title="Format text according to a given COLOR, which is black by default.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key)">color</abbr> and <abbr class="tooltip" title="Show text in teal color.<br><br>(fn BACKEND RAW-CONTENTS &optional ## &rest ## &key)">teal</abbr>.
</p>


<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3></h3>
<p>
Use <kbd> M-x list-colors-display </kbd> to see a list of defined colour names in Emacs
  &#x2014;see <a href="http://muug.ca/mirror/ctan/macros/latex/contrib/xcolor/xcolor.pdf">xcolor</a> for the LaTeX side and <a href="https://htmlcolorcodes.com/color-names/">htmlcolorcodes.com</a> for the HTML side, or
  just visit <a href="http://latexcolor.com/">http://latexcolor.com/</a> for both.
</p>

</div>


<br>
<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         A Picture and Block Examples
                      </font>
                    </strong>
                  </summary>


<div id="org4a74baf" class="figure">
<p><img src="images/colours.jpg" alt="colours.jpg" />
</p>
</div>

<hr />


<div style="column-rule-style: none;column-count: 2;">

<span style="color:black;">
<p>
This text is black!
</p>

</span>



<span style="color:blue;">
<p>
This text is blue!
</p>

</span>



<span style="color:brown;">
<p>
This text is brown!
</p>

</span>


<span style="color:darkgray;">
<p>
This text is darkgray!
</p>

</span>



<span style="color:gray;">
<p>
This text is gray!
</p>

</span>



<span style="color:green;">
<p>
This text is green!
</p>

</span>



<span style="color:lightgray;">
<p>
This text is lightgray!
</p>

</span>



<span style="color:lime;">
<p>
This text is lime!
</p>

</span>



<span style="color:magenta;">
<p>
This text is magenta!
</p>

</span>



<span style="color:olive;">
<p>
This text is olive!
</p>

</span>



<span style="color:orange;">
<p>
This text is orange!
</p>

</span>



<span style="color:pink;">
<p>
This text is pink!
</p>

</span>



<span style="color:purple;">
<p>
This text is purple!
</p>

</span>



<span style="color:red;">
<p>
This text is red!
</p>

</span>



<span style="color:teal;">
<p>
This text is teal!
</p>

</span>



<span style="color:violet;">
<p>
This text is violet!
</p>

</span>



<span style="color:white;">
<p>
This text is white!
</p>

</span>



<span style="color:yellow;">
<p>
This text is yellow!
</p>

</span>



</div>




</details>


<br>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of numerous colour blocks/links
                      </font>
                    </strong>
                  </summary>
<p>
We declare a list of colors that should be available on most systems.  Then
using this list, we evaluate the code necessary to produce the necessary
functions that format special blocks.
</p>

<p>
By default, Org uses the <code>graphicx</code> LaTeX package which let's us colour text
&#x2014;see its documentation <a href="http://ctan.mirror.rafal.ca/macros/latex/required/graphics/grfguide.pdf">here</a>.  For example, in an <code>#+begin_export latex</code> block,
the following produces blue coloured text.
</p>
<pre class="example" id="orgcc663d1">
{  \color{blue}  This is a sample text in blue.  }
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--colors</span>
  '(black blue brown cyan darkgray gray green lightgray lime
          magenta olive orange pink purple red teal violet white
          yellow)
  <span style="color: #da8b55;">"Colours that should be available on all systems."</span>)

(<span style="color: #3a81c3; font-weight: bold;">cl-loop</span> for colour in <span style="color: #715ab1;">org-special-block-extras--colors</span>
      <span style="color: #6c3163; font-weight: bold;">do</span> (<span style="color: #6c3163; font-weight: bold;">eval</span> (<span style="color: #6c3163; font-weight: bold;">read</span> (<span style="color: #6c3163; font-weight: bold;">format</span>
                      <span style="color: #2d9574;">"(org-special-block-extras--defblock %s (_ \"\" :face '(:foreground \"%s\")) nil</span>
<span style="color: #2d9574;">                        \"Show text in %s color.\"</span>
<span style="color: #2d9574;">                     (format (pcase backend</span>
<span style="color: #2d9574;">                     (`latex \"\\\\begingroup\\\\color{%s}%%s\\\\endgroup\\\\,\")</span>
<span style="color: #2d9574;">                     (_  \"&lt;span style=\\\"color:%s;\\\"&gt;%%s&lt;/span&gt;\"))</span>
<span style="color: #2d9574;">                     contents))"</span> colour colour colour colour colour))))
</pre>
</div>



</details>


<br>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of ‚Äòcolor‚Äô
                      </font>
                    </strong>
                  </summary>
<p>
For faster experimentation between colours, we provide a generic <code>color</code> block
that consumes a color argument.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> color (color black    <span style="color: #3a81c3;">:face</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (colour)
           (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">member</span> (<span style="color: #6c3163; font-weight: bold;">intern</span> colour) <span style="color: #715ab1;">org-special-block-extras--colors</span>)
               `(<span style="color: #3a81c3;">:foreground</span> ,(<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s"</span> colour))
             `(<span style="color: #3a81c3;">:height</span> 300
               <span style="color: #3a81c3;">:underline</span> (<span style="color: #3a81c3;">:color</span> <span style="color: #2d9574;">"red"</span> <span style="color: #3a81c3;">:style</span> wave)
               <span style="color: #3a81c3;">:overline</span>  <span style="color: #2d9574;">"red"</span> <span style="color: #3a81c3;">:strike-through</span> <span style="color: #2d9574;">"red"</span>)))) <span style="color: #dc752f; background-color: #fbf8ef;">nil</span>
  <span style="color: #2d9574;">"Format text according to a given COLOR, which is black by default."</span>
  (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
            (`latex <span style="color: #2d9574;">"\\begingroup\\color{%s}%s\\endgroup\\,"</span>)
            (`html  <span style="color: #2d9574;">"&lt;span style=\"color:%s;\"&gt;%s&lt;/span&gt;"</span>))
          color contents))
</pre>
</div>


</details>


<p>
We want the syntax <code>red:text</code> to <i>render</i> ‚Äòtext‚Äô with the colour red
in <b>both</b> the Emacs interface and in exported backends.
</p>


<div id="orgfd02451" class="figure">
<p><img src="images/colour_links.png" alt="colour_links.png" />
</p>
</div>

<div class="org-center">
<p>
Observe:

<span style="color:red;">

this

</span>



<span style="color:green;">

is

</span>



<span style="color:cyan;">

super

</span>



<span style="color:teal;">

neato

</span>

,

<span style="color:purple;">

amigos

</span>

! and

<span style="color:brown;">

this is brown ‚Äòcolor‚Äô link

</span>

 and

<span style="color:orange;">

this one is an orange ‚Äòcolor‚Äô link!

</span>


</p>

<p>
Also: If we try to use an unsupported colour ‚Äòwombo‚Äô, we render the descriptive
text larger in Emacs along with a tooltip explaining why this is the case;
e.g.,
<code>[[color:wombo][hi]]</code>.
</p>
</div>

<p>
( Markdown does not support colour; go look at the HTML or PDF! )
</p>
</div>
<div id="outline-container-latex-definitions-for-hiding-LaTeX-declarations-in-HTML" class="outline-3">
<h3 id="latex-definitions-for-hiding-LaTeX-declarations-in-HTML"><span class="section-number-3">5.1</span> <a href="#latex-definitions-for-hiding-LaTeX-declarations-in-HTML">¬† <code>latex-definitions</code> for hiding LaTeX declarations in HTML</a></h3>
<div class="outline-text-3" id="text-latex-definitions-for-hiding-LaTeX-declarations-in-HTML">
<p>
Before indicating desirable next steps, let us produce an incidentally useful
special block type.
</p>

<p>
We may use LaTeX-style commands such as <code>{\color{red} x}</code> by enclosing them in
<code>$</code>-symbols to obtain \({\color{red}x}\) and other commands to present mathematical
formulae in HTML.  This is known as the MathJax tool &#x2014;Emacs' default HTML
export includes it.
</p>

<p>
It is common to declare LaTeX definitions for convenience, but such
declarations occur within <code>$</code>-delimiters and thereby produce undesirable extra
whitespace. We declare the <code>latex_definitions</code> block type which avoids
displaying such extra whitespace in the resulting HTML.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‚Äòlatex-definitions‚Äô Implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> latex-definitions nil nil
  <span style="color: #2d9574;">"Declare but do not display the CONTENTS according to the BACKEND."</span>
  (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
            ('html <span style="color: #2d9574;">"&lt;p style=\"display:none\"&gt;\\[</span><span style="color: #4e3163;">%s\\</span><span style="color: #2d9574;">]&lt;/p&gt;"</span>)
            (_ <span style="color: #2d9574;">"%s"</span>))
          raw-contents))
</pre>
</div>


</details>


<p>
Here &#x2014;which you cannot see, as <i>desired</i>&#x2014;is an example usage, where we
declare <code>\LL</code> to produce a violet left parenthesis. We then use these to produce
an example of quantification notation.
</p>

<p style="display:none">\[\def\LL{\color{violet}(}
\def\RR{\color{violet})}
\]</p>


<p>
\[
 {\color{teal}\bigoplus}
 _{   {\color{violet} x}
    = {\color{red} a}}
 ^{\color{cyan} b}
    {\color{brown}{\,f\, x}}
 \quad=\quad
            {\color{brown}{f\,\LL  {\color{red} a} \RR}}
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 1 \RR }}
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL a + 2 \RR }}
 \;{\color{teal}\oplus}\; \cdots
 \;{\color{teal}\oplus}\; {\color{brown}{f \, \LL {\color{cyan} b} \RR}}
 \]
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">

<span style="color:teal;">

‚äï

</span>

</td>
<td class="org-left"><i>Loop sequentially with loop-bodies fused using

<span style="color:teal;">

‚äï

</span>

</i></td>
</tr>

<tr>
<td class="org-left"><i>

<span style="color:violet;">

x

</span>

</i></td>
<td class="org-left"><i>Use

<span style="color:violet;">

x

</span>

 as the name of the current element</i></td>
</tr>

<tr>
<td class="org-left"><i>

<span style="color:red;">

a

</span>

</i></td>
<td class="org-left"><i>Start with

<span style="color:violet;">

x

</span>

 being

<span style="color:red;">

a

</span>

</i></td>
</tr>

<tr>
<td class="org-left"><i>

<span style="color:cyan;">

b

</span>

</i></td>
<td class="org-left"><i>End with

<span style="color:violet;">

x

</span>

 being

<span style="color:cyan;">

b

</span>

</i></td>
</tr>

<tr>
<td class="org-left"><i>

<span style="color:brown;">

f x

</span>

</i></td>
<td class="org-left"><i>At each

<span style="color:violet;">

x

</span>

 value, compute

<span style="color:brown;">

f x

</span>

</i></td>
</tr>
</tbody>
</table>

<p>
( Markdown does not support MathJax; go look at the HTML or PDF! )
</p>

<hr />

<p>
Unfortunately, MathJax does not easily support arbitrary HTML elements to occur
within the <code>$</code>-delimiters &#x2014;see <a href="https://stackoverflow.com/questions/58883048/mathjax-or-similar-render-arbitrary-html-element-inside-expression">this</a> and <a href="https://github.com/mathjax/MathJax/issues/1707">this</a> for ‚Äòworkarounds‚Äô.  As such, the
MathJax producing the above example is rather ugly whereas its subsequent
explanatory table is prettier on the writer's side.
</p>

<p>


<span style="color:orange;">

Going forward,

</span>

 it would be nice to easily have our colour links work within
a mathematical special block.
</p>

<p>


<span style="color:orange;">

Moreover,

</span>

 it would be nice to extend the <code>color</code> block type to take multiple
arguments, say, <code>c‚ÇÅ c‚ÇÇ ‚Ä¶ c‚Çô</code> such that:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right"><i>n</i></th>
<th scope="col" class="org-left">Behaviour</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">0</td>
<td class="org-left">No colouring; likewise if no arguments altogether</td>
</tr>

<tr>
<td class="org-right">1</td>
<td class="org-left">Colour all entries using the given colour c‚ÇÅ</td>
</tr>

<tr>
<td class="org-right"><i>n</i></td>
<td class="org-left">Paragraph &#x2013;region separated by a new line&#x2013; <code>i</code> is coloured by <code>c‚Çñ</code> where <code>k = i mod n</code></td>
</tr>
</tbody>
</table>

<p>
Besides having a colourful article, another usage I envision for this
generalisation would be when rendering text in multiple languages; e.g., use red
and blue to interleave Arabic poetry with its English translation.
</p>
</div>
</div>
</div>

<div id="outline-container-" class="outline-2">
<h2 id=""><span class="section-number-2">6</span> <a href="#">Nice Keystroke Renditions: <kbd> C-h h </kbd></a></h2>
<div class="outline-text-2" id="text-">
<p>
Anyone who writes <i>about</i> Emacs will likely want to mention keystrokes in an
aesthetically pleasing way, such as <kbd> C-u 80 - </kbd> to insert 80 dashes
or <kbd> C-c C-e h o </kbd> to export an Org-mode file to HTML.
</p>

<ul class="org-ul">
<li>If there is a description, we render it in keystroke style.</li>
<li>If there is only a label, we translate underscores into spaces.</li>
</ul>


<div id="org06edeab" class="figure">
<p><img src="./images/kbd.png" alt="kbd.png" />
</p>
</div>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation
                      </font>
                    </strong>
                  </summary>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
 <span style="color: #2d9574;">"kbd"</span>
  <span style="color: #3a81c3;">:follow</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (_))
  <span style="color: #3a81c3;">:export</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label description backend)
            (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
                      ('latex <span style="color: #2d9574;">"\\texttt{%s}"</span>)
                      (_ <span style="color: #2d9574;">"&lt;kbd&gt; %s &lt;/kbd&gt;"</span>) )
                    (<span style="color: #3a81c3; font-weight: bold;">or</span> description (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"_"</span> <span style="color: #2d9574;">" "</span> label)))))
</pre>
</div>

<p>
The following styling rule is used to make the keystrokes displayed nicely.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--kbd-html-setup</span> nil
  <span style="color: #da8b55;">"Has the necessary keyboard styling HTML beeen added?"</span>)

(<span style="color: #3a81c3; font-weight: bold;">unless</span> <span style="color: #715ab1;">org-special-block-extras--kbd-html-setup</span>
  (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--kbd-html-setup</span> <span style="color: #715ab1;">t</span>)
(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-html-head-extra</span>
 (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #715ab1;">org-html-head-extra</span>
<span style="color: #2d9574;">"</span>
<span style="color: #2d9574;">&lt;style&gt;</span>
<span style="color: #2d9574;">/* From: https://endlessparentheses.com/public/css/endless.css */</span>
<span style="color: #2d9574;">/* See also: https://meta.superuser.com/questions/4788/css-for-the-new-kbd-style */</span>
<span style="color: #2d9574;">kbd</span>
<span style="color: #2d9574;">{</span>
<span style="color: #2d9574;">  -moz-border-radius: 6px;</span>
<span style="color: #2d9574;">  -moz-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2d9574;">  -webkit-border-radius: 6px;</span>
<span style="color: #2d9574;">  -webkit-box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2d9574;">  background-color: #f7f7f7;</span>
<span style="color: #2d9574;">  border: 1px solid #ccc;</span>
<span style="color: #2d9574;">  border-radius: 6px;</span>
<span style="color: #2d9574;">  box-shadow: 0 1px 0 rgba(0,0,0,0.2),0 0 0 2px #fff inset;</span>
<span style="color: #2d9574;">  color: #333;</span>
<span style="color: #2d9574;">  display: inline-block;</span>
<span style="color: #2d9574;">  font-family: 'Droid Sans Mono', monospace;</span>
<span style="color: #2d9574;">  font-size: 80%;</span>
<span style="color: #2d9574;">  font-weight: normal;</span>
<span style="color: #2d9574;">  line-height: inherit;</span>
<span style="color: #2d9574;">  margin: 0 .1em;</span>
<span style="color: #2d9574;">  padding: .08em .4em;</span>
<span style="color: #2d9574;">  text-shadow: 0 1px 0 #fff;</span>
<span style="color: #2d9574;">  word-spacing: -4px;</span>

<span style="color: #2d9574;">  box-shadow: 2px 2px 2px #222; /* MA: An extra I've added. */</span>
<span style="color: #2d9574;">}</span>
<span style="color: #2d9574;">&lt;/style&gt;"</span>)))
</pre>
</div>



</details>


<p>


<span style="color:orange;">

Going forward

</span>

, it would be nice to render <code>kbd:ùí≥</code> links in a pretty way within
Emacs itself.
</p>
</div>
</div>

<div id="outline-container-Link-Here-OctoIcons" class="outline-2">
<h2 id="Link-Here-OctoIcons"><span class="section-number-2">7</span> <a href="#Link-Here-OctoIcons">¬† <i>‚ÄúLink Here!‚Äù</i> &amp; OctoIcons</a></h2>
<div class="outline-text-2" id="text-Link-Here-OctoIcons">
<p>
Use the syntax <code>link-here:name</code> to create an anchor link that alters the URL with
<code>#name</code> as in ‚Äú<a class="anchor" aria-hidden="true" id="name" href="#name"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>‚Äù
&#x2014;it looks and behaves like the Github generated links for a heading.
Use case: Sometimes you want to explicitly point to a particular location in an
article, such as within a <code>#+begin_details</code> block, this is a possible way to do so.
</p>

<p>
Likewise, get OctoIcons with the syntax <code>octoicon:ùí≥</code> where <code>ùí≥</code> is one of <code>home,
link, mail, report, tag, clock</code>: <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0 1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12 14z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16"><path fill-rule="evenodd" d="M0 4v8c0 .55.45 1 1 1h12c.55 0 1-.45 1-1V4c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1zm13 0L7 9 1 4h12zM1 5.5l4 3-4 3v-6zM2 12l3.5-3L7 10.5 8.5 9l3.5 3H2zm11-.5l-4-3 4-3v6z"></path></svg>,
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path fill-rule="evenodd" d="M0 2a1 1 0 011-1h14a1 1 0 011 1v9a1 1 0 01-1 1H7l-4 4v-4H1a1 1 0 01-1-1V2zm1 0h14v9H6.5L4 13.5V11H1V2zm6 6h2v2H7V8zm0-5h2v4H7V3z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15 16" width="15" height="16"><path fill-rule="evenodd" d="M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1 3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41 0l4.59-4.59a.996.996 0 000-1.41L7.73 1.73zM2.38 7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59 1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73 4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z"></path></svg>, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 16" width="14" height="16"><path fill-rule="evenodd" d="M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 011.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7z"></path></svg>.
</p>

<ul class="org-ul">
<li>Within <code>octoicon:ùí≥</code> and <code>link-here:ùí≥</code> the label <code>ùí≥</code> determines the
OctoIcon shown and the name of the local link to be created, respectively.
<ul class="org-ul">
<li>Descriptions, as in <code>[[link:label][description]]</code>, are ignored.</li>
</ul></li>
<li>Besides the HTML backend, such links are silently omitted.</li>
</ul>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Six OctoIcons and Implementation
                      </font>
                    </strong>
                  </summary>
<p>
The following SVGs are obtained from: <a href="https://primer.style/octicons/">https://primer.style/octicons/</a>
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span>
 <span style="color: #715ab1;">org-special-block-extras--supported-octoicons</span>
 (<span style="color: #6c3163; font-weight: bold;">-partition</span> 2
 '(
   home
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2d9574;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M16 9l-3-3V2h-2v2L8 1 0 9h2l1 5c0 .55.45 1 1 1h8c.55 0</span>
<span style="color: #2d9574;">   1-.45 1-1l1-5h2zm-4 5H9v-4H7v4H4L2.81 7.69 8 2.5l5.19 5.19L12</span>
<span style="color: #2d9574;">   14z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   <span style="color: #655370; background-color: #fbf8ef;">link</span>
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2d9574;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69</span>
<span style="color: #2d9574;">   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10</span>
<span style="color: #2d9574;">   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0</span>
<span style="color: #2d9574;">   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5</span>
<span style="color: #2d9574;">   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55</span>
<span style="color: #2d9574;">   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   <span style="color: #6c3163; font-weight: bold;">mail</span>
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14</span>
<span style="color: #2d9574;">   16\" width=\"14\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M0 4v8c0 .55.45 1 1 1h12c.55 0 1-.45</span>
<span style="color: #2d9574;">   1-1V4c0-.55-.45-1-1-1H1c-.55 0-1 .45-1 1zm13 0L7 9 1 4h12zM1</span>
<span style="color: #2d9574;">   5.5l4 3-4 3v-6zM2 12l3.5-3L7 10.5 8.5 9l3.5 3H2zm11-.5l-4-3</span>
<span style="color: #2d9574;">   4-3v6z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   report
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16</span>
<span style="color: #2d9574;">   16\" width=\"16\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M0 2a1 1 0 011-1h14a1 1 0 011 1v9a1 1 0 01-1 1H7l-4</span>
<span style="color: #2d9574;">   4v-4H1a1 1 0 01-1-1V2zm1 0h14v9H6.5L4 13.5V11H1V2zm6</span>
<span style="color: #2d9574;">   6h2v2H7V8zm0-5h2v4H7V3z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   tag
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 15</span>
<span style="color: #2d9574;">   16\" width=\"15\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M7.73 1.73C7.26 1.26 6.62 1 5.96 1H3.5C2.13 1 1 2.13 1</span>
<span style="color: #2d9574;">   3.5v2.47c0 .66.27 1.3.73 1.77l6.06 6.06c.39.39 1.02.39 1.41</span>
<span style="color: #2d9574;">   0l4.59-4.59a.996.996 0 000-1.41L7.73 1.73zM2.38</span>
<span style="color: #2d9574;">   7.09c-.31-.3-.47-.7-.47-1.13V3.5c0-.88.72-1.59</span>
<span style="color: #2d9574;">   1.59-1.59h2.47c.42 0 .83.16 1.13.47l6.14 6.13-4.73</span>
<span style="color: #2d9574;">   4.73-6.13-6.15zM3.01 3h2v2H3V3h.01z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>

   clock
   <span style="color: #2d9574;">"&lt;svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14</span>
<span style="color: #2d9574;">   16\" width=\"14\" height=\"16\"&gt;&lt;path fill-rule=\"evenodd\"</span>
<span style="color: #2d9574;">   d=\"M8 8h3v2H7c-.55 0-1-.45-1-1V4h2v4zM7 2.3c3.14 0 5.7 2.56</span>
<span style="color: #2d9574;">   5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 011.3 8c0-3.14 2.56-5.7</span>
<span style="color: #2d9574;">   5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14</span>
<span style="color: #2d9574;">   7-7-3.14-7-7-7z\"&gt;&lt;/path&gt;&lt;/svg&gt;"</span>))

<span style="color: #da8b55;">"An association list of supported OctoIcons.</span>

<span style="color: #da8b55;">Usage: (cadr (assoc 'ICON org-special-block-extras--supported-octoicons))"</span>)
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Show an OctoIcon: home, link, mail, report, tag, clock</span>
(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
  <span style="color: #2d9574;">"octoicon"</span>
  <span style="color: #3a81c3;">:follow</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (_))
  <span style="color: #3a81c3;">:export</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (icon _ backend)
    (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
      (`html  (<span style="color: #6c3163; font-weight: bold;">format</span>
               (<span style="color: #6c3163; font-weight: bold;">s-collapse-whitespace</span>
                (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">assoc</span> (<span style="color: #6c3163; font-weight: bold;">intern</span> icon)
                             <span style="color: #715ab1;">org-special-block-extras--supported-octoicons</span>)))))
      (_ <span style="color: #2d9574;">""</span>))))

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Export a link to the current location in an Org file.</span>
(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
  <span style="color: #2d9574;">"link-here"</span>
  <span style="color: #3a81c3;">:follow</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (path) (<span style="color: #6c3163; font-weight: bold;">message</span> <span style="color: #2d9574;">"This is a local anchor link named &#8220;%s&#8221;"</span> path))
  <span style="color: #3a81c3;">:export</span>  (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label _ backend)
    (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
      (`html  (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #6c3163; font-weight: bold;">s-collapse-whitespace</span>
          <span style="color: #2d9574;">"&lt;a class=\"anchor\" aria-hidden=\"true\" id=\"%s\"</span>
<span style="color: #2d9574;">          href=\"#%s\"&gt;%s&lt;/a&gt;"</span>)
                      label label (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">assoc</span> '<span style="color: #655370; background-color: #fbf8ef;">link</span>
                              <span style="color: #715ab1;">org-special-block-extras--supported-octoicons</span>))))
      (_ <span style="color: #2d9574;">""</span>))))
</pre>
</div>

<p>
Going forward, it would be desirable to provide a non-whitespace alternative for
the LaTeX rendition.  More usefully, before the HTML export hook, we could place
such ‚Äòlink-here‚Äô links before every org-title produce clickable org-headings,
similar to Github's &#x2014;the necessary ingredients are likely <a href="https://github.com/alhassy/emacs.d#ensuring-useful-html-anchors">here</a>.
</p>

<p>
Moreover, it may be useful to have <code>octoicon:ùí≥|url</code> so the resulting
OctoIcon is optionally a link to the given <code>url</code>. Another direction
would be to support more, if not all, the possible OctoIcons.
</p>



</details>


<br>


<div style="column-rule-style: none;column-count: 2;">


<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Source</h3>

link-here:example-location (Click the icon and see the URL has changed!)<br>

</div>


<div style="padding: 1em; background-color: #FFFFCC;border-radius: 15px; font-size: 0.9em; box-shadow: 0.05em 0.1em 5px 0.01em #00000057;"><h3>Result</h3>
<p>
<a class="anchor" aria-hidden="true" id="example-location" href="#example-location"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a> (Click the icon and see the URL has changed!)
</p>

</div>

</div>
</div>
</div>


<div id="outline-container-Tooltips-for-Glossaries-Dictionaries-and-Documentation" class="outline-2">
<h2 id="Tooltips-for-Glossaries-Dictionaries-and-Documentation"><span class="section-number-2">8</span> <a href="#Tooltips-for-Glossaries-Dictionaries-and-Documentation">Tooltips for Glossaries, Dictionaries, and Documentation</a></h2>
<div class="outline-text-2" id="text-Tooltips-for-Glossaries-Dictionaries-and-Documentation">



<p>
Let's make a link type <code>doc</code> that shows a tooltip documentation &#x2014;e.g., glossary
or abbreviation&#x2014; for a given label.
E.g., user-declared <abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr> and Emacs-retrieved <abbr class="tooltip" title="The Common Lisp ‚Äòloop‚Äô macro.<br>Valid clauses include:<br>&emsp;For clauses:<br>&emsp;&emsp;for VAR from<em>upfrom</em>downfrom EXPR1 to<em>upto</em>downto<em>above</em>below EXPR2 [by EXPR3]<br>&emsp;&emsp;for VAR = EXPR1 then EXPR2<br>&emsp;&emsp;for VAR in<em>on</em>in-ref LIST [by FUNC]<br>&emsp;&emsp;for VAR across<em>across-ref ARRAY<br>&emsp;&emsp;for VAR being:<br>&emsp;&emsp;&emsp;the elements of</em>of-ref SEQUENCE [using (index VAR2)]<br>&emsp;&emsp;&emsp;the symbols [of OBARRAY]<br>&emsp;&emsp;&emsp;the hash-keys<em>hash-values of HASH-TABLE [using (hash-values</em>hash-keys V2)]<br>&emsp;&emsp;&emsp;the key-codes<em>key-bindings</em>key-seqs of KEYMAP [using (key-bindings VAR2)]<br>&emsp;&emsp;&emsp;the overlays<em>intervals [of BUFFER] [from POS1] [to POS2]<br>&emsp;&emsp;&emsp;the frames</em>buffers<br>&emsp;&emsp;&emsp;the windows [of FRAME]<br>&emsp;Iteration clauses:<br>&emsp;&emsp;repeat INTEGER<br>&emsp;&emsp;while<em>until</em>always<em>never</em>thereis CONDITION<br>&emsp;Accumulation clauses:<br>&emsp;&emsp;collect<em>append</em>nconc<em>concat</em>vconcat<em>count</em>sum<em>maximize</em>minimize FORM<br>&emsp;&emsp;&emsp;[into VAR]<br>&emsp;Miscellaneous clauses:<br>&emsp;&emsp;with VAR = INIT<br>&emsp;&emsp;if<em>when</em>unless COND CLAUSE [and CLAUSE]... else CLAUSE [and CLAUSE...]<br>&emsp;&emsp;named NAME<br>&emsp;&emsp;initially/finally [do] EXPRS...<br>&emsp;&emsp;do EXPRS...<br>&emsp;&emsp;[finally] return EXPR<br><br>For more details, see Info node ‚Äò(cl)Loop Facility‚Äô.<br><br>(fn CLAUSE...)">loop</abbr> and <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‚Äò-‚Äô got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr> ^_^
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Eye-candy ---A gallery of images
                      </font>
                    </strong>
                  </summary>

<div id="orgdc93d1f" class="figure">
<p><img src="images/tooltips_browser.png" alt="tooltips_browser.png" />
</p>
<p><span class="figure-number">Figure 5: </span>Tooltips for documentation and glossary items &#x2013;in the browser!</p>
</div>


<div id="org0e78a4c" class="figure">
<p><img src="images/tooltips_emacs.png" alt="tooltips_emacs.png" />
</p>
<p><span class="figure-number">Figure 6: </span>Tooltips for documentation and glossary items &#x2013;in Emacs!</p>
</div>


<div id="orge3cce77" class="figure">
<p><img src="images/tooltips_pdf.png" alt="tooltips_pdf.png" />
</p>
<p><span class="figure-number">Figure 7: </span>Tooltips for documentation and glossary items &#x2013;in the PDF!</p>
</div>


</details>

<p>
<b>Full Example: ‚Ä¶</b>
</p>


<p>
<span class="underline">User enters ‚Ä¶</span>
</p>
<pre class="example" id="org4c16e7d">
#+begin_documentation Existential Angst :label "ex-angst"
A negative feeling arising from freedom and responsibility.

Also known as
1. /Existential Dread/, and
2. *Existential Anxiety*.

Perhaps a distraction, such as [[https://www.w3schools.com][visiting W3Schools]], may help ;-)

Then again, ~coding~ can be frustrating at times, maybe have
a slice of pie with maths by reading ‚Äú$e^{i√óœÄ} + 1 = 0$‚Äù as a poem ;-)
#+end_documentation
</pre>





<p>
<span class="underline">Then‚Ä¶</span> <code>doc:ex-angst</code> gives us <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as<br>1. <em>Existential Dread</em>, and<br>2. <strong>Existential Anxiety</strong>.<br><br>Perhaps a distraction, such as visiting W3Schools (https://www.w3schools.com), may help ;-)<br><br>Then again, <code>coding</code> can be frustrating at times, maybe have<br>a slice of pie with maths by reading ‚Äú<em>e^{i√óœÄ} + 1 = 0</em>‚Äù as a poem ;-)">Existential Angst</abbr>,
or using a description: <abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>Also known as<br>1. <em>Existential Dread</em>, and<br>2. <strong>Existential Anxiety</strong>.<br><br>Perhaps a distraction, such as visiting W3Schools (https://www.w3schools.com), may help ;-)<br><br>Then again, <code>coding</code> can be frustrating at times, maybe have<br>a slice of pie with maths by reading ‚Äú<em>e^{i√óœÄ} + 1 = 0</em>‚Äù as a poem ;-)">‚Äúexistence is pain‚Äù?</abbr>
( <code>[[doc:ex-angst][‚Äúexistence is pain‚Äù?]]</code> )
</p>

<blockquote>
<p>
As it stands, Emacs tooltips <b>only</b> appear after an export has happened:
The export updates the dictionary variable which is used for the tooltips
utility.
</p>

<p>
The <code>:label</code> is optional; when not provided it defaults to the name of the entry
with spaces replaced by ‚Äò_‚Äô.  For more, see
<abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‚Äòorg-special-block-extras--docs‚Äô.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ‚Äô(lbl‚ÇÄ lbl‚ÇÅ ‚Ä¶ lbl‚Çô)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‚Äòbox‚Äô block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That‚Äôd require the ‚Äòdoc:ùí≥‚Äô link construction be refactored via a ‚Äòdefun‚Äô.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (LABEL nil) (SHOW nil) (COLOR ''green''))">org-special-block-extras--documentation</abbr>.
</p>

<p>
Entry names do not need to be unique, but labels do!
( The labels are like the addresses used to look up an entry. )
</p>
</blockquote>



<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         More Examples
                      </font>
                    </strong>
                  </summary>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Supported</th>
<th scope="col" class="org-left">Example</th>
<th scope="col" class="org-left">Source</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">No description</td>
<td class="org-left"><abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr></td>
<td class="org-left"><code>doc:cat</code></td>
</tr>

<tr>
<td class="org-left">With description and code font</td>
<td class="org-left"><abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>."><code>polymorphism</code></abbr></td>
<td class="org-left"><code>[[doc:nat-trans][=polymorphism=]]</code></td>
</tr>

<tr>
<td class="org-left">Fallback; e.g., arbitrary ELisp Docs</td>
<td class="org-left"><abbr class="tooltip" title="Thread FORMS elements as the first argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-first<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ (- (</em> (+ 5 20) 25)) 40)<br>Note how the single ‚Äò-‚Äô got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-first</abbr></td>
<td class="org-left"><code>doc:thread-first</code></td>
</tr>
</tbody>
</table>

<p>
Notice how hovering over items makes them appear, but to make them disappear you
should click on them or scroll away.  This is ideal when one wants to have
multiple ‚Äòdefinitions‚Äô visible ;-)
</p>

<p>
Below are the entries in my personal glossary ;-)
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">("<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="Natural transformations are essentially polymorphic functions that make <em>no</em><br>choices according to the input type; e.g., <code>reverse : List œÑ ‚Üí List œÑ</code> makes no<br>choices depending on the type <code>œÑ</code>.">Natural Transformation</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A story whose events have smooth transitions connecting them.<br><br>A proof wherein each step is connected to the next step by an explicit<br>justification.">Calculational Proof</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="There are two ways to read this phrase.<br><br>Algorithmic-problem solving is about solving problems that<br>involve the construction of an algorithm for their solution.<br><br>Algorithmic problem-solving is about problem solving in general,<br>using the principles of correct-by-construction algorithm-design.">Algorithmic Problem Solving</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A ‚Äòvariable‚Äô or a ‚Äòfunction application‚Äô; i.e., the name of a function along<br>with a number of existing expressions.<br><br>In a sense, an expression is like a sentence with the variables acting as<br>pronouns and the function applications acting as verb clauses and the argument<br>to the application are the participants in the action of the verbal clause.">Expression</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A specification is an equation of a certain shape.<br> <em>Programming</em> is the activity of solving a specification<br> for its unknown. Its unknown is called a <em>program</em>.<br><br> See also ‚ÄúProgramming‚Äù.">Specification</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="Programming is solving the equation <em>R ‚áí[C] G</em> in the unknown <em>C</em>; i.e., it is the<br>activity of finding a ‚Äòrecipe‚Äô that satisfies a given specification. Sometimes<br>we may write <em>R ‚áí[?] G</em> and solve for ‚Äò?‚Äô. Programming is a goal-directed activity: From a specification, a program is found by examining the shape of its postcondition.">Programming</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="An operation ‚äó distributes over ‚äï when they satisfy<br>‚Äúleft-distributivity‚Äù <em>x ‚äó (y ‚äï z) = (x ‚äó y) ‚äï (x ‚äó y)</em><br>and<br>‚Äúright-distributivity‚Äù <em>(y ‚äï z) ‚äó x = (y ‚äó x) ‚äï (z ‚äó x)</em>.<br><br>When ‚äï = ‚äó, one says that the operation is ‚Äúself-distributive‚Äù.<br><br>Distributivity can be viewed in two ways, much like distributivity of<br>multiplication √ó over addition +. Replacing the left side by the right side<br>could be called ‚Äúmultiplying out‚Äù; replacing the right side by the left side,<br>‚Äúfactoring‚Äù.">Distributive</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ has identity ùë∞ when it satisfies <em>ùë∞ ‚äï x = x = x ‚äï ùë∞</em>.<br><br>If it satisfies only the first equation, <em>ùë∞ ‚äï x = x</em>, one says<br>that ‚Äúùë∞ is a left-identity for ‚äï‚Äù. If it satisfies only the second<br>equation, <em>x ‚äï ùë∞ = x</em>, one says that ‚Äúùë∞ is a right-identity for ‚äï‚Äù.<br><br>For example, implication only has a left identity, <em>(false ‚áí x) = x</em>, and<br>subtraction only has a right identity, <em>(x - 0) = x</em>.<br><br>An identity implies that occurrences of ‚Äú‚äï ùë∞‚Äù and ‚Äúùë∞ ‚äï‚Äù in an expression are<br>redundant. Thus, <em>x ‚äï ùë∞</em> may be replaced by <em>x</em> in any expression without<br>changing the value of the expression. Therefore, we usually eliminate such<br>occurrences unless something encourages us to leave them in.">Identity</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="An operation _‚äï_ is associative when it satisfies <em>(p ‚äï q) ‚äï r = p ‚äï (q ‚äï r)</em>.<br><br>Associativity allows us to be informal and insert or delete pairs of<br>parentheses in sequences of ‚äï's, just as we do with sequences of<br>additions ---e.g., <em>a + b + c + d</em> is equivalent to <em>a + (b + c) + d</em>.<br><br>Hence, we can write <em>p ‚äï q ‚äï r</em> instead of <em>(p ‚äï q) ‚äï r</em> or <em>p ‚äï (q ‚äï r)</em>.<br><br>When an operation is associative, it is best to avoid ‚Äúmaking a choice‚Äù of how<br>sequences of ‚äï should be read, by using parentheses ---unless to make things<br>clear or explicit for manipulation.<br><br>--------------------------------------------------------------------------------<br><br>More generally, for any two operations _‚äï_ and _‚äû_, the ‚Äú(left to right) mutual<br>associativity of ‚äï and ‚äû‚Äù is the property <em>(x ‚äï y) ‚äû z = x ‚äï (y ‚äû z)</em>. It allows<br>us to omit parentheses in mixed sequences of ‚äï and ‚äû. For instance, addition and<br>subtraction are (left to right) mutually associative.">Associative</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="Often operations are defined by how they are evaluated (‚Äúoperationally‚Äù), we<br>take the alternative route of defining operations by how they can be manipulated<br>(‚Äúaxiomatically‚Äù); i.e., by what properties they satisfy.<br><br>For instance, we may define basic manipulative properties of operators ---i.e.,<br><em>axioms</em>--- by considering how the operators behave operationally on particular<br>expressions. That is, one may use an operational, intuitive, approach to obtain<br>an axiomatic specification (characterisation, interface) of the desired<br>properties.<br><br>More concretely, since <em>(p ‚â° q) ‚â° r</em> and <em>p ‚â° (q ‚â° r)</em> evaluate to<br>the same value for any choice of values for <em>p, q, r</em>, we may insist that a part<br>of the definition of equivalence is that it be an associative operation.<br><br>Sometimes a single axiom is not enough to ‚Äòpin down‚Äô a unique operator ---i.e.,<br>to ensure we actually have a well-defined operation--- and other times this is<br>cleanly possible; e.g., given an ordering ‚Äò‚â§‚Äô(‚Äò‚áí, ‚äÜ, ‚äë‚Äô) we can define minima<br>‚Äò‚Üì‚Äô (‚Äò‚àß, ‚à©, ‚äì‚Äô) by the axiom: ‚Äúx ‚Üì y is the greatest lower bound‚Äù; i.e., <em>z ‚â§ x<br>‚Üì y &#x2000;‚â°&#x2000; z ‚â§ x &#8194;‚àß&#8194; z ‚â§ y</em>.">Semantics</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A <em>calculus</em> is a method or process of reasoning by calculation<br>with symbols. A <em>propositional calculus</em> is a method of calculating with Boolean<br>(or propositional) expressions.">Calculus</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> in the technical sense is an expression derived<br>from axioms using inference rules.<br><br>A <em>metatheorem</em> is a general <strong>statement</strong> about a logic that<br>one argues to be <strong>true</strong>.<br><br>For instance, ‚Äúany two theorems are equivalent‚Äù is a statement that speaks about<br>expressions which happen to be theorems. A logic may not have the linguistic<br>capability to speak of its own expressions and so the statement may not be<br>expressible as an expression <strong>within</strong> the logic ---and so cannot be a theorem of<br>the logic.<br><br>For instance, the logic ùíëùëû has expressions formed from the symbols ‚Äúùíë‚Äù, ‚Äúùíí‚Äù, and<br>‚Äú-‚Äù (dash). It has the axiom schema <em>xùíë-ùííx-</em> and the rule ‚ÄúIf <em>xùíëyùííz</em> is a theorem<br>then so is <em>x-ùíëy-ùííz-</em>‚Äù. Notice that <em>x, y, z</em> are <em>any</em> strings of dashes;<br>the language of this logic does not have variables and so cannot even speak<br>of its own expressions, let alone its own theorems!<br><br>[Informal] theorems about [technical, logic-specific] theorems are thus termed<br>‚Äòmetatheorems‚Äô.">Metatheorem</abbr>" "<abbr class="tooltip" title="A negative feeling arising from freedom and responsibility.<br><br>bye">Existential Angsty</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>" "<abbr class="tooltip" title="A <em>theorem</em> is a syntactic object, a string of symbols with a particular property.<br><br>A <em>theorem</em> of a calculus is either an axiom or the conclusion of an inference<br>rule whose premises are theorems.<br><br>Different axioms could lead to the same set of theorems, and many texts use<br>different axioms.">Theorem</abbr>")</td>
</tr>
</tbody>
</table>

<p>
In the export, it looks like some names are repeated, but in the source one
would notice that we have <i>labels</i> in both upper and lower cases and with underscores ;-)
They just happen to be referring to the same <i>named</i> entry.
</p>


</details>
</div>


<div id="outline-container-The-doc-link-type" class="outline-3">
<h3 id="The-doc-link-type"><span class="section-number-3">8.1</span> <a href="#The-doc-link-type">Implementation Details: <code>doc</code> link, <code>documentation</code> block, and <a href="https://iamceege.github.io/tooltipster/#triggers">tooltipster</a></a></h3>
<div class="outline-text-3" id="text-The-doc-link-type">
<p>
We begin by making use of a list of documentation-glossary entries
&#x2014;a lightweight database of information, if you will.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--docs</span> nil
  <span style="color: #da8b55;">"An alist of (label name description) entries; our glossary.</span>

<span style="color: #da8b55;">Example use: (-let [(name description) (cdr (assoc 'label docs))] &#8943;)"</span>)
</pre>
</div>

<p>
For example, we may use <code>add-to-list</code> to add an entry only if it is not already in
the list.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org16ed7cc">(<span style="color: #6c3163; font-weight: bold;">add-to-list</span> '<span style="color: #715ab1;">org-special-block-extras--docs</span>
  '(<span style="color: #2d9574;">"cat"</span> <span style="color: #2d9574;">"Category Theory"</span> <span style="color: #2d9574;">"A theory of typed  composition; e.g., typed monoids."</span>))
</pre>
</div>

<p>
We may wish to use Emacs' <code>documentation</code> command to retrieve entries &#x2014;this is
useful for an online article that refers to unfamiliar Emacs terms ;-) To avoid
copy-pasting documentation entries from one location to another, users may
declare a fallback method. Besides Emacs' <code>documentation</code>, the fallback can be
refer to a user's personal ‚Äòglobal glossary‚Äô variable &#x2014;which may live in their
Emacs' init file&#x2014;, for more see: <abbr class="tooltip" title="Load user‚Äôs personal documentation libraries.<br><br>If no LIBS are provided, simply use those declared<br>org-special-block-extras--docs-libraries.<br><br>See org-special-block-extras--docs-from-libraries.<br><br>(fn &optional (LIBS org-special-block-extras--docs-libraries))">org-special-block-extras-docs-load-libraries</abbr>
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--docs-fallback</span>
  (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label) (<span style="color: #6c3163; font-weight: bold;">list</span> label label (<span style="color: #6c3163; font-weight: bold;">documentation</span> (<span style="color: #6c3163; font-weight: bold;">intern</span> label))))
  <span style="color: #da8b55;">"The fallback method to retriving documentation or glossary entries."</span>)
</pre>
</div>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation matter for user libraries
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--docs-libraries</span> nil
  <span style="color: #da8b55;">"List of Org files that have &#8216;#+begin_documentation&#8217; blocks that should be loaded</span>
<span style="color: #da8b55;">   for use with the &#8216;</span><span style="color: #4e3163;">doc:&#119987;</span><span style="color: #da8b55;">&#8217; link type."</span>)
</pre>
</div>

<p>
In your init, you could do the following. ( See the installation instructions
below, for more! )
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org1889985">(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--docs-libraries</span>
  '(<span style="color: #2d9574;">"documentation.org"</span>))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">cl-defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras-docs-load-libraries</span>
    (<span style="color: #ba2f59; font-weight: bold;">&amp;optional</span> (libs <span style="color: #715ab1;">org-special-block-extras--docs-libraries</span>))
<span style="color: #da8b55;">"Load user's personal documentation libraries.</span>

<span style="color: #da8b55;">If no LIBS are provided, simply use those declared</span>
<span style="color: #da8b55;">org-special-block-extras--docs-libraries.</span>

<span style="color: #da8b55;">See org-special-block-extras--docs-from-libraries.</span>
<span style="color: #da8b55;">"</span>
(<span style="color: #3a81c3; font-weight: bold;">interactive</span>)
(<span style="color: #3a81c3; font-weight: bold;">loop</span> for lib in libs
      <span style="color: #6c3163; font-weight: bold;">do</span> (<span style="color: #3a81c3; font-weight: bold;">with-temp-buffer</span>
           (<span style="color: #6c3163; font-weight: bold;">insert-file-contents</span> lib)
           <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">doc only activates after an export</span>
           (<span style="color: #3a81c3; font-weight: bold;">-let</span> [<span style="color: #715ab1;">org-export-with-broken-links</span> <span style="color: #715ab1;">t</span>] (<span style="color: #6c3163; font-weight: bold;">org-html-export-as-html</span>))
           (<span style="color: #6c3163; font-weight: bold;">kill-buffer</span>)
           (<span style="color: #6c3163; font-weight: bold;">delete-window</span>)
           (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--docs-from-libraries</span> (<span style="color: #6c3163; font-weight: bold;">-concat</span> <span style="color: #715ab1;">org-special-block-extras--docs</span> <span style="color: #715ab1;">org-special-block-extras--docs-from-libraries</span>))
           (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--docs</span> nil))))

(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--docs-from-libraries</span> nil

  <span style="color: #da8b55;">"The alist of (label name description) entries loaded from the libraries.</span>

<span style="color: #da8b55;">The initial value &#8216;</span><span style="color: #4e3163;">-1</span><span style="color: #da8b55;">&#8217; is used to indicate that no libraries have been loaded.</span>
<span style="color: #da8b55;">The &#8216;</span><span style="color: #4e3163;">doc:&#119987;</span><span style="color: #da8b55;">&#8217; link will load the libraries, possibly setting this variable to &#8216;</span><span style="color: #4e3163;">nil</span><span style="color: #da8b55;">&#8217;,</span>
<span style="color: #da8b55;">then make use of this variable when looking for documentation strings.</span>

<span style="color: #da8b55;">Interactively call org-special-block-extras-docs-load-libraries</span>
<span style="color: #da8b55;">to force your documentation libraries to be reloaded.</span>

<span style="color: #da8b55;">See also org-special-block-extras--docs-libraries.</span>
<span style="color: #da8b55;">"</span>)
</pre>
</div>

<p>
When the mode is actually enabled, then we load the user's libraries.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Ensure user's documentation libraries have loaded</span>
(<span style="color: #6c3163; font-weight: bold;">org-special-block-extras-docs-load-libraries</span>)
</pre>
</div>



</details>


<p>
Let's keep track of where documentation comes from &#x2014;either the current
article or from the fallback&#x2014; so that we may process it later on.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--docs-GLOSSARY</span> nil
  <span style="color: #da8b55;">"Which words are actually cited in the current article.</span>

<span style="color: #da8b55;">We use this listing to actually print a glossary using</span>
<span style="color: #da8b55;">&#8216;</span><span style="color: #4e3163;">show:GLOSSARY</span><span style="color: #da8b55;">&#8217;."</span>)
</pre>
</div>

<p>
Now HTML exporting such links as tooltips and displaying them in Emacs as
tooltips happens in two stages: First we check the documentation, if there is no
entry, we try the fallback &#x2014;if that falls, an error is reported at export
time. E.g., upon export <code>doc:wombo</code> will produce a no-entry error.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‚Äòdoc‚Äô link implementation
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org7c8abf5">(<span style="color: #3a81c3; font-weight: bold;">-let</span> [name&amp;doc
       (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (lbl)
         <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Look for &#8216;</span><span style="color: #4e3163; background-color: #ecf3ec;">lbl</span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8217; from within the current buffer first, otherwise look among the loaded libraries.</span>
         (<span style="color: #3a81c3; font-weight: bold;">-let</span> [(_ name doc) (<span style="color: #3a81c3; font-weight: bold;">or</span> (<span style="color: #6c3163; font-weight: bold;">assoc</span> lbl <span style="color: #715ab1;">org-special-block-extras--docs</span>) (<span style="color: #6c3163; font-weight: bold;">assoc</span> lbl <span style="color: #715ab1;">org-special-block-extras--docs-from-libraries</span>))]
           <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">If there is no documentation, try the fallback.</span>
           (<span style="color: #3a81c3; font-weight: bold;">unless</span> doc
             (<span style="color: #3a81c3; font-weight: bold;">setq</span> doc
                   (<span style="color: #3a81c3; font-weight: bold;">condition-case</span> nil
                       (<span style="color: #6c3163; font-weight: bold;">funcall</span> <span style="color: #715ab1;">org-special-block-extras--docs-fallback</span> lbl)
                     (<span style="color: #dc752f; background-color: #fbf8ef;">error</span>
                      (<span style="color: #dc752f; background-color: #fbf8ef;">error</span> <span style="color: #2d9574;">"Error: No documentation-glossary entry for &#8220;%s&#8221;!"</span>
                             lbl))))
             (<span style="color: #3a81c3; font-weight: bold;">setq</span> name (<span style="color: #6c3163; font-weight: bold;">nth</span> 1 doc))
             (<span style="color: #3a81c3; font-weight: bold;">setq</span> doc (<span style="color: #6c3163; font-weight: bold;">nth</span> 2 doc)))
           (<span style="color: #6c3163; font-weight: bold;">list</span> name doc)))]

(<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
 <span style="color: #2d9574;">"doc"</span>
 <span style="color: #3a81c3;">:follow</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (_) ())
 <span style="color: #3a81c3;">:export</span>
   `(<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label description backend)
     (<span style="color: #3a81c3; font-weight: bold;">-let</span> [(name docs) (<span style="color: #6c3163; font-weight: bold;">funcall</span> ,name&amp;doc label)]
       (<span style="color: #6c3163; font-weight: bold;">add-to-list</span> '<span style="color: #715ab1;">org-special-block-extras--docs-GLOSSARY</span>
                    (<span style="color: #6c3163; font-weight: bold;">list</span> label name docs))
       (<span style="color: #3a81c3; font-weight: bold;">setq</span> name (<span style="color: #3a81c3; font-weight: bold;">or</span> description name))
       (<span style="color: #3a81c3; font-weight: bold;">pcase</span> backend
         (`html  (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"&lt;abbr class=\"tooltip\" title=\"%s\"&gt;%s&lt;/abbr&gt;"</span>
                         <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Make it look pretty!</span>
                         (<span style="color: #3a81c3; font-weight: bold;">thread-last</span> docs
                           (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"  "</span> <span style="color: #2d9574;">"&amp;emsp;"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Preserve newlines</span>
                           (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"\n"</span> <span style="color: #2d9574;">"&lt;br&gt;"</span>)   <span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Preserve whitespace</span>
                           <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Translate Org markup</span>
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"/</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.+?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">/"</span> <span style="color: #2d9574;">"&lt;em&gt;\\1&lt;/em&gt;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\*</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.+?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">\\*"</span> <span style="color: #2d9574;">"&lt;strong&gt;\\1&lt;/strong&gt;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\~</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">[</span><span style="color: #4e3163;">^</span><span style="color: #2d9574;"> ].*?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">\\~"</span> <span style="color: #2d9574;">"&lt;code&gt;\\1&lt;/code&gt;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"=</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">[</span><span style="color: #4e3163;">^</span><span style="color: #2d9574;"> ].*?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">="</span> <span style="color: #2d9574;">"&lt;code&gt;\\1&lt;/code&gt;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\$</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.+?</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">\\$"</span> <span style="color: #2d9574;">"&lt;em&gt;\\1&lt;/em&gt;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\[\\[</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.*</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">\\]\\[</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">(</span><span style="color: #2d9574;">.*</span><span style="color: #2d9574; font-weight: bold;">\\</span><span style="color: #2d9574; font-weight: bold;">)</span><span style="color: #2d9574;">\\]\\]"</span> <span style="color: #2d9574;">"\\2 (\\1)"</span>)
                           <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Spacing in math mode</span>
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\\\quad"</span> <span style="color: #2d9574;">"&amp;#x2000;"</span>)
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\\\,"</span> <span style="color: #2d9574;">"&amp;#8194;"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">en space</span>
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\\\;"</span> <span style="color: #2d9574;">"&amp;#8195;"</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">em space</span>
                           <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">The presence of &#8216;\"&#8217; in tooltips breaks things, so omit them.</span>
                           (<span style="color: #6c3163; font-weight: bold;">s-replace-regexp</span> <span style="color: #2d9574;">"\\\""</span> <span style="color: #2d9574;">"''"</span>))
                         name))
         <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Make the current word refer to its glosary entry;</span>
         <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">also declare the location that the glossary should refer back to.</span>
         (`latex (<span style="color: #6c3163; font-weight: bold;">format</span> (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"\\hyperref"</span>
                                 <span style="color: #2d9574;">"[org-special-block-extras-glossary-%s]{%s}"</span>
                                <span style="color: #2d9574;">"\\label{org-special-block-extras-glossary"</span>
                                <span style="color: #2d9574;">"-declaration-site-%s}"</span>)
                         label name label)))))
  <span style="color: #3a81c3;">:help-echo</span>
  `(<span style="color: #3a81c3; font-weight: bold;">lambda</span> (_ __ <span style="color: #6c3163; font-weight: bold;">position</span>)
    (<span style="color: #3a81c3; font-weight: bold;">save-excursion</span>
      (<span style="color: #6c3163; font-weight: bold;">goto-char</span> <span style="color: #6c3163; font-weight: bold;">position</span>)
      (<span style="color: #3a81c3; font-weight: bold;">-let*</span> (((<span style="color: #ba2f59; font-weight: bold;">&amp;plist</span> <span style="color: #3a81c3;">:path</span>) (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">org-element-context</span>)))
              ((name doc) (<span style="color: #6c3163; font-weight: bold;">funcall</span> ,name&amp;doc path)))
        (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"[%s] %s :: %s"</span> path name doc))))))
</pre>
</div>

<p>
Since tooltips are not clickable and do not support MathJax,
we have manually transpiled what are perhaps the most common
instances of Org-markup: Bold, emphasises, code/verbatim, math, and links.
</p>


</details>


<p>
Things look great at the HTML side and on the Emacs side for <b>consuming</b>
documented text.  Besides being inconvenient, we cannot with good conscious
force the average user to write Lisp as we did for the <code>doc:cat</code> entry. We turn to
the problem of <b>producing</b> documentation entries with a block type interface&#x2026;
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         ‚Äòdocumentation‚Äô Implementation: An Example of Mandatory Arguments and Using ‚Äòraw-contents‚Äô
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">org-special-block-extras--defblock</span> <span style="color: #6c3163; font-weight: bold;">documentation</span>
  (name (<span style="color: #dc752f; background-color: #fbf8ef;">error</span> <span style="color: #2d9574;">"Documentation block: Name must be provided"</span>))
  (label nil show nil color <span style="color: #2d9574;">"green"</span>)
  <span style="color: #2d9574;">"Register the dictionary entries in CONTENTS to the dictionary variable.</span>

<span style="color: #2d9574;">The dictionary variable is &#8216;</span><span style="color: #4e3163;">org-special-block-extras--docs</span><span style="color: #2d9574;">&#8217;.</span>

<span style="color: #2d9574;">A documentation entry may have its LABEL, its primary identifier,</span>
<span style="color: #2d9574;">be:</span>
<span style="color: #2d9574;">1. Omitted</span>
<span style="color: #2d9574;">2. Given as a single symbol</span>
<span style="color: #2d9574;">3. Given as a many aliases '(lbl&#8320; lbl&#8321; &#8230; lbl&#8345;)</span>

<span style="color: #2d9574;">The third case is for when there is no canonical label to refer to</span>
<span style="color: #2d9574;">an entry, or it is convenient to use multiple labels for the same</span>
<span style="color: #2d9574;">entry.</span>

<span style="color: #2d9574;">In all of the above cases, two additional labels are included:</span>
<span style="color: #2d9574;">The entry name with spaces replaced by underscores, and again but</span>
<span style="color: #2d9574;">all lower case.</span>

<span style="color: #2d9574;">Documentation blocks are not shown upon export;</span>
<span style="color: #2d9574;">unless SHOW is non-nil, in which case they are shown</span>
<span style="color: #2d9574;">using the &#8216;</span><span style="color: #4e3163;">box</span><span style="color: #2d9574;">&#8217; block, with the provided COLOR passed to it.</span>

<span style="color: #2d9574;">In the futture, it may be nice to have an option to render tooltips.</span>
<span style="color: #2d9574;">That'd require the &#8216;</span><span style="color: #4e3163;">doc:&#119987;</span><span style="color: #2d9574;">&#8217; link construction be refactored via a &#8216;</span><span style="color: #4e3163;">defun</span><span style="color: #2d9574;">&#8217;."</span>
  (<span style="color: #3a81c3; font-weight: bold;">unless</span> (<span style="color: #6c3163; font-weight: bold;">consp</span> label) (<span style="color: #3a81c3; font-weight: bold;">setq</span> label (<span style="color: #6c3163; font-weight: bold;">list</span> label)))
  (<span style="color: #3a81c3; font-weight: bold;">push</span> (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">" "</span> <span style="color: #2d9574;">"_"</span> name) label)
  (<span style="color: #3a81c3; font-weight: bold;">push</span> (<span style="color: #6c3163; font-weight: bold;">downcase</span> (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">" "</span> <span style="color: #2d9574;">"_"</span> name)) label)
  (<span style="color: #3a81c3; font-weight: bold;">loop</span> for l in label
        <span style="color: #6c3163; font-weight: bold;">do</span>  (<span style="color: #6c3163; font-weight: bold;">add-to-list</span> '<span style="color: #715ab1;">org-special-block-extras--docs</span>
                         (<span style="color: #6c3163; font-weight: bold;">mapcar</span> #'<span style="color: #6c3163; font-weight: bold;">s-trim</span> (<span style="color: #6c3163; font-weight: bold;">list</span> (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"%s"</span> l) name (<span style="color: #6c3163; font-weight: bold;">substring-no-properties</span> raw-contents)))))
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Should the special block show something upon export?</span>
  <span style="color: #2d9574;">""</span>)<span style="color: #2aa1ae; background-color: #ecf3ec;">; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">(if show (org-special-block-extras--blockcall box name :background-color color raw-contents) "")</span>
</pre>
</div>



</details>


<p>
Thus far, Org entities are converted into HTML tags such as <code>&lt;i&gt;</code> for italicised
text. However, HTML's default tooltip utility &#x2014;using <code>title="‚ãØ"</code> in a <code>div</code>&#x2014;
does not render arbitrary HTML elements. Moreover, the default tooltip utility
is rather slow. As such, we move to using <i>tooltipster</i>.  The incantation below
sets up the required magic to make this happen.
</p>


<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Fast, Sleek, and Beautiful Tooltips: Touching ‚Äòorg-html-head-extra‚Äô
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defvar</span> <span style="color: #715ab1;">org-special-block-extras--tooltip-html-setup</span> nil
  <span style="color: #da8b55;">"Has the necessary HTML beeen added?"</span>)

(<span style="color: #3a81c3; font-weight: bold;">unless</span> <span style="color: #715ab1;">org-special-block-extras--tooltip-html-setup</span>
  (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--tooltip-html-setup</span> <span style="color: #715ab1;">t</span>)
(<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-html-head-extra</span>
 (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #715ab1;">org-html-head-extra</span>
<span style="color: #2d9574;">"</span>
<span style="color: #2d9574;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/tooltipster.bundle.min.css\"/&gt;</span>

<span style="color: #2d9574;">&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-punk.min.css\" /&gt;</span>

<span style="color: #2d9574;">&lt;script type=\"text/javascript\"&gt;</span>
<span style="color: #2d9574;">    if (typeof jQuery == 'undefined') {</span>
<span style="color: #2d9574;">        document.write(unescape('%3Cscript src=\"https://code.jquery.com/jquery-1.10.0.min.js\"%3E%3C/script%3E'));</span>
<span style="color: #2d9574;">    }</span>
<span style="color: #2d9574;">&lt;/script&gt;</span>

<span style="color: #2d9574;"> &lt;script type=\"text/javascript\"            src=\"https://alhassy.github.io/org-special-block-extras/tooltipster/dist/js/tooltipster.bundle.min.js\"&gt;&lt;/script&gt;</span>

<span style="color: #2d9574;">  &lt;script&gt;</span>
<span style="color: #2d9574;">         $(document).ready(function() {</span>
<span style="color: #2d9574;">             $('.tooltip').tooltipster({</span>
<span style="color: #2d9574;">                 theme: 'tooltipster-punk',</span>
<span style="color: #2d9574;">                 contentAsHTML: true,</span>
<span style="color: #2d9574;">                 animation: 'grow',</span>
<span style="color: #2d9574;">                 delay: [100,500],</span>
<span style="color: #2d9574;">                 // trigger: 'click'</span>
<span style="color: #2d9574;">                 trigger: 'custom',</span>
<span style="color: #2d9574;">                 triggerOpen: {</span>
<span style="color: #2d9574;">                     mouseenter: true</span>
<span style="color: #2d9574;">                 },</span>
<span style="color: #2d9574;">                 triggerClose: {</span>
<span style="color: #2d9574;">                     originClick: true,</span>
<span style="color: #2d9574;">                     scroll: true</span>
<span style="color: #2d9574;">                 }</span>
<span style="color: #2d9574;"> });</span>
<span style="color: #2d9574;">         });</span>
<span style="color: #2d9574;">     &lt;/script&gt;</span>

<span style="color: #2d9574;">&lt;style&gt;</span>
<span style="color: #2d9574;">   abbr {color: red;}</span>

<span style="color: #2d9574;">   .tooltip { border-bottom: 1px dotted #000;</span>
<span style="color: #2d9574;">              color:red;</span>
<span style="color: #2d9574;">              text-decoration: none;}</span>
<span style="color: #2d9574;">&lt;/style&gt;</span>
<span style="color: #2d9574;">"</span>)))
</pre>
</div>

<p>
Note that we have a conditional in the middle to avoid loading jQuery multiple
times &#x2014;e.g., when one uses the <code>read-the-org</code> them in combination with this
library. Multiple imports lead to broken features.
</p>


</details>
</div>
</div>


<div id="outline-container-hola" class="outline-3">
<h3 id="hola"><span class="section-number-3">8.2</span> <a href="#hola">Wait, what about the LaTeX?</a></h3>
<div class="outline-text-3" id="text-hola">
<p>
A PDF is essentially a fancy piece of paper, so tooltips will take on the
form of glossary entries: Using <code>doc:ùí≥</code> will result in the word <code>ùí≥</code> being printed
as a hyperlink to a glossary entry, which you the user will eventually
declare using <code>show:GLOSSARY</code>; moreover, the glossary entry will also have a
link back to where the <code>doc:ùí≥</code> was declared.
E.g., <abbr class="tooltip" title="Define NAME as a macro.<br>When the macro is called, as in (NAME ARGS...),<br>the function (lambda ARGLIST BODY...) is applied to<br>the list ARGS... as it appears in the expression,<br>and the result should be a form to be evaluated instead of the original.<br>DECL is a declaration, optional, of the form (declare DECLS...) where<br>DECLS is a list of elements of the form (PROP . VALUES).&emsp;These are<br>interpreted according to ‚Äòmacro-declarations-alist‚Äô.<br>The return value is undefined.<br><br>(fn NAME ARGLIST &optional DOCSTRING DECL &rest BODY)">defmacro</abbr> and <abbr class="tooltip" title="Return an anonymous function.<br>Under dynamic binding, a call of the form (lambda ARGS DOCSTRING<br>INTERACTIVE BODY) is self-quoting; the result of evaluating the<br>lambda expression is the expression itself.&emsp;Under lexical<br>binding, the result is a closure.&emsp;Regardless, the result is a<br>function, i.e., it may be stored as the function value of a<br>symbol, passed to ‚Äòfuncall‚Äô or ‚Äòmapcar‚Äô, etc.<br><br>ARGS should take the same form as an argument list for a ‚Äòdefun‚Äô.<br>DOCSTRING is an optional documentation string.<br> If present, it should describe how to call the function.<br> But documentation strings are usually not useful in nameless functions.<br>INTERACTIVE should be a call to the function ‚Äòinteractive‚Äô, which see.<br>It may also be omitted.<br>BODY should be a list of Lisp expressions.<br><br>(fn ARGS [DOCSTRING] [INTERACTIVE] BODY)">lambda</abbr>.
</p>

<p>
We make a <code>show:ùí≥</code> link type to print the value of the variable <code>ùí≥</code>
as follows, with <code>GLOSSARY</code> being a reserved name.
</p>

<details class="code-details"
                 style ="padding: 1em;
                          background-color: #e5f5e5;
                          /* background-color: pink; */
                          border-radius: 15px;
                          color: hsl(157 75%);
                          font-size: 0.9em;
                          box-shadow: 0.05em 0.1em 5px 0.01em  #00000057;">
                  <summary>
                    <strong>
                      <font face="Courier" size="3" color="green">
                         Implementation of ‚Äòshow‚Äô
                      </font>
                    </strong>
                  </summary>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">let</span> ((whatdo (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (x)
                (<span style="color: #6c3163; font-weight: bold;">message</span>
                          (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"The value of variable  %s  will be placed "</span>
                                  <span style="color: #2d9574;">"here literally upon export, "</span>
                                  <span style="color: #2d9574;">"which is: \n\n %s"</span>)
                          (<span style="color: #6c3163; font-weight: bold;">s-upcase</span> x)
                          (<span style="color: #3a81c3; font-weight: bold;">if</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> x <span style="color: #2d9574;">"GLOSSARY"</span>)
                              (<span style="color: #6c3163; font-weight: bold;">format</span> <span style="color: #2d9574;">"A cleaned up presentation of ...\n%s"</span>
                                      <span style="color: #715ab1;">org-special-block-extras--docs-GLOSSARY</span>)
                          (<span style="color: #6c3163; font-weight: bold;">pp</span> (<span style="color: #6c3163; font-weight: bold;">eval</span> (<span style="color: #6c3163; font-weight: bold;">intern</span> x))))))))
  (<span style="color: #6c3163; font-weight: bold;">org-link-set-parameters</span>
    <span style="color: #2d9574;">"show"</span>
    <span style="color: #3a81c3;">:face</span> '(<span style="color: #3a81c3;">:underline</span> <span style="color: #2d9574;">"green"</span>)
    <span style="color: #3a81c3;">:follow</span> whatdo
    <span style="color: #3a81c3;">:help-echo</span> `(<span style="color: #3a81c3; font-weight: bold;">lambda</span> (_ __ <span style="color: #6c3163; font-weight: bold;">position</span>)
                  (<span style="color: #3a81c3; font-weight: bold;">save-excursion</span>
                    (<span style="color: #6c3163; font-weight: bold;">goto-char</span> <span style="color: #6c3163; font-weight: bold;">position</span>)
                    (<span style="color: #3a81c3; font-weight: bold;">-let</span> [(<span style="color: #ba2f59; font-weight: bold;">&amp;plist</span> <span style="color: #3a81c3;">:path</span>) (<span style="color: #6c3163; font-weight: bold;">cadr</span> (<span style="color: #6c3163; font-weight: bold;">org-element-context</span>))]
                      (<span style="color: #6c3163; font-weight: bold;">funcall</span> ,whatdo path))))
    <span style="color: #3a81c3;">:export</span>
     (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (label _description backend)
      (<span style="color: #3a81c3; font-weight: bold;">cond</span> ((<span style="color: #6c3163; font-weight: bold;">not</span> (<span style="color: #6c3163; font-weight: bold;">equal</span> label <span style="color: #2d9574;">"GLOSSARY"</span>)) (<span style="color: #6c3163; font-weight: bold;">prin1</span> (<span style="color: #6c3163; font-weight: bold;">eval</span> (<span style="color: #6c3163; font-weight: bold;">intern</span> label))))
            ((<span style="color: #6c3163; font-weight: bold;">equal</span> 'html backend) <span style="color: #2d9574;">""</span>) <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Do not print glossary in HTML</span>
            (<span style="color: #715ab1;">t</span>
             (<span style="color: #3a81c3; font-weight: bold;">-let</span> ((fstr (<span style="color: #6c3163; font-weight: bold;">concat</span> <span style="color: #2d9574;">"\\vspace{1em}\\phantomsection"</span>
                                 <span style="color: #2d9574;">"\\textbf{%s}\\quad"</span>
                                 <span style="color: #2d9574;">"\\label{org-special-block-extras-glossary-%s}"</span>
                                 <span style="color: #2d9574;">"%s See page "</span>
                                 <span style="color: #2d9574;">"\\pageref{org-special-block-extras"</span>
                                 <span style="color: #2d9574;">"-glossary-declaration-site-%s}"</span>))
                    (preserve <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">preserve whitespace</span>
                     (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (x)
                       (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"\n"</span> <span style="color: #2d9574;">" \\newline{\\color{white}.}"</span>
                                  (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"  "</span> <span style="color: #2d9574;">" \\quad "</span>
                                             <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Hack!</span>
                                             (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"&amp;"</span> <span style="color: #2d9574;">"\\&amp;"</span> x))))))
               (<span style="color: #6c3163; font-weight: bold;">s-join</span> <span style="color: #2d9574;">"\n\n"</span>
                       (<span style="color: #3a81c3; font-weight: bold;">cl-loop</span> for (label name doc)
                             in <span style="color: #715ab1;">org-special-block-extras--docs-GLOSSARY</span>
                             collect (<span style="color: #6c3163; font-weight: bold;">format</span> fstr name label
                                             (<span style="color: #3a81c3; font-weight: bold;">when</span> doc (<span style="color: #6c3163; font-weight: bold;">funcall</span> preserve doc))
                                             label)))))))))
</pre>
</div>


</details>


<p>
As an example, we know have generic sentences:
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left"><code>My name is show:user-full-name and I am using Emacs show:emacs-version ^_^</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">My name is Musa Al-hassy and I am using Emacs 27.1 ^_^</td>
</tr>
</tbody>
</table>

<p>
For example, here is a word whose documentation is obtained from Emacs
rather than me being written: <abbr class="tooltip" title="Thread FORMS elements as the last argument of their successor.<br>Example:<br>&emsp;&emsp;(thread-last<br>&emsp;&emsp;&emsp;5<br>&emsp;&emsp;&emsp;(+ 20)<br>&emsp;&emsp;&emsp;(<em> 25)<br>&emsp;&emsp;&emsp;-<br>&emsp;&emsp;&emsp;(+ 40))<br>Is equivalent to:<br>&emsp;&emsp;(+ 40 (- (</em> 25 (+ 20 5))))<br>Note how the single ‚Äò-‚Äô got converted into a list before<br>threading.<br><br>(fn &rest FORMS)">thread-last</abbr>.
If you click on it, in the LaTeX output, you will be directed to the glossary
at the end of this article &#x2014;glossaries are not printed in HTML rendering.
</p>

<p>
<i>Neato! The whitespace in the documentation is preserved in the LaTeX output as
is the case for HTML.</i>
</p>

<p>
If we decide to erase a <code>doc:ùí≥</code>, then it should not longer appear in the
printed glossary listing. Likewise, a <code>documentation</code> block has its Org markup
exported according to the backend being exported to, hence if we decide to
switch between different backends then only the first rendition will be used
<i>unless</i> we erase the database each time after export.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Actual used glossary entries depends on the buffer; so clean up after each export</span>
(<span style="color: #6c3163; font-weight: bold;">advice-add</span> #'<span style="color: #6c3163; font-weight: bold;">org-export-dispatch</span>
  <span style="color: #3a81c3;">:after</span> (<span style="color: #3a81c3; font-weight: bold;">lambda</span> (<span style="color: #ba2f59; font-weight: bold;">&amp;rest</span> _)
  (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--docs-GLOSSARY</span> nil
        <span style="color: #715ab1;">org-special-block-extras--docs</span> nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-Next-Steps-tooltips" class="outline-3">
<h3 id="Next-Steps-tooltips"><span class="section-number-3">8.3</span> <a href="#Next-Steps-tooltips">Next Steps</a></h3>
<div class="outline-text-3" id="text-Next-Steps-tooltips">
<p>
Going forward, it'd be nice to have URLs work well upon export for <code>documentation</code>
block types; whereas they currently break the HTML export.
</p>
<ul class="org-ul">
<li>If an entry is referenced multiple times, such as <abbr class="tooltip" title="A theory of typed composition; e.g., typed monoids.">Category Theory</abbr>, then it would be
nice if the glossary referred to the pages of all such locations rather than
just the final one.</li>
<li>The glossary current prints in order of appearance; we may want to have
the option to print it in a sorted fashion.</li>
<li>Perhaps use the line activation feature to provide link tooltips
immediately rather than rely on exportation.</li>
<li>The <code>show</code> link type could accept an arbitrary Lisp expression as
a bracketed link.</li>
<li>When one clicks on a <code>doc</code> documentation link, it would be nice to ‚Äòjump‚Äô
to its associated <code>#+begin_documentation</code> declaration block in the current
buffer, if possible.</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-Summary" class="outline-2">
<h2 id="Summary"><span class="section-number-2">9</span> <a href="#Summary">Summary</a></h2>
<div class="outline-text-2" id="text-Summary">
<blockquote>
<p>
The full article may be read as a <a href="https://alhassy.github.io/org-special-block-extras/index.pdf">PDF</a> or as <a href="https://alhassy.github.io/org-special-block-extras">HTML</a> &#x2014;or visit the <a href="https://github.com/alhassy/org-special-block-extras">repo</a>.
</p>
</blockquote>

<p>
<a class="anchor" aria-hidden="true" id="summary" href="#summary"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16
   16" width="16" height="16"><path fill-rule="evenodd"
   d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69
   3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10
   5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0
   2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5
   0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55
   13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>
Let <code>ùíû</code> be any of the following: <code>black</code>, <code>blue</code>, <code>brown</code>, <code>cyan</code>, <code>darkgray</code>, <code>gray</code>, <code>green</code>,
<code>lightgray</code>, <code>lime</code>, <code>magenta</code>, <code>olive orange</code>, <code>pink</code>, <code>purple</code>, <code>red</code>, <code>teal</code>, <code>violet</code>, <code>white</code>,
<code>yellow</code>.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Idea</th>
<th scope="col" class="org-left">Documentation</th>
<th scope="col" class="org-left">Link only?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Colours</td>
<td class="org-left"><code>ùíû</code>, <abbr class="tooltip" title="Declare but do not display the CONTENTS according to the BACKEND.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key)">latex-definitions</abbr>, <abbr class="tooltip" title="Format text according to a given COLOR, which is black by default.<br><br>(fn BACKEND RAW-CONTENTS &optional COLOR &rest ## &key)">color</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Parallel</td>
<td class="org-left"><abbr class="tooltip" title="Place ideas side-by-side, possibly with a seperator.<br><br>There are COLS many columns, and they may be seperated by black<br>solid vertical rules if BAR is a non-nil value.<br><br>Writing ‚Äú#+begin_parallel ùìÉ :bar (any text except ‚Äònil‚Äô)‚Äù<br>will produce a parallel of ùìÉ many columns, possibly<br>seperated by solid rules, or a ‚Äúbar‚Äù.<br><br>The contents of the block may contain ‚Äò#+columnbreak:‚Äô to request<br>a columnbreak. This has no effect on HTML export since HTML<br>describes how text should be formatted on a browser, which can<br>dynamically shrink and grow and thus it makes no sense to have<br>hard columnbreaks.<br><br>(fn BACKEND RAW-CONTENTS &optional COLS &rest ## &key (BAR nil))">parallel</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Editorial Comments</td>
<td class="org-left"><abbr class="tooltip" title="Format CONTENTS as an first-class editor comment according to BACKEND.<br><br>The CONTENTS string has an optional switch: If it contains a line<br>with having only ‚Äò#+replacewith:‚Äô, then the text preceding this<br>clause should be replaced by the text after it; i.e., this is<br>what the EDITOR (the person editing) intends and so we fromat the<br>replacement instruction (to the authour) as such.<br><br>In Emacs, as links, editor remarks are shown with a bold red; but<br>the exported COLOR of a remark is black by default and it is not<br>STRONG ---i.e., bold---. There is an optional SIGNOFF message<br>that is appended to the remark.<br><br>(fn BACKEND RAW-CONTENTS &optional EDITOR &rest ## &key (COLOR ''black'') (SIGNOFF '''') (STRONG nil))">remark</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Folded Details</td>
<td class="org-left"><abbr class="tooltip" title="Enclose contents in a folded up box, for HTML.<br><br>For LaTeX, this is just a boring, but centered, box.<br><br>By default, the TITLE of such blocks is ‚ÄúDetails‚Äù<br>and its TITLE-COLOR is green.<br><br>In HTML, we show folded, details, regions with a nice greenish colour.<br><br>In the future ---i.e., when I have time---<br>it may be prudent to expose more aspects as arguments,<br>such as ‚Äòbackground-color‚Äô.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (TITLE-COLOR ''green''))">details</abbr> ,  <abbr class="tooltip" title="Enclose text in a box, possibly with a title.<br><br>By default, the box‚Äôs COLOR is green for HTML and red for LaTeX,<br>and it has no TITLE.<br><br>The HTML export uses a padded div, whereas the LaTeX export<br>requires the tcolorbox pacakge.<br><br>In the future, I will likely expose more arguments.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (BACKGROUND-COLOR nil))">box</abbr></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">Keystrokes</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>kbd</code></td>
</tr>

<tr>
<td class="org-left">OctoIcons &amp; Link Here</td>
<td class="org-left">&#xa0;</td>
<td class="org-left"><code>octoicon</code>, <code>link-here</code></td>
</tr>

<tr>
<td class="org-left">Documentation-Glossary</td>
<td class="org-left"><abbr class="tooltip" title="Register the dictionary entries in CONTENTS to the dictionary variable.<br><br>The dictionary variable is ‚Äòorg-special-block-extras--docs‚Äô.<br><br>A documentation entry may have its LABEL, its primary identifier,<br>be:<br>1. Omitted<br>2. Given as a single symbol<br>3. Given as a many aliases ‚Äô(lbl‚ÇÄ lbl‚ÇÅ ‚Ä¶ lbl‚Çô)<br><br>The third case is for when there is no canonical label to refer to<br>an entry, or it is convenient to use multiple labels for the same<br>entry.<br><br>In all of the above cases, two additional labels are included:<br>The entry name with spaces replaced by underscores, and again but<br>all lower case.<br><br>Documentation blocks are not shown upon export;<br>unless SHOW is non-nil, in which case they are shown<br>using the ‚Äòbox‚Äô block, with the provided COLOR passed to it.<br><br>In the futture, it may be nice to have an option to render tooltips.<br>That‚Äôd require the ‚Äòdoc:ùí≥‚Äô link construction be refactored via a ‚Äòdefun‚Äô.<br><br>(fn BACKEND RAW-CONTENTS &optional NAME &rest ## &key (LABEL nil) (SHOW nil) (COLOR ''green''))">documentation</abbr></td>
<td class="org-left"><code>doc</code></td>
</tr>
</tbody>
</table>

<p>
Other fun stuff: <abbr class="tooltip" title="Show the answers to a problem, but with a reprimand in case no attempt was made.<br><br>(fn BACKEND RAW-CONTENTS &optional TITLE &rest ## &key (REPRIMAND ''Did you actually try? Maybe see the ‚Äòhints‚Äô above!'') (REALLY ''Solution, for real''))">solution</abbr>, <abbr class="tooltip" title="Output the CONTENTS of the block as both parsed Org and unparsed.<br><br>Label the source text by SOURCE and the result text by RESULT<br><br>finally, the source-result fragments can be shown in a STYLE<br>that is either ‚Äúparallel‚Äù (default) or ‚Äúsequential‚Äù.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (SOURCE ''Source'') (RESULT ''Result'') (SOURCE-COLOR ''cyan'') (RESULT-COLOR ''cyan'') (STYLE ''parallel''))">org-demo</abbr>, <abbr class="tooltip" title="Output the CONTENTS of the block REPS many times<br><br>(fn BACKEND RAW-CONTENTS &optional REPS &rest ## &key)">stutter</abbr>, <abbr class="tooltip" title="Perform the given LIST of substitutions on the text.<br>The LIST is a comma separated list of ‚Äòto‚Äô separated symbols.<br>In a link, no quotes are needed.<br><br>(fn BACKEND RAW-CONTENTS &optional LIST &rest ## &key)">rename</abbr>, <abbr class="tooltip" title="Hide text enclosed in double parens ((like this)) as if it were spoilers.<br>&emsp; LEFT and RIGHT may be other kinds of delimiters.<br><br>(fn BACKEND RAW-CONTENTS &optional MAIN-ARG &rest ## &key (LEFT ''(('') (RIGHT ''))''))">spoiler</abbr> :grin:
</p>
</div>

<div id="outline-container-Installation-Instructions" class="outline-3">
<h3 id="Installation-Instructions"><span class="section-number-3">9.1</span> <a href="#Installation-Instructions">Installation Instructions</a></h3>
<div class="outline-text-3" id="text-Installation-Instructions">
<p>
Manually or using <a href="https://github.com/alhassy/emacs.d#installing-emacs-packages-directly-from-source">quelpa</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp"><span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#10216;0&#10217; Download the org-special-block-extras.el file manually or using quelpa</span>
(<span style="color: #6c3163; font-weight: bold;">quelpa</span> '(org-special-block-extras <span style="color: #3a81c3;">:fetcher</span> github <span style="color: #3a81c3;">:repo</span>
<span style="color: #2d9574;">"alhassy/org-special-block-extras"</span>))

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#10216;1&#10217; Have this always active in Org buffers</span>
(<span style="color: #6c3163; font-weight: bold;">add-hook</span> #'<span style="color: #715ab1;">org-mode-hook</span> #'<span style="color: #6c3163; font-weight: bold;">org-special-block-extras-mode</span>)

<span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#10216;1&#8242;&#10217; Or use: &#8220;M-x org-special-block-extras-mode&#8221; to turn it on/off</span>
</pre>
</div>

<p>
<b>Or</b> with <a href="https://github.com/alhassy/emacs.d#use-package-the-start-of-initel">use-package</a>:
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">use-package</span> <span style="color: #4e3163;">org-special-block-extras</span>
  <span style="color: #3a81c3;">:ensure</span> <span style="color: #715ab1;">t</span>
  <span style="color: #3a81c3;">:hook</span> (<span style="color: #6c3163; font-weight: bold;">org-mode</span> . <span style="color: #6c3163; font-weight: bold;">org-special-block-extras-mode</span>)
  <span style="color: #3a81c3;">:config</span>
  (<span style="color: #3a81c3; font-weight: bold;">setq</span> <span style="color: #715ab1;">org-special-block-extras--docs-libraries</span>
        '(<span style="color: #2d9574;">"~/org-special-block-extras/documentation.org"</span>))
  (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras-short-names</span>))
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">Final line is so we can write &#8220;defblock&#8221;</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">instead of the fully qualified name</span>
  <span style="color: #2aa1ae; background-color: #ecf3ec;">;; </span><span style="color: #2aa1ae; background-color: #ecf3ec;">&#8220;org-special-block-extras--defblock&#8221;</span>
</pre>
</div>

<p>
Then, provide support for a new type of special block named <code>foo</code> that, say
replaces all words <i>foo</i> in a block, by declaring the following.
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #3a81c3; font-weight: bold;">defun</span> <span style="color: #6c3163; font-weight: bold;">org-special-block-extras--foo</span> (backend contents)
  <span style="color: #da8b55;">"The FOO block type replaces all occurances of &#8216;</span><span style="color: #4e3163;">foo</span><span style="color: #da8b55;">&#8217; with &#8216;</span><span style="color: #4e3163;">bar</span><span style="color: #da8b55;">&#8217;,</span>
<span style="color: #da8b55;">unless a &#8216;</span><span style="color: #4e3163;">:replacement:</span><span style="color: #da8b55;">&#8217; is provided."</span>
  (<span style="color: #3a81c3; font-weight: bold;">-let</span> [(contents&#8242; . (<span style="color: #ba2f59; font-weight: bold;">&amp;alist</span> 'replacement))
           (<span style="color: #6c3163; font-weight: bold;">org-special-block-extras--extract-arguments</span> contents 'replacement)]
    (<span style="color: #6c3163; font-weight: bold;">s-replace</span> <span style="color: #2d9574;">"foo"</span> (<span style="color: #3a81c3; font-weight: bold;">or</span> replacement <span style="color: #2d9574;">"bar"</span>) contents&#8242;)))
</pre>
</div>
</div>
</div>

<div id="outline-container-Minimal-working-example" class="outline-3">
<h3 id="Minimal-working-example"><span class="section-number-3">9.2</span> <a href="#Minimal-working-example">Minimal working example</a></h3>
<div class="outline-text-3" id="text-Minimal-working-example">
<p>
The following example showcases the prominent features of this library.
</p>

<pre class="example" id="org9310866">
#+begin_parallel
[[color:orange][Are you excited to learn some Lisp?]] blue:yes!

Pop-quiz: How does doc:apply work?
#+end_parallel

#+begin_details
link-here:solution
Syntactically, ~(apply f '(x0 ... xN)) = (f x0 ... xN)~.

[[remark:Musa][Ain't that cool?]]

[[color:purple][We can apply a function to a list of arguments!]]
#+end_details

#+html: &lt;br&gt;
#+begin_box
octoicon:report Note that kbd:C-x_C-e evaluates a Lisp form!
#+end_box

#+LATEX_HEADER: \usepackage{multicol}
#+LATEX_HEADER: \usepackage{tcolorbox}
#+latex: In the LaTeX output, we have a glossary.

show:GLOSSARY
</pre>

<p>
The above section, <a href="#practice_problems">‚Äòpractice problems‚Äô</a>, presents a few puzzles to get you
comfortable with <code>defblock</code> ;-)
</p>
</div>
</div>


<div id="outline-container-Bye" class="outline-3">
<h3 id="Bye"><span class="section-number-3">9.3</span> <a href="#Bye">Bye!</a></h3>
<div class="outline-text-3" id="text-Bye">
<p>
<img src="https://img.shields.io/badge/thanks-for_reading-nil">
<a href="https://twitter.com/intent/tweet?text=This%20looks%20super%20neat%20%28%E2%80%A2%CC%80%E1%B4%97%E2%80%A2%CC%81%29%D9%88%3A:&url=https://github.com/alhassy/org-special-block-extras"><img src="https://img.shields.io/twitter/url?url=https://github.com/alhassy/org-special-block-extras"></a>
<a href="https://www.buymeacoffee.com/alhassy"><img src="https://img.shields.io/badge/-buy_me_a%C2%A0coffee-gray?logo=buy-me-a-coffee"></a>
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
See <a href="http://www.cs.nott.ac.uk/~pszgmh/fold.pdf"><i>A tutorial on the universality and expressiveness of fold</i></a> and
<a href="http://www.cs.ox.ac.uk/people/jeremy.gibbons/publications/urs.pdf"><i>Unifying Structured Recursion Schemes</i></a>
</p></div></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Musa Al-hassy</p>
<p class="date">Created: 2020-11-30 Mon 06:59</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
